var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**This class is automatically generated by LayaAirIDE, please do not make any modifications. */
var GameScene_1 = require("./script/runtime/GameScene");
/*
* 游戏初始化配置;
*/
var GameConfig = /** @class */ (function () {
    function GameConfig() {
    }
    GameConfig.init = function () {
        var reg = Laya.ClassUtils.regClass;
        reg("script/runtime/GameScene.ts", GameScene_1.default);
    };
    GameConfig.width = 640;
    GameConfig.height = 1136;
    GameConfig.scaleMode = "fixedwidth";
    GameConfig.screenMode = "none";
    GameConfig.alignV = "top";
    GameConfig.alignH = "left";
    GameConfig.startScene = "game/GameScene.scene";
    GameConfig.sceneRoot = "";
    GameConfig.debug = false;
    GameConfig.stat = true;
    GameConfig.physicsDebug = false;
    GameConfig.exportSceneToJson = true;
    return GameConfig;
}());
exports.default = GameConfig;
GameConfig.init();
},{"./script/runtime/GameScene":6}],2:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var GameConfig_1 = require("./GameConfig");
var Main = /** @class */ (function () {
    function Main() {
        //根据IDE设置初始化引擎		
        if (window["Laya3D"])
            Laya3D.init(GameConfig_1.default.width, GameConfig_1.default.height);
        else
            Laya.init(GameConfig_1.default.width, GameConfig_1.default.height, Laya["WebGL"]);
        Laya["Physics"] && Laya["Physics"].enable();
        Laya["DebugPanel"] && Laya["DebugPanel"].enable();
        Laya.stage.scaleMode = GameConfig_1.default.scaleMode;
        Laya.stage.screenMode = GameConfig_1.default.screenMode;
        //兼容微信不支持加载scene后缀场景
        Laya.URL.exportSceneToJson = GameConfig_1.default.exportSceneToJson;
        //打开调试面板（通过IDE设置调试模式，或者url地址增加debug=true参数，均可打开调试面板）
        if (GameConfig_1.default.debug || Laya.Utils.getQueryString("debug") == "true")
            Laya.enableDebugPanel();
        if (GameConfig_1.default.physicsDebug && Laya["PhysicsDebugDraw"])
            Laya["PhysicsDebugDraw"].enable();
        if (GameConfig_1.default.stat)
            Laya.Stat.show();
        Laya.alertGlobalError = true;
        //激活资源版本控制，version.json由IDE发布功能自动生成，如果没有也不影响后续流程
        Laya.ResourceVersion.enable("version.json", Laya.Handler.create(this, this.onVersionLoaded), Laya.ResourceVersion.FILENAME_VERSION);
    }
    Main.prototype.onVersionLoaded = function () {
        //激活大小图映射，加载小图的时候，如果发现小图在大图合集里面，则优先加载大图合集，而不是小图
        Laya.AtlasInfoManager.enable("fileconfig.json", Laya.Handler.create(this, this.onConfigLoaded));
    };
    Main.prototype.onConfigLoaded = function () {
        //加载IDE指定的场景
        GameConfig_1.default.startScene && Laya.Scene.open(GameConfig_1.default.startScene);
    };
    return Main;
}());
//激活启动类
new Main();
},{"./GameConfig":1}],3:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/** version */
exports.VERSION = "1.0.0";
/** pages */
exports.URL_HomeView = "home/HomeView.scene";
exports.URL_GameScene = "game/GameScene.scene";
exports.URL_OverView = "over/OverView.scene";
exports.URL_ReviveView = "dialog/ReviveView.scene";
/** camera */
exports.CameraInitPos = new Laya.Vector3(0, 0, 0);
exports.CameraInitRotEuler = new Laya.Vector3(0, 0, 0);
/** directional light */
exports.LightInitPos = new Laya.Vector3(-3, 5, 0);
exports.LightInitRotEuler = new Laya.Vector3(-45, -30, 0);
/** game stage */
exports.StageInitPos = new Laya.Vector3(0, -1.5, -17);
exports.StageInitRot = new Laya.Vector3(0, 37, 0);
exports.StageInitScale = new Laya.Vector3(40, 40, 40);
/** platform */
exports.PlatformInitPos = new Laya.Vector3(0, -3, -15);
exports.PlatformInitRot = new Laya.Vector3(0, 37, 0);
exports.PlatformWidth = 5;
exports.PlatformHeight = 0.3;
exports.PlatformStandRadius = 0.3;
exports.PlatformStandHeight = 10;
// winning check frame
exports.WinCheckTime = 120;
/** glass */
exports.GlassBrokenVelocity = 3;
/** obstacle piece */
exports.PieceResUrl = "res/cube_piece.lm";
exports.PiecesNum = 3;
exports.PiecesBrokenTime = 120;
/** bullet */
exports.BulletResUrl = "res/bullet.lh";
exports.BulletInitPos = new Laya.Vector3(-0.1, -1, -4);
exports.BulletInitRot = new Laya.Vector3(180, 0, 0);
exports.BulletRadius = 0.15;
/** player */
exports.PlayerResUrl = "res/human.lh";
exports.PlayerInitPos = new Laya.Vector3(0, -0.6, -1);
exports.PlayerInitRot = new Laya.Vector3(90, 168, 0);
exports.PlayerInitScale = new Laya.Vector3(20, 20, 20);
exports.PlayerShootLifeTime = 10;
},{}],4:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Const = require("../Const");
var GameScene_1 = require("../runtime/GameScene");
var Cube = /** @class */ (function (_super) {
    __extends(Cube, _super);
    function Cube() {
        var _this = _super.call(this) || this;
        _this.type = 1 /* DEFAULT */;
        _this.collisionBlackList = ["platform"];
        /** cube pieces */
        _this.piecesList = [];
        return _this;
    }
    Cube.prototype.onAwake = function () {
        this.cube = this.owner;
        this.setRigidbody();
        this.initPieces();
    };
    Cube.prototype.onCollisionEnter = function (collision) {
        var other = collision.other.owner;
        // if (this.collisionBlackList.indexOf(other.name) < 0) {
        if (this.type === 2 /* GLASS */) {
            // 相对速度高可击碎
            var velocity = this.cube.getComponent(Laya.Rigidbody3D).linearVelocity.clone();
            var velocityOther = new Laya.Vector3(0, 0, 0);
            // not playform
            if (this.collisionBlackList.indexOf(other.name) < 0) {
                velocityOther = other.getComponent(Laya.Rigidbody3D).linearVelocity.clone();
            }
            Laya.Vector3.subtract(velocity, velocityOther, velocity);
            var velocityValue = Math.sqrt(Math.pow(velocity.x, 2) + Math.pow(velocity.y, 2) + Math.pow(velocity.z, 2));
            if (velocityValue >= Const.GlassBrokenVelocity) {
                // this.isHit = true;
                this.broken();
            }
        }
        // }
    };
    Cube.prototype.onUpdate = function () {
        // physics engine bug detecting and fixing
        this.physics_engine_bug_fixing();
        // // hit handling
        // if (this.isHit) {
        //     if (this.type === Const.CubeType.GLASS) {
        //         this.broken();
        //     }
        // }
    };
    /** physics engine bug detecting and fixing
     *  引擎bug：姿态稳定情况下，某个物体作用力方向（如重力时的底下）的碰撞物体快速消失，
     *  而此过程中相互作用影响过小导致自身姿态没有变化时，引擎会自动将该物体的刚体非激活，从而导致腾空现象，
     *  增大物体间相互作用力（如摩擦系数）可减少该情况发生，但不能杜绝，
     *  故在此检测该情况并对刚体销毁重建
     * */
    Cube.prototype.physics_engine_bug_fixing = function () {
        var rigidbody = this.cube.getComponent(Laya.Rigidbody3D);
        if (rigidbody.isActive == false) {
            rigidbody.destroy();
            this.setRigidbody();
            console.log("Physics_engine_bug_fixing: Reset rigidbody.");
        }
    };
    /** set material by type */
    Cube.prototype.setType = function (type) {
        this.type = type;
        if (this.type === 2 /* GLASS */) {
            var mat = new Laya.BlinnPhongMaterial();
            mat.renderMode = Laya.BlinnPhongMaterial.RENDERMODE_TRANSPARENT;
            mat.albedoColor = new Laya.Vector4(0.7, 0.7, 1, 0.7);
            this.cube.meshRenderer.material = mat;
        }
    };
    /** set rigidbody */
    Cube.prototype.setRigidbody = function () {
        var rigidbody = this.cube.addComponent(Laya.Rigidbody3D);
        if (this.cube.name.search("Cube") >= 0) {
            var boundindBox = this.cube.meshFilter.sharedMesh.boundingBox.clone();
            this.sizeX = boundindBox.max.x - boundindBox.min.x;
            this.sizeY = boundindBox.max.y - boundindBox.min.y;
            this.sizeZ = boundindBox.max.z - boundindBox.min.z;
            rigidbody.colliderShape = new Laya.BoxColliderShape(this.sizeX, this.sizeY, this.sizeZ);
        }
        else {
            var colliderShape = new Laya.MeshColliderShape();
            colliderShape.mesh = this.cube.meshFilter.sharedMesh;
            rigidbody.colliderShape = colliderShape;
        }
        this.setPhysicsParam();
    };
    /** set physics param */
    Cube.prototype.setPhysicsParam = function () {
        var rigidbody = this.cube.getComponent(Laya.Rigidbody3D);
        rigidbody.isKinematic = false;
        if (this.type === 1 /* DEFAULT */) {
            rigidbody.mass = 10;
            rigidbody.friction = 10;
        }
        else if (this.type === 2 /* GLASS */) {
            rigidbody.mass = 0.1;
            rigidbody.friction = 2;
        }
    };
    /** set obstacle broken */
    Cube.prototype.broken = function () {
        // play broken sound
        var _this = this;
        // show pieces
        this.effectPiecesBroken(this.cube.transform.position.clone());
        // hide obstacle
        Laya.timer.frameOnce(1, this, function () {
            _this.cube.active = false;
        });
    };
    /** init obstacle pieces */
    Cube.prototype.initPieces = function () {
        var _this = this;
        Laya.Mesh.load(Const.PieceResUrl, Laya.Handler.create(this, function (mesh) {
            var piece = new Laya.MeshSprite3D(mesh);
            piece.active = false;
            piece.name = "piece";
            // set material
            var mat = new Laya.BlinnPhongMaterial();
            mat.renderMode = Laya.BlinnPhongMaterial.RENDERMODE_TRANSPARENT;
            mat.albedoColor = new Laya.Vector4(0.7, 0.7, 1, 0.7);
            piece.meshRenderer.material = mat;
            // set rigidbody
            var pieceRigid = piece.addComponent(Laya.Rigidbody3D);
            var pieceColliderShape = new Laya.MeshColliderShape();
            pieceColliderShape.mesh = piece.meshFilter.sharedMesh;
            pieceRigid.colliderShape = pieceColliderShape;
            // add pieces to scene
            for (var i = 0; i < Const.PiecesNum; i++) {
                _this.piecesList.push(piece.clone());
                GameScene_1.default.instance.scene3D.addChild(_this.piecesList[i]);
            }
        }));
    };
    /** platy effect: obstacle broken to pieces */
    Cube.prototype.effectPiecesBroken = function (worldPos) {
        var _this = this;
        var _loop_1 = function (idx) {
            // active pieces
            this_1.piecesList[idx].active = true;
            // set size scale
            var scaleX = (Math.random() * 0.5 + 0.5) * 2.5 * this_1.sizeX * Const.StageInitScale.x;
            var scaleY = (Math.random() * 0.5 + 0.5) * 2.5 * this_1.sizeY * Const.StageInitScale.y;
            var scaleZ = (Math.random() * 0.5 + 0.5) * 2.5 * this_1.sizeZ * Const.StageInitScale.z;
            this_1.piecesList[idx].transform.localScale = new Laya.Vector3(scaleX, scaleY, scaleZ);
            // set rot
            this_1.piecesList[idx].transform.localRotationEulerX = (Math.random() - 0.5) * 2 * 90;
            this_1.piecesList[idx].transform.localRotationEulerY = (Math.random() - 0.5) * 2 * 90;
            this_1.piecesList[idx].transform.localRotationEulerZ = (Math.random() - 0.5) * 2 * 90;
            // set pos
            var velocity = new Laya.Vector3();
            velocity.x = (Math.random() - 0.5) * Const.BulletRadius;
            velocity.y = (Math.random() - 0.5) * Const.BulletRadius;
            velocity.z = (Math.random() - 0.5) * Const.BulletRadius;
            this_1.piecesList[idx].transform.position = worldPos.clone();
            Laya.Vector3.add(this_1.piecesList[idx].transform.localPosition, velocity, this_1.piecesList[idx].transform.localPosition);
            // set velocity of pieces
            Laya.Vector3.scale(velocity, 50, velocity);
            this_1.piecesList[idx].getComponent(Laya.Rigidbody3D).linearVelocity = velocity.clone();
            // set hiding effect
            Laya.Tween.to(this_1.piecesList[idx].transform.localScale, { x: scaleX / 2, y: scaleY / 2, z: scaleZ / 2 }, Const.PiecesBrokenTime / 60 * 1000, Laya.Ease.linearNone);
            Laya.Tween.to(this_1.piecesList[idx].meshRenderer.material, { albedoColorA: 0 }, Const.PiecesBrokenTime / 60 * 1000, Laya.Ease.linearNone, Laya.Handler.create(this_1, function () {
                _this.piecesList[+idx].destroy();
            }));
        };
        var this_1 = this;
        for (var idx in this.piecesList) {
            _loop_1(idx);
        }
    };
    return Cube;
}(Laya.Script3D));
exports.default = Cube;
},{"../Const":3,"../runtime/GameScene":6}],5:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Const = require("../Const");
var GameScene_1 = require("../runtime/GameScene");
var Platform = /** @class */ (function (_super) {
    __extends(Platform, _super);
    function Platform() {
        var _this = _super.call(this) || this;
        _this.winCount = 0;
        _this.collisionBlackList = ["platform", "bullet", "piece"];
        return _this;
    }
    Platform.prototype.onAwake = function () {
        this.platform = this.owner;
    };
    Platform.prototype.onUpdate = function () {
        /** win check */
        this.winCount++;
        if (this.winCount > Const.WinCheckTime) {
            GameScene_1.default.instance.state = 1;
            console.log("You win.");
        }
    };
    Platform.prototype.onCollisionStay = function (collision) {
        if (this.collisionBlackList.indexOf(collision.other.owner.name) < 0) {
            this.winCount = 0;
        }
    };
    return Platform;
}(Laya.Script3D));
exports.default = Platform;
},{"../Const":3,"../runtime/GameScene":6}],6:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var layaMaxUI_1 = require("./../../ui/layaMaxUI");
var Const = require("../Const");
var Platform_1 = require("../component/Platform");
var Cube_1 = require("../component/Cube");
var GameScene = /** @class */ (function (_super) {
    __extends(GameScene, _super);
    function GameScene() {
        var _this = _super.call(this) || this;
        _this.cubeList = [];
        _this.cubeNumX = 4;
        _this.cubeNumY = 4;
        _this.cubeNumZ = 3;
        _this.bulletRadius = 0.02;
        _this.bulletVelocity = 1;
        _this.bulletDirection = new Laya.Vector3();
        _this.shootTime = -1;
        /** raycast */
        _this.mousePoint = new Laya.Vector2();
        _this.ray = new Laya.Ray(new Laya.Vector3(0, 0, 0), new Laya.Vector3(0, 0, 0));
        _this.hitResult = new Laya.HitResult();
        /** game state */
        _this.state = 0;
        GameScene.instance = _this;
        _this.initScene3D();
        _this.initGameStage();
        _this.initPlayer();
        _this.initBullet();
        return _this;
    }
    /**
     * 打开该单例页面，触发onOpened
     * @param param  onOpened方法的传参
     */
    GameScene.openInstance = function (param) {
        if (GameScene.instance) {
            GameScene.instance.onOpened(param);
            // GameScene.instance.showTutorial();
        }
        else {
            Laya.Scene.open(Const.URL_GameScene, false, param);
        }
    };
    GameScene.prototype.onOpened = function (param) {
        this.visible = true;
        // this.state = Const.GameState.READY;
    };
    ;
    /** initialize scene */
    GameScene.prototype.initScene3D = function () {
        // add scene
        this.scene3D = Laya.stage.addChild(new Laya.Scene3D());
        // camera
        this.camera = this.scene3D.addChild(new Laya.Camera());
        this.camera.transform.localPosition = Const.CameraInitPos.clone();
        this.camera.transform.localRotationEuler = Const.CameraInitRotEuler.clone();
        // direction light
        this.directionLight = this.scene3D.addChild(new Laya.DirectionLight());
        this.directionLight.transform.localPosition = Const.LightInitPos.clone();
        this.directionLight.transform.localRotationEuler = Const.LightInitRotEuler.clone();
    };
    /** initialize game stage */
    GameScene.prototype.initGameStage = function () {
        var _this = this;
        Laya.Sprite3D.load("res/stage/3/3.lh", Laya.Handler.create(this, function (res) {
            var stage = _this.scene3D.addChild(res);
            // set pos
            stage.transform.localPosition = Const.StageInitPos.clone();
            // stage.transform.localRotationEuler = Const.StageInitRot.clone();
            stage.transform.localScale = Const.StageInitScale.clone();
            // destroy animator component: 不然会约束物理碰撞效果
            stage.getComponent(Laya.Animator).destroy();
            var child;
            for (var i = 0; i < stage.numChildren; i++) {
                child = stage.getChildAt(i);
                /** obstacles */
                if (child.name.search("Obstacles") >= 0) {
                    console.log(child.name + " to obstacle");
                    var cubeScript = child.addComponent(Cube_1.default);
                    cubeScript.setType(2 /* GLASS */);
                }
                /** platform */
                else if (child.name.search("Cube") >= 0) {
                    console.log(child.name + " to platform");
                    child.name = "platform";
                    // 获取台子boundbox，添加脚本，需要兼容多个平台时胜利判断, & mesh collider shape碰撞抖动问题 todo <=======================
                    child.addComponent(Platform_1.default);
                    var rigid = child.addComponent(Laya.PhysicsCollider);
                    var boundindBox = child.meshFilter.sharedMesh.boundingBox.clone();
                    var sizeX = boundindBox.max.x - boundindBox.min.x;
                    var sizeY = boundindBox.max.y - boundindBox.min.y;
                    var sizeZ = boundindBox.max.z - boundindBox.min.z;
                    rigid.colliderShape = new Laya.BoxColliderShape(sizeX, sizeY, sizeZ);
                }
                /** platform stand */
                else if (child.name.search("Cylinder") >= 0) {
                    console.log(child.name + " to platform");
                    child.name = "platform";
                    var rigid = child.addComponent(Laya.PhysicsCollider);
                    var colliderShape = new Laya.MeshColliderShape();
                    colliderShape.mesh = child.meshFilter.sharedMesh;
                    rigid.colliderShape = colliderShape;
                }
            }
        }));
        // /** init platform */
        // this.initPlatfrom();
        // /** init cube */
        // this._cube = new Laya.MeshSprite3D(Laya.PrimitiveMesh.createBox(1, 1, 1));
        // this._cube.name = "cube";
        // let cubeRigid: Laya.Rigidbody3D = this._cube.addComponent(Laya.Rigidbody3D);
        // cubeRigid.colliderShape = new Laya.BoxColliderShape(1, 1, 1);
        // cubeRigid.mass = 1;
        // // cubeRigid.restitution = 0.2;
        // // cubeRigid.friction = 10;
        // // cubeRigid.rollingFriction = 0;
        // // // block physics sim
        // // cubeRigid.angularFactor = new Laya.Vector3(0, 0, 0);
        // // cubeRigid.linearFactor = new Laya.Vector3(0, 0, 0);
        // /** game stage */
        // let cubeNum: number = this.cubeNumX * this.cubeNumY * this.cubeNumZ;
        // let tmp: number = this.cubeNumX > this.cubeNumY ? this.cubeNumX : this.cubeNumY;
        // tmp = this.cubeNumZ > this.cubeNumY ? this.cubeNumZ : this.cubeNumY;
        // let padding: number = 1;
        // this.cubeWidth = (Const.PlatformWidth - padding * 2) / tmp;
        // let initX: number = (this.cubeNumX % 2 == 1) ? (-Math.floor(this.cubeNumX / 2) * this.cubeWidth) : (this.cubeWidth / 2 - this.cubeNumX / 2 * this.cubeWidth);
        // let initY: number = (Const.PlatformHeight + this.cubeWidth) / 2;
        // let initZ: number = (this.cubeNumZ % 2 == 1) ? (-Math.floor(this.cubeNumZ / 2) * this.cubeWidth) : (this.cubeWidth / 2 - this.cubeNumZ / 2 * this.cubeWidth);
        // for (let x: number = 0; x < this.cubeNumX; x++) {
        //     for (let y: number = 0; y < this.cubeNumY; y++) {
        //         for (let z: number = 0; z < this.cubeNumZ; z++) {
        //             let cube: Laya.MeshSprite3D = this._cube.clone();
        //             cube.transform.localScale = new Laya.Vector3(this.cubeWidth, this.cubeWidth, this.cubeWidth);
        //             cube.transform.localPosition = new Laya.Vector3(initX + this.cubeWidth * x, initY + this.cubeWidth * y, initZ + this.cubeWidth * z);
        //             this.platform.addChild(cube);
        //             let cubeScript: Cube = cube.addComponent(Cube);
        //             cubeScript.type = Const.CubeType.GLASS;
        //             cubeScript.width = this.cubeWidth;
        //             this.cubeList.push(cubeScript);
        //         }
        //     }
        // }
    };
    /** initialize platfrom */
    GameScene.prototype.initPlatfrom = function () {
        /** platform */
        // create mesh
        this.platform = new Laya.MeshSprite3D(Laya.PrimitiveMesh.createBox(Const.PlatformWidth, Const.PlatformHeight, Const.PlatformWidth));
        this.scene3D.addChild(this.platform);
        this.platform.addComponent(Platform_1.default);
        this.platform.transform.localPosition = Const.PlatformInitPos.clone();
        this.platform.transform.localRotationEuler = Const.PlatformInitRot.clone();
        // set physics
        var collider = this.platform.addComponent(Laya.PhysicsCollider);
        collider.colliderShape = new Laya.BoxColliderShape(Const.PlatformWidth, Const.PlatformHeight, Const.PlatformWidth);
        /** stand */
        // create mesh
        this.platform_stand = new Laya.MeshSprite3D(Laya.PrimitiveMesh.createCylinder(Const.PlatformStandRadius, Const.PlatformStandHeight));
        this.platform.addChild(this.platform_stand);
        this.platform_stand.transform.localPosition = new Laya.Vector3(0, -Const.PlatformStandHeight / 2, 0);
        // set physics
        var collider_stand = this.platform_stand.addComponent(Laya.PhysicsCollider);
        collider_stand.colliderShape = new Laya.CylinderColliderShape(Const.PlatformStandRadius, Const.PlatformStandHeight);
    };
    /** initialize player */
    GameScene.prototype.initPlayer = function () {
        var _this = this;
        Laya.Sprite3D.load(Const.PlayerResUrl, Laya.Handler.create(this, function (res) {
            _this.player = res;
            _this.scene3D.addChild(_this.player);
            _this.playerAni = _this.player.getComponent(Laya.Animator);
            _this.player.transform.localPosition = Const.PlayerInitPos.clone();
            _this.player.transform.localRotationEuler = Const.PlayerInitRot.clone();
            _this.player.transform.localScale = Const.PlayerInitScale.clone();
            _this.player.name = "player";
            var shadowMat = _this.player.getChildByName("shadow_0").meshRenderer.material;
            shadowMat.renderMode = Laya.BlinnPhongMaterial.RENDERMODE_TRANSPARENT;
            shadowMat.albedoColorA = 0.2;
            // mouse click event listen: shoot a bullet
            Laya.stage.on(Laya.Event.CLICK, _this, _this.onClick);
            // onUpdate
            _this.gameStart();
        }));
    };
    /** initialize bullet */
    GameScene.prototype.initBullet = function () {
        this._bullet = new Laya.MeshSprite3D(Laya.PrimitiveMesh.createSphere(Const.BulletRadius));
        /** set physics */
        var bulletRigid = this._bullet.addComponent(Laya.Rigidbody3D);
        // set collieder shape
        bulletRigid.colliderShape = new Laya.SphereColliderShape(Const.BulletRadius);
        // quick moving detecion
        bulletRigid.ccdMotionThreshold = 0.0001;
        bulletRigid.ccdSweptSphereRadius = Const.BulletRadius;
        // mass
        bulletRigid.mass = 10;
        /** trasform */
        this._bullet.transform.localPosition = Const.BulletInitPos.clone();
        this._bullet.transform.localRotationEuler = Const.BulletInitRot.clone();
        this._bullet.name = "_bullet";
    };
    /** game start */
    GameScene.prototype.gameStart = function () {
        var _this = this;
        // shooting animation
        this.playerAni.getDefaultState().clip.islooping = true;
        this.playerAni.play();
        Laya.timer.frameLoop(1, this, function () {
            // game state check
            // play shooting animation
            _this.shootTime--;
            if (_this.shootTime < 0) {
                // stop playing
                _this.playerAni.speed = 0;
            }
        });
    };
    /** mouse click event: shoot a bullet */
    GameScene.prototype.onClick = function () {
        // play shoot animation
        this.shootTime = Const.PlayerShootLifeTime;
        this.playerAni.speed = 1;
        // get ray
        this.mousePoint.x = Laya.MouseManager.instance.mouseX;
        this.mousePoint.y = Laya.MouseManager.instance.mouseY;
        this.camera.viewportPointToRay(this.mousePoint, this.ray);
        // get bullet shooting direction
        if (this.scene3D.physicsSimulation.rayCast(this.ray, this.hitResult, 30)) {
            // direction vector: [bullet init point] to [mouse hit point]
            Laya.Vector3.subtract(this.hitResult.point, Const.BulletInitPos, this.bulletDirection);
        }
        else {
            // direction vector: [camera point] to [mouse hit point]
            var aV3 = new Laya.Vector3();
            // ray direction scale: to depth scaleZ
            var scaleV = this.camera.farPlane;
            scaleV = 10;
            Laya.Vector3.scale(this.ray.direction, scaleV, aV3);
            // direction vector: [bullet init point] to [camera point]
            var bV3 = new Laya.Vector3();
            Laya.Vector3.subtract(this.camera.transform.position, Const.BulletInitPos, bV3);
            // direction vector: [bullet init point] to [mouse hit point]
            Laya.Vector3.add(aV3, bV3, this.bulletDirection);
        }
        Laya.Vector3.normalize(this.bulletDirection, this.bulletDirection);
        this.bulletVelocity = 50;
        Laya.Vector3.scale(this.bulletDirection, this.bulletVelocity, this.bulletDirection);
        // generate bullet
        var bullet = this._bullet.clone();
        bullet.name = "bullet";
        this.scene3D.addChild(bullet);
        var bulletRigid = bullet.getComponent(Laya.Rigidbody3D);
        bulletRigid.linearVelocity = this.bulletDirection.clone();
    };
    return GameScene;
}(layaMaxUI_1.ui.game.GameSceneUI));
exports.default = GameScene;
},{"../Const":3,"../component/Cube":4,"../component/Platform":5,"./../../ui/layaMaxUI":7}],7:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Scene = Laya.Scene;
var REG = Laya.ClassUtils.regClass;
var ui;
(function (ui) {
    var game;
    (function (game) {
        var GameSceneUI = /** @class */ (function (_super) {
            __extends(GameSceneUI, _super);
            function GameSceneUI() {
                return _super.call(this) || this;
            }
            GameSceneUI.prototype.createChildren = function () {
                _super.prototype.createChildren.call(this);
                this.loadScene("game/GameScene");
            };
            return GameSceneUI;
        }(Scene));
        game.GameSceneUI = GameSceneUI;
        REG("ui.game.GameSceneUI", GameSceneUI);
    })(game = ui.game || (ui.game = {}));
})(ui = exports.ui || (exports.ui = {}));
},{}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6L1Byb2dyYW0gRmlsZXMvTGF5YUFpci9MYXlhQWlySURFX2JldGEvcmVzb3VyY2VzL2FwcC9ub2RlX21vZHVsZXMvYnJvd3Nlci1wYWNrL19wcmVsdWRlLmpzIiwic3JjL0dhbWVDb25maWcudHMiLCJzcmMvTWFpbi50cyIsInNyYy9zY3JpcHQvQ29uc3QudHMiLCJzcmMvc2NyaXB0L2NvbXBvbmVudC9DdWJlLnRzIiwic3JjL3NjcmlwdC9jb21wb25lbnQvUGxhdGZvcm0udHMiLCJzcmMvc2NyaXB0L3J1bnRpbWUvR2FtZVNjZW5lLnRzIiwic3JjL3VpL2xheWFNYXhVSS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNWQSxnR0FBZ0c7QUFDaEcsd0RBQWtEO0FBQ2xEOztFQUVFO0FBQ0Y7SUFhSTtJQUFjLENBQUM7SUFDUixlQUFJLEdBQVg7UUFDSSxJQUFJLEdBQUcsR0FBYSxJQUFJLENBQUMsVUFBVSxDQUFDLFFBQVEsQ0FBQztRQUM3QyxHQUFHLENBQUMsNkJBQTZCLEVBQUMsbUJBQVMsQ0FBQyxDQUFDO0lBQ2pELENBQUM7SUFoQk0sZ0JBQUssR0FBUSxHQUFHLENBQUM7SUFDakIsaUJBQU0sR0FBUSxJQUFJLENBQUM7SUFDbkIsb0JBQVMsR0FBUSxZQUFZLENBQUM7SUFDOUIscUJBQVUsR0FBUSxNQUFNLENBQUM7SUFDekIsaUJBQU0sR0FBUSxLQUFLLENBQUM7SUFDcEIsaUJBQU0sR0FBUSxNQUFNLENBQUM7SUFDckIscUJBQVUsR0FBSyxzQkFBc0IsQ0FBQztJQUN0QyxvQkFBUyxHQUFRLEVBQUUsQ0FBQztJQUNwQixnQkFBSyxHQUFTLEtBQUssQ0FBQztJQUNwQixlQUFJLEdBQVMsSUFBSSxDQUFDO0lBQ2xCLHVCQUFZLEdBQVMsS0FBSyxDQUFDO0lBQzNCLDRCQUFpQixHQUFTLElBQUksQ0FBQztJQU0xQyxpQkFBQztDQWxCRCxB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LElBQUksQ0FBQyxVQUFVLENBQUMsUUFBUSxDQUFDO0FBQzdDLElBQWMsRUFBRSxDQVNmO0FBVEQsV0FBYyxFQUFFO0lBQUMsSUFBQSxJQUFJLENBU3BCO0lBVGdCLFdBQUEsSUFBSTtRQUNqQjtZQUFpQywrQkFBSztZQUNsQzt1QkFBZSxpQkFBTztZQUFBLENBQUM7WUFDdkIsb0NBQWMsR0FBZDtnQkFDSSxpQkFBTSxjQUFjLFdBQUUsQ0FBQztnQkFDdkIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBQ3JDLENBQUM7WUFDTCxrQkFBQztRQUFELENBTkEsQUFNQyxDQU5nQyxLQUFLLEdBTXJDO1FBTlksZ0JBQVcsY0FNdkIsQ0FBQTtRQUNELEdBQUcsQ0FBQyxxQkFBcUIsRUFBQyxXQUFXLENBQUMsQ0FBQztJQUMzQyxDQUFDLEVBVGdCLElBQUksR0FBSixPQUFJLEtBQUosT0FBSSxRQVNwQjtBQUFELENBQUMsRUFUYSxFQUFFLEdBQUYsVUFBRSxLQUFGLFVBQUUsUUFTZiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsidmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH07XHJcbn0pKCk7XHJcbihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCIvKipUaGlzIGNsYXNzIGlzIGF1dG9tYXRpY2FsbHkgZ2VuZXJhdGVkIGJ5IExheWFBaXJJREUsIHBsZWFzZSBkbyBub3QgbWFrZSBhbnkgbW9kaWZpY2F0aW9ucy4gKi9cclxuaW1wb3J0IEdhbWVTY2VuZSBmcm9tIFwiLi9zY3JpcHQvcnVudGltZS9HYW1lU2NlbmVcIlxyXG4vKlxyXG4qIOa4uOaIj+WIneWni+WMlumFjee9rjtcclxuKi9cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZUNvbmZpZ3tcclxuICAgIHN0YXRpYyB3aWR0aDpudW1iZXI9NjQwO1xyXG4gICAgc3RhdGljIGhlaWdodDpudW1iZXI9MTEzNjtcclxuICAgIHN0YXRpYyBzY2FsZU1vZGU6c3RyaW5nPVwiZml4ZWR3aWR0aFwiO1xyXG4gICAgc3RhdGljIHNjcmVlbk1vZGU6c3RyaW5nPVwibm9uZVwiO1xyXG4gICAgc3RhdGljIGFsaWduVjpzdHJpbmc9XCJ0b3BcIjtcclxuICAgIHN0YXRpYyBhbGlnbkg6c3RyaW5nPVwibGVmdFwiO1xyXG4gICAgc3RhdGljIHN0YXJ0U2NlbmU6YW55PVwiZ2FtZS9HYW1lU2NlbmUuc2NlbmVcIjtcclxuICAgIHN0YXRpYyBzY2VuZVJvb3Q6c3RyaW5nPVwiXCI7XHJcbiAgICBzdGF0aWMgZGVidWc6Ym9vbGVhbj1mYWxzZTtcclxuICAgIHN0YXRpYyBzdGF0OmJvb2xlYW49dHJ1ZTtcclxuICAgIHN0YXRpYyBwaHlzaWNzRGVidWc6Ym9vbGVhbj1mYWxzZTtcclxuICAgIHN0YXRpYyBleHBvcnRTY2VuZVRvSnNvbjpib29sZWFuPXRydWU7XHJcbiAgICBjb25zdHJ1Y3Rvcigpe31cclxuICAgIHN0YXRpYyBpbml0KCl7XHJcbiAgICAgICAgdmFyIHJlZzogRnVuY3Rpb24gPSBMYXlhLkNsYXNzVXRpbHMucmVnQ2xhc3M7XHJcbiAgICAgICAgcmVnKFwic2NyaXB0L3J1bnRpbWUvR2FtZVNjZW5lLnRzXCIsR2FtZVNjZW5lKTtcclxuICAgIH1cclxufVxyXG5HYW1lQ29uZmlnLmluaXQoKTsiLCJpbXBvcnQgR2FtZUNvbmZpZyBmcm9tIFwiLi9HYW1lQ29uZmlnXCI7XHJcbmNsYXNzIE1haW4ge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0Ly/moLnmja5JREXorr7nva7liJ3lp4vljJblvJXmk45cdFx0XHJcblx0XHRpZiAod2luZG93W1wiTGF5YTNEXCJdKSBMYXlhM0QuaW5pdChHYW1lQ29uZmlnLndpZHRoLCBHYW1lQ29uZmlnLmhlaWdodCk7XHJcblx0XHRlbHNlIExheWEuaW5pdChHYW1lQ29uZmlnLndpZHRoLCBHYW1lQ29uZmlnLmhlaWdodCwgTGF5YVtcIldlYkdMXCJdKTtcclxuXHRcdExheWFbXCJQaHlzaWNzXCJdICYmIExheWFbXCJQaHlzaWNzXCJdLmVuYWJsZSgpO1xyXG5cdFx0TGF5YVtcIkRlYnVnUGFuZWxcIl0gJiYgTGF5YVtcIkRlYnVnUGFuZWxcIl0uZW5hYmxlKCk7XHJcblx0XHRMYXlhLnN0YWdlLnNjYWxlTW9kZSA9IEdhbWVDb25maWcuc2NhbGVNb2RlO1xyXG5cdFx0TGF5YS5zdGFnZS5zY3JlZW5Nb2RlID0gR2FtZUNvbmZpZy5zY3JlZW5Nb2RlO1xyXG5cdFx0Ly/lhbzlrrnlvq7kv6HkuI3mlK/mjIHliqDovb1zY2VuZeWQjue8gOWcuuaZr1xyXG5cdFx0TGF5YS5VUkwuZXhwb3J0U2NlbmVUb0pzb24gPSBHYW1lQ29uZmlnLmV4cG9ydFNjZW5lVG9Kc29uO1xyXG5cclxuXHRcdC8v5omT5byA6LCD6K+V6Z2i5p2/77yI6YCa6L+HSURF6K6+572u6LCD6K+V5qih5byP77yM5oiW6ICFdXJs5Zyw5Z2A5aKe5YqgZGVidWc9dHJ1ZeWPguaVsO+8jOWdh+WPr+aJk+W8gOiwg+ivlemdouadv++8iVxyXG5cdFx0aWYgKEdhbWVDb25maWcuZGVidWcgfHwgTGF5YS5VdGlscy5nZXRRdWVyeVN0cmluZyhcImRlYnVnXCIpID09IFwidHJ1ZVwiKSBMYXlhLmVuYWJsZURlYnVnUGFuZWwoKTtcclxuXHRcdGlmIChHYW1lQ29uZmlnLnBoeXNpY3NEZWJ1ZyAmJiBMYXlhW1wiUGh5c2ljc0RlYnVnRHJhd1wiXSkgTGF5YVtcIlBoeXNpY3NEZWJ1Z0RyYXdcIl0uZW5hYmxlKCk7XHJcblx0XHRpZiAoR2FtZUNvbmZpZy5zdGF0KSBMYXlhLlN0YXQuc2hvdygpO1xyXG5cdFx0TGF5YS5hbGVydEdsb2JhbEVycm9yID0gdHJ1ZTtcclxuXHJcblx0XHQvL+a/gOa0u+i1hOa6kOeJiOacrOaOp+WItu+8jHZlcnNpb24uanNvbueUsUlEReWPkeW4g+WKn+iDveiHquWKqOeUn+aIkO+8jOWmguaenOayoeacieS5n+S4jeW9seWTjeWQjue7rea1geeoi1xyXG5cdFx0TGF5YS5SZXNvdXJjZVZlcnNpb24uZW5hYmxlKFwidmVyc2lvbi5qc29uXCIsIExheWEuSGFuZGxlci5jcmVhdGUodGhpcywgdGhpcy5vblZlcnNpb25Mb2FkZWQpLCBMYXlhLlJlc291cmNlVmVyc2lvbi5GSUxFTkFNRV9WRVJTSU9OKTtcclxuXHR9XHJcblxyXG5cdG9uVmVyc2lvbkxvYWRlZCgpOiB2b2lkIHtcclxuXHRcdC8v5r+A5rS75aSn5bCP5Zu+5pig5bCE77yM5Yqg6L295bCP5Zu+55qE5pe25YCZ77yM5aaC5p6c5Y+R546w5bCP5Zu+5Zyo5aSn5Zu+5ZCI6ZuG6YeM6Z2i77yM5YiZ5LyY5YWI5Yqg6L295aSn5Zu+5ZCI6ZuG77yM6ICM5LiN5piv5bCP5Zu+XHJcblx0XHRMYXlhLkF0bGFzSW5mb01hbmFnZXIuZW5hYmxlKFwiZmlsZWNvbmZpZy5qc29uXCIsIExheWEuSGFuZGxlci5jcmVhdGUodGhpcywgdGhpcy5vbkNvbmZpZ0xvYWRlZCkpO1xyXG5cdH1cclxuXHJcblx0b25Db25maWdMb2FkZWQoKTogdm9pZCB7XHJcblx0XHQvL+WKoOi9vUlEReaMh+WumueahOWcuuaZr1xyXG5cdFx0R2FtZUNvbmZpZy5zdGFydFNjZW5lICYmIExheWEuU2NlbmUub3BlbihHYW1lQ29uZmlnLnN0YXJ0U2NlbmUpO1xyXG5cdH1cclxufVxyXG4vL+a/gOa0u+WQr+WKqOexu1xyXG5uZXcgTWFpbigpO1xyXG4iLCIvKiogdmVyc2lvbiAqL1xyXG5leHBvcnQgY29uc3QgVkVSU0lPTiA9IFwiMS4wLjBcIjtcclxuXHJcbi8qKiBwYWdlcyAqL1xyXG5leHBvcnQgY29uc3QgVVJMX0hvbWVWaWV3OiBzdHJpbmcgPSBcImhvbWUvSG9tZVZpZXcuc2NlbmVcIjtcclxuZXhwb3J0IGNvbnN0IFVSTF9HYW1lU2NlbmU6IHN0cmluZyA9IFwiZ2FtZS9HYW1lU2NlbmUuc2NlbmVcIjtcclxuZXhwb3J0IGNvbnN0IFVSTF9PdmVyVmlldzogc3RyaW5nID0gXCJvdmVyL092ZXJWaWV3LnNjZW5lXCI7XHJcbmV4cG9ydCBjb25zdCBVUkxfUmV2aXZlVmlldzogc3RyaW5nID0gXCJkaWFsb2cvUmV2aXZlVmlldy5zY2VuZVwiO1xyXG5cclxuLyoqIGNhbWVyYSAqL1xyXG5leHBvcnQgY29uc3QgQ2FtZXJhSW5pdFBvczogTGF5YS5WZWN0b3IzID0gbmV3IExheWEuVmVjdG9yMygwLCAwLCAwKTtcclxuZXhwb3J0IGNvbnN0IENhbWVyYUluaXRSb3RFdWxlcjogTGF5YS5WZWN0b3IzID0gbmV3IExheWEuVmVjdG9yMygwLCAwLCAwKTtcclxuXHJcbi8qKiBkaXJlY3Rpb25hbCBsaWdodCAqL1xyXG5leHBvcnQgY29uc3QgTGlnaHRJbml0UG9zOiBMYXlhLlZlY3RvcjMgPSBuZXcgTGF5YS5WZWN0b3IzKC0zLCA1LCAwKTtcclxuZXhwb3J0IGNvbnN0IExpZ2h0SW5pdFJvdEV1bGVyOiBMYXlhLlZlY3RvcjMgPSBuZXcgTGF5YS5WZWN0b3IzKC00NSwgLTMwLCAwKTtcclxuXHJcbi8qKiBnYW1lIHN0YWdlICovXHJcbmV4cG9ydCBjb25zdCBTdGFnZUluaXRQb3M6IExheWEuVmVjdG9yMyA9IG5ldyBMYXlhLlZlY3RvcjMoMCwgLTEuNSwgLTE3KTtcclxuZXhwb3J0IGNvbnN0IFN0YWdlSW5pdFJvdDogTGF5YS5WZWN0b3IzID0gbmV3IExheWEuVmVjdG9yMygwLCAzNywgMCk7XHJcbmV4cG9ydCBjb25zdCBTdGFnZUluaXRTY2FsZTogTGF5YS5WZWN0b3IzID0gbmV3IExheWEuVmVjdG9yMyg0MCwgNDAsIDQwKTtcclxuXHJcbi8qKiBwbGF0Zm9ybSAqL1xyXG5leHBvcnQgY29uc3QgUGxhdGZvcm1Jbml0UG9zOiBMYXlhLlZlY3RvcjMgPSBuZXcgTGF5YS5WZWN0b3IzKDAsIC0zLCAtMTUpO1xyXG5leHBvcnQgY29uc3QgUGxhdGZvcm1Jbml0Um90OiBMYXlhLlZlY3RvcjMgPSBuZXcgTGF5YS5WZWN0b3IzKDAsIDM3LCAwKTtcclxuZXhwb3J0IGNvbnN0IFBsYXRmb3JtV2lkdGg6IG51bWJlciA9IDU7XHJcbmV4cG9ydCBjb25zdCBQbGF0Zm9ybUhlaWdodDogbnVtYmVyID0gMC4zO1xyXG5leHBvcnQgY29uc3QgUGxhdGZvcm1TdGFuZFJhZGl1czogbnVtYmVyID0gMC4zO1xyXG5leHBvcnQgY29uc3QgUGxhdGZvcm1TdGFuZEhlaWdodDogbnVtYmVyID0gMTA7XHJcbi8vIHdpbm5pbmcgY2hlY2sgZnJhbWVcclxuZXhwb3J0IGNvbnN0IFdpbkNoZWNrVGltZTogbnVtYmVyID0gMTIwO1xyXG5cclxuLyoqIGN1YmUgKi9cclxuZXhwb3J0IGNvbnN0IGVudW0gQ3ViZVR5cGUge1xyXG4gICAgREVGQVVMVCA9IDEsXHJcbiAgICBHTEFTUyA9IDIsXHJcbiAgICBUTlQgPSAzXHJcbn1cclxuXHJcbi8qKiBnbGFzcyAqL1xyXG5leHBvcnQgY29uc3QgR2xhc3NCcm9rZW5WZWxvY2l0eTogbnVtYmVyID0gMztcclxuXHJcbi8qKiBvYnN0YWNsZSBwaWVjZSAqL1xyXG5leHBvcnQgY29uc3QgUGllY2VSZXNVcmw6IHN0cmluZyA9IFwicmVzL2N1YmVfcGllY2UubG1cIjtcclxuZXhwb3J0IGNvbnN0IFBpZWNlc051bTogbnVtYmVyID0gMztcclxuZXhwb3J0IGNvbnN0IFBpZWNlc0Jyb2tlblRpbWU6IG51bWJlciA9IDEyMDtcclxuXHJcbi8qKiBidWxsZXQgKi9cclxuZXhwb3J0IGNvbnN0IEJ1bGxldFJlc1VybDogc3RyaW5nID0gXCJyZXMvYnVsbGV0LmxoXCI7XHJcbmV4cG9ydCBjb25zdCBCdWxsZXRJbml0UG9zOiBMYXlhLlZlY3RvcjMgPSBuZXcgTGF5YS5WZWN0b3IzKC0wLjEsIC0xLCAtNCk7XHJcbmV4cG9ydCBjb25zdCBCdWxsZXRJbml0Um90OiBMYXlhLlZlY3RvcjMgPSBuZXcgTGF5YS5WZWN0b3IzKDE4MCwgMCwgMCk7XHJcbmV4cG9ydCBjb25zdCBCdWxsZXRSYWRpdXM6IG51bWJlciA9IDAuMTU7XHJcblxyXG4vKiogcGxheWVyICovXHJcbmV4cG9ydCBjb25zdCBQbGF5ZXJSZXNVcmw6IHN0cmluZyA9IFwicmVzL2h1bWFuLmxoXCI7XHJcbmV4cG9ydCBjb25zdCBQbGF5ZXJJbml0UG9zOiBMYXlhLlZlY3RvcjMgPSBuZXcgTGF5YS5WZWN0b3IzKDAsIC0wLjYsIC0xKTtcclxuZXhwb3J0IGNvbnN0IFBsYXllckluaXRSb3Q6IExheWEuVmVjdG9yMyA9IG5ldyBMYXlhLlZlY3RvcjMoOTAsIDE2OCwgMCk7XHJcbmV4cG9ydCBjb25zdCBQbGF5ZXJJbml0U2NhbGU6IExheWEuVmVjdG9yMyA9IG5ldyBMYXlhLlZlY3RvcjMoMjAsIDIwLCAyMCk7XHJcbmV4cG9ydCBjb25zdCBQbGF5ZXJTaG9vdExpZmVUaW1lOiBudW1iZXIgPSAxMDtcclxuIiwiaW1wb3J0ICogYXMgQ29uc3QgZnJvbSBcIi4uL0NvbnN0XCI7XHJcbmltcG9ydCBHYW1lU2NlbmUgZnJvbSBcIi4uL3J1bnRpbWUvR2FtZVNjZW5lXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDdWJlIGV4dGVuZHMgTGF5YS5TY3JpcHQzRCB7XHJcbiAgICBwcml2YXRlIGN1YmU6IExheWEuTWVzaFNwcml0ZTNEO1xyXG5cclxuICAgIHByaXZhdGUgdHlwZTogbnVtYmVyID0gQ29uc3QuQ3ViZVR5cGUuREVGQVVMVDtcclxuXHJcbiAgICBwcml2YXRlIHNpemVYOiBudW1iZXI7XHJcbiAgICBwcml2YXRlIHNpemVZOiBudW1iZXI7XHJcbiAgICBwcml2YXRlIHNpemVaOiBudW1iZXI7XHJcblxyXG4gICAgcHJpdmF0ZSBjb2xsaXNpb25CbGFja0xpc3Q6IHN0cmluZ1tdID0gW1wicGxhdGZvcm1cIl07XHJcblxyXG4gICAgLyoqIGN1YmUgcGllY2VzICovXHJcbiAgICBwcml2YXRlIHBpZWNlc0xpc3Q6IExheWEuTWVzaFNwcml0ZTNEW10gPSBbXTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQXdha2UoKSB7XHJcbiAgICAgICAgdGhpcy5jdWJlID0gdGhpcy5vd25lciBhcyBMYXlhLk1lc2hTcHJpdGUzRDtcclxuICAgICAgICB0aGlzLnNldFJpZ2lkYm9keSgpO1xyXG4gICAgICAgIHRoaXMuaW5pdFBpZWNlcygpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQ29sbGlzaW9uRW50ZXIoY29sbGlzaW9uOiBMYXlhLkNvbGxpc2lvbik6IHZvaWQge1xyXG4gICAgICAgIGxldCBvdGhlcjogTGF5YS5NZXNoU3ByaXRlM0QgPSBjb2xsaXNpb24ub3RoZXIub3duZXIgYXMgTGF5YS5NZXNoU3ByaXRlM0Q7XHJcbiAgICAgICAgLy8gaWYgKHRoaXMuY29sbGlzaW9uQmxhY2tMaXN0LmluZGV4T2Yob3RoZXIubmFtZSkgPCAwKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gQ29uc3QuQ3ViZVR5cGUuR0xBU1MpIHtcclxuICAgICAgICAgICAgLy8g55u45a+56YCf5bqm6auY5Y+v5Ye756KOXHJcbiAgICAgICAgICAgIGxldCB2ZWxvY2l0eTogTGF5YS5WZWN0b3IzID0gKHRoaXMuY3ViZS5nZXRDb21wb25lbnQoTGF5YS5SaWdpZGJvZHkzRCkgYXMgTGF5YS5SaWdpZGJvZHkzRCkubGluZWFyVmVsb2NpdHkuY2xvbmUoKTtcclxuICAgICAgICAgICAgbGV0IHZlbG9jaXR5T3RoZXI6IExheWEuVmVjdG9yMyA9IG5ldyBMYXlhLlZlY3RvcjMoMCwgMCwgMCk7XHJcbiAgICAgICAgICAgIC8vIG5vdCBwbGF5Zm9ybVxyXG4gICAgICAgICAgICBpZiAodGhpcy5jb2xsaXNpb25CbGFja0xpc3QuaW5kZXhPZihvdGhlci5uYW1lKSA8IDApIHtcclxuICAgICAgICAgICAgICAgIHZlbG9jaXR5T3RoZXIgPSAob3RoZXIuZ2V0Q29tcG9uZW50KExheWEuUmlnaWRib2R5M0QpIGFzIExheWEuUmlnaWRib2R5M0QpLmxpbmVhclZlbG9jaXR5LmNsb25lKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgTGF5YS5WZWN0b3IzLnN1YnRyYWN0KHZlbG9jaXR5LCB2ZWxvY2l0eU90aGVyLCB2ZWxvY2l0eSk7XHJcbiAgICAgICAgICAgIGxldCB2ZWxvY2l0eVZhbHVlOiBudW1iZXIgPSBNYXRoLnNxcnQoTWF0aC5wb3codmVsb2NpdHkueCwgMikgKyBNYXRoLnBvdyh2ZWxvY2l0eS55LCAyKSArIE1hdGgucG93KHZlbG9jaXR5LnosIDIpKTtcclxuICAgICAgICAgICAgaWYgKHZlbG9jaXR5VmFsdWUgPj0gQ29uc3QuR2xhc3NCcm9rZW5WZWxvY2l0eSkge1xyXG4gICAgICAgICAgICAgICAgLy8gdGhpcy5pc0hpdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJyb2tlbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIH1cclxuICAgIH1cclxuXHJcbiAgICBvblVwZGF0ZSgpIHtcclxuICAgICAgICAvLyBwaHlzaWNzIGVuZ2luZSBidWcgZGV0ZWN0aW5nIGFuZCBmaXhpbmdcclxuICAgICAgICB0aGlzLnBoeXNpY3NfZW5naW5lX2J1Z19maXhpbmcoKTtcclxuXHJcbiAgICAgICAgLy8gLy8gaGl0IGhhbmRsaW5nXHJcbiAgICAgICAgLy8gaWYgKHRoaXMuaXNIaXQpIHtcclxuICAgICAgICAvLyAgICAgaWYgKHRoaXMudHlwZSA9PT0gQ29uc3QuQ3ViZVR5cGUuR0xBU1MpIHtcclxuICAgICAgICAvLyAgICAgICAgIHRoaXMuYnJva2VuKCk7XHJcbiAgICAgICAgLy8gICAgIH1cclxuICAgICAgICAvLyB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIHBoeXNpY3MgZW5naW5lIGJ1ZyBkZXRlY3RpbmcgYW5kIGZpeGluZ1xyXG4gICAgICogIOW8leaTjmJ1Z++8muWnv+aAgeeos+WumuaDheWGteS4i++8jOafkOS4queJqeS9k+S9nOeUqOWKm+aWueWQke+8iOWmgumHjeWKm+aXtueahOW6leS4i++8ieeahOeisOaSnueJqeS9k+W/q+mAn+a2iOWkse+8jFxyXG4gICAgICogIOiAjOatpOi/h+eoi+S4reebuOS6kuS9nOeUqOW9seWTjei/h+Wwj+WvvOiHtOiHqui6q+Wnv+aAgeayoeacieWPmOWMluaXtu+8jOW8leaTjuS8muiHquWKqOWwhuivpeeJqeS9k+eahOWImuS9k+mdnua/gOa0u++8jOS7juiAjOWvvOiHtOiFvuepuueOsOixoe+8jFxyXG4gICAgICogIOWinuWkp+eJqeS9k+mXtOebuOS6kuS9nOeUqOWKm++8iOWmguaRqeaTpuezu+aVsO+8ieWPr+WHj+WwkeivpeaDheWGteWPkeeUn++8jOS9huS4jeiDveadnOe7ne+8jFxyXG4gICAgICogIOaVheWcqOatpOajgOa1i+ivpeaDheWGteW5tuWvueWImuS9k+mUgOavgemHjeW7ulxyXG4gICAgICogKi9cclxuICAgIHByaXZhdGUgcGh5c2ljc19lbmdpbmVfYnVnX2ZpeGluZygpIHtcclxuICAgICAgICBsZXQgcmlnaWRib2R5OiBMYXlhLlJpZ2lkYm9keTNEID0gdGhpcy5jdWJlLmdldENvbXBvbmVudChMYXlhLlJpZ2lkYm9keTNEKSBhcyBMYXlhLlJpZ2lkYm9keTNEO1xyXG4gICAgICAgIGlmIChyaWdpZGJvZHkuaXNBY3RpdmUgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgcmlnaWRib2R5LmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgdGhpcy5zZXRSaWdpZGJvZHkoKTtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJQaHlzaWNzX2VuZ2luZV9idWdfZml4aW5nOiBSZXNldCByaWdpZGJvZHkuXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKiogc2V0IG1hdGVyaWFsIGJ5IHR5cGUgKi9cclxuICAgIHNldFR5cGUodHlwZTogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy50eXBlID0gdHlwZTtcclxuICAgICAgICBpZiAodGhpcy50eXBlID09PSBDb25zdC5DdWJlVHlwZS5HTEFTUykge1xyXG4gICAgICAgICAgICBsZXQgbWF0OiBMYXlhLkJsaW5uUGhvbmdNYXRlcmlhbCA9IG5ldyBMYXlhLkJsaW5uUGhvbmdNYXRlcmlhbCgpO1xyXG4gICAgICAgICAgICBtYXQucmVuZGVyTW9kZSA9IExheWEuQmxpbm5QaG9uZ01hdGVyaWFsLlJFTkRFUk1PREVfVFJBTlNQQVJFTlQ7XHJcbiAgICAgICAgICAgIG1hdC5hbGJlZG9Db2xvciA9IG5ldyBMYXlhLlZlY3RvcjQoMC43LCAwLjcsIDEsIDAuNyk7XHJcbiAgICAgICAgICAgIHRoaXMuY3ViZS5tZXNoUmVuZGVyZXIubWF0ZXJpYWwgPSBtYXQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKiBzZXQgcmlnaWRib2R5ICovXHJcbiAgICBwcml2YXRlIHNldFJpZ2lkYm9keSgpIHtcclxuICAgICAgICBsZXQgcmlnaWRib2R5OiBMYXlhLlJpZ2lkYm9keTNEID0gdGhpcy5jdWJlLmFkZENvbXBvbmVudChMYXlhLlJpZ2lkYm9keTNEKTtcclxuICAgICAgICBpZiAodGhpcy5jdWJlLm5hbWUuc2VhcmNoKFwiQ3ViZVwiKSA+PSAwKSB7XHJcbiAgICAgICAgICAgIGxldCBib3VuZGluZEJveDogTGF5YS5Cb3VuZEJveCA9IHRoaXMuY3ViZS5tZXNoRmlsdGVyLnNoYXJlZE1lc2guYm91bmRpbmdCb3guY2xvbmUoKTtcclxuICAgICAgICAgICAgdGhpcy5zaXplWCA9IGJvdW5kaW5kQm94Lm1heC54IC0gYm91bmRpbmRCb3gubWluLng7XHJcbiAgICAgICAgICAgIHRoaXMuc2l6ZVkgPSBib3VuZGluZEJveC5tYXgueSAtIGJvdW5kaW5kQm94Lm1pbi55O1xyXG4gICAgICAgICAgICB0aGlzLnNpemVaID0gYm91bmRpbmRCb3gubWF4LnogLSBib3VuZGluZEJveC5taW4uejtcclxuICAgICAgICAgICAgcmlnaWRib2R5LmNvbGxpZGVyU2hhcGUgPSBuZXcgTGF5YS5Cb3hDb2xsaWRlclNoYXBlKHRoaXMuc2l6ZVgsIHRoaXMuc2l6ZVksIHRoaXMuc2l6ZVopO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbGV0IGNvbGxpZGVyU2hhcGU6IExheWEuTWVzaENvbGxpZGVyU2hhcGUgPSBuZXcgTGF5YS5NZXNoQ29sbGlkZXJTaGFwZSgpO1xyXG4gICAgICAgICAgICBjb2xsaWRlclNoYXBlLm1lc2ggPSB0aGlzLmN1YmUubWVzaEZpbHRlci5zaGFyZWRNZXNoO1xyXG4gICAgICAgICAgICByaWdpZGJvZHkuY29sbGlkZXJTaGFwZSA9IGNvbGxpZGVyU2hhcGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuc2V0UGh5c2ljc1BhcmFtKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIHNldCBwaHlzaWNzIHBhcmFtICovXHJcbiAgICBwcml2YXRlIHNldFBoeXNpY3NQYXJhbSgpIHtcclxuICAgICAgICBsZXQgcmlnaWRib2R5OiBMYXlhLlJpZ2lkYm9keTNEID0gdGhpcy5jdWJlLmdldENvbXBvbmVudChMYXlhLlJpZ2lkYm9keTNEKTtcclxuICAgICAgICByaWdpZGJvZHkuaXNLaW5lbWF0aWMgPSBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy50eXBlID09PSBDb25zdC5DdWJlVHlwZS5ERUZBVUxUKSB7XHJcbiAgICAgICAgICAgIHJpZ2lkYm9keS5tYXNzID0gMTA7XHJcbiAgICAgICAgICAgIHJpZ2lkYm9keS5mcmljdGlvbiA9IDEwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0aGlzLnR5cGUgPT09IENvbnN0LkN1YmVUeXBlLkdMQVNTKSB7XHJcbiAgICAgICAgICAgIHJpZ2lkYm9keS5tYXNzID0gMC4xO1xyXG4gICAgICAgICAgICByaWdpZGJvZHkuZnJpY3Rpb24gPSAyO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKiogc2V0IG9ic3RhY2xlIGJyb2tlbiAqL1xyXG4gICAgcHJpdmF0ZSBicm9rZW4oKSB7XHJcbiAgICAgICAgLy8gcGxheSBicm9rZW4gc291bmRcclxuXHJcbiAgICAgICAgLy8gc2hvdyBwaWVjZXNcclxuICAgICAgICB0aGlzLmVmZmVjdFBpZWNlc0Jyb2tlbih0aGlzLmN1YmUudHJhbnNmb3JtLnBvc2l0aW9uLmNsb25lKCkpO1xyXG4gICAgICAgIC8vIGhpZGUgb2JzdGFjbGVcclxuICAgICAgICBMYXlhLnRpbWVyLmZyYW1lT25jZSgxLCB0aGlzLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY3ViZS5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKiogaW5pdCBvYnN0YWNsZSBwaWVjZXMgKi9cclxuICAgIHByaXZhdGUgaW5pdFBpZWNlcygpIHtcclxuICAgICAgICBMYXlhLk1lc2gubG9hZChDb25zdC5QaWVjZVJlc1VybCwgTGF5YS5IYW5kbGVyLmNyZWF0ZSh0aGlzLCAobWVzaCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgcGllY2U6IExheWEuTWVzaFNwcml0ZTNEID0gbmV3IExheWEuTWVzaFNwcml0ZTNEKG1lc2gpO1xyXG5cclxuICAgICAgICAgICAgcGllY2UuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHBpZWNlLm5hbWUgPSBcInBpZWNlXCI7XHJcblxyXG4gICAgICAgICAgICAvLyBzZXQgbWF0ZXJpYWxcclxuICAgICAgICAgICAgbGV0IG1hdDogTGF5YS5CbGlublBob25nTWF0ZXJpYWwgPSBuZXcgTGF5YS5CbGlublBob25nTWF0ZXJpYWwoKTtcclxuICAgICAgICAgICAgbWF0LnJlbmRlck1vZGUgPSBMYXlhLkJsaW5uUGhvbmdNYXRlcmlhbC5SRU5ERVJNT0RFX1RSQU5TUEFSRU5UO1xyXG4gICAgICAgICAgICBtYXQuYWxiZWRvQ29sb3IgPSBuZXcgTGF5YS5WZWN0b3I0KDAuNywgMC43LCAxLCAwLjcpO1xyXG4gICAgICAgICAgICBwaWVjZS5tZXNoUmVuZGVyZXIubWF0ZXJpYWwgPSBtYXQ7XHJcblxyXG4gICAgICAgICAgICAvLyBzZXQgcmlnaWRib2R5XHJcbiAgICAgICAgICAgIGxldCBwaWVjZVJpZ2lkOiBMYXlhLlJpZ2lkYm9keTNEID0gcGllY2UuYWRkQ29tcG9uZW50KExheWEuUmlnaWRib2R5M0QpO1xyXG4gICAgICAgICAgICBsZXQgcGllY2VDb2xsaWRlclNoYXBlOiBMYXlhLk1lc2hDb2xsaWRlclNoYXBlID0gbmV3IExheWEuTWVzaENvbGxpZGVyU2hhcGUoKTtcclxuICAgICAgICAgICAgcGllY2VDb2xsaWRlclNoYXBlLm1lc2ggPSBwaWVjZS5tZXNoRmlsdGVyLnNoYXJlZE1lc2g7XHJcbiAgICAgICAgICAgIHBpZWNlUmlnaWQuY29sbGlkZXJTaGFwZSA9IHBpZWNlQ29sbGlkZXJTaGFwZTtcclxuXHJcbiAgICAgICAgICAgIC8vIGFkZCBwaWVjZXMgdG8gc2NlbmVcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBDb25zdC5QaWVjZXNOdW07IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5waWVjZXNMaXN0LnB1c2gocGllY2UuY2xvbmUoKSk7XHJcbiAgICAgICAgICAgICAgICBHYW1lU2NlbmUuaW5zdGFuY2Uuc2NlbmUzRC5hZGRDaGlsZCh0aGlzLnBpZWNlc0xpc3RbaV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKiBwbGF0eSBlZmZlY3Q6IG9ic3RhY2xlIGJyb2tlbiB0byBwaWVjZXMgKi9cclxuICAgIHB1YmxpYyBlZmZlY3RQaWVjZXNCcm9rZW4od29ybGRQb3M6IExheWEuVmVjdG9yMykge1xyXG4gICAgICAgIGZvciAobGV0IGlkeCBpbiB0aGlzLnBpZWNlc0xpc3QpIHtcclxuICAgICAgICAgICAgLy8gYWN0aXZlIHBpZWNlc1xyXG4gICAgICAgICAgICB0aGlzLnBpZWNlc0xpc3RbaWR4XS5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgICAgICAvLyBzZXQgc2l6ZSBzY2FsZVxyXG4gICAgICAgICAgICBsZXQgc2NhbGVYOiBudW1iZXIgPSAoTWF0aC5yYW5kb20oKSAqIDAuNSArIDAuNSkgKiAyLjUgKiB0aGlzLnNpemVYICogQ29uc3QuU3RhZ2VJbml0U2NhbGUueDtcclxuICAgICAgICAgICAgbGV0IHNjYWxlWTogbnVtYmVyID0gKE1hdGgucmFuZG9tKCkgKiAwLjUgKyAwLjUpICogMi41ICogdGhpcy5zaXplWSAqIENvbnN0LlN0YWdlSW5pdFNjYWxlLnk7XHJcbiAgICAgICAgICAgIGxldCBzY2FsZVo6IG51bWJlciA9IChNYXRoLnJhbmRvbSgpICogMC41ICsgMC41KSAqIDIuNSAqIHRoaXMuc2l6ZVogKiBDb25zdC5TdGFnZUluaXRTY2FsZS56O1xyXG4gICAgICAgICAgICB0aGlzLnBpZWNlc0xpc3RbaWR4XS50cmFuc2Zvcm0ubG9jYWxTY2FsZSA9IG5ldyBMYXlhLlZlY3RvcjMoc2NhbGVYLCBzY2FsZVksIHNjYWxlWik7XHJcbiAgICAgICAgICAgIC8vIHNldCByb3RcclxuICAgICAgICAgICAgdGhpcy5waWVjZXNMaXN0W2lkeF0udHJhbnNmb3JtLmxvY2FsUm90YXRpb25FdWxlclggPSAoTWF0aC5yYW5kb20oKSAtIDAuNSkgKiAyICogOTA7XHJcbiAgICAgICAgICAgIHRoaXMucGllY2VzTGlzdFtpZHhdLnRyYW5zZm9ybS5sb2NhbFJvdGF0aW9uRXVsZXJZID0gKE1hdGgucmFuZG9tKCkgLSAwLjUpICogMiAqIDkwO1xyXG4gICAgICAgICAgICB0aGlzLnBpZWNlc0xpc3RbaWR4XS50cmFuc2Zvcm0ubG9jYWxSb3RhdGlvbkV1bGVyWiA9IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIDIgKiA5MDtcclxuICAgICAgICAgICAgLy8gc2V0IHBvc1xyXG4gICAgICAgICAgICBsZXQgdmVsb2NpdHk6IExheWEuVmVjdG9yMyA9IG5ldyBMYXlhLlZlY3RvcjMoKTtcclxuICAgICAgICAgICAgdmVsb2NpdHkueCA9IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIENvbnN0LkJ1bGxldFJhZGl1cztcclxuICAgICAgICAgICAgdmVsb2NpdHkueSA9IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIENvbnN0LkJ1bGxldFJhZGl1cztcclxuICAgICAgICAgICAgdmVsb2NpdHkueiA9IChNYXRoLnJhbmRvbSgpIC0gMC41KSAqIENvbnN0LkJ1bGxldFJhZGl1cztcclxuICAgICAgICAgICAgdGhpcy5waWVjZXNMaXN0W2lkeF0udHJhbnNmb3JtLnBvc2l0aW9uID0gd29ybGRQb3MuY2xvbmUoKTtcclxuICAgICAgICAgICAgTGF5YS5WZWN0b3IzLmFkZCh0aGlzLnBpZWNlc0xpc3RbaWR4XS50cmFuc2Zvcm0ubG9jYWxQb3NpdGlvbiwgdmVsb2NpdHksIHRoaXMucGllY2VzTGlzdFtpZHhdLnRyYW5zZm9ybS5sb2NhbFBvc2l0aW9uKTtcclxuICAgICAgICAgICAgLy8gc2V0IHZlbG9jaXR5IG9mIHBpZWNlc1xyXG4gICAgICAgICAgICBMYXlhLlZlY3RvcjMuc2NhbGUodmVsb2NpdHksIDUwLCB2ZWxvY2l0eSk7XHJcbiAgICAgICAgICAgICh0aGlzLnBpZWNlc0xpc3RbaWR4XS5nZXRDb21wb25lbnQoTGF5YS5SaWdpZGJvZHkzRCkgYXMgTGF5YS5SaWdpZGJvZHkzRCkubGluZWFyVmVsb2NpdHkgPSB2ZWxvY2l0eS5jbG9uZSgpO1xyXG4gICAgICAgICAgICAvLyBzZXQgaGlkaW5nIGVmZmVjdFxyXG4gICAgICAgICAgICBMYXlhLlR3ZWVuLnRvKHRoaXMucGllY2VzTGlzdFtpZHhdLnRyYW5zZm9ybS5sb2NhbFNjYWxlLCB7eDogc2NhbGVYIC8gMiwgeTogc2NhbGVZIC8gMiwgejogc2NhbGVaIC8gMn0sIENvbnN0LlBpZWNlc0Jyb2tlblRpbWUgLyA2MCAqIDEwMDAsIExheWEuRWFzZS5saW5lYXJOb25lKTtcclxuICAgICAgICAgICAgTGF5YS5Ud2Vlbi50byh0aGlzLnBpZWNlc0xpc3RbaWR4XS5tZXNoUmVuZGVyZXIubWF0ZXJpYWwsIHthbGJlZG9Db2xvckE6IDB9LCBDb25zdC5QaWVjZXNCcm9rZW5UaW1lIC8gNjAgKiAxMDAwLCBMYXlhLkVhc2UubGluZWFyTm9uZSwgTGF5YS5IYW5kbGVyLmNyZWF0ZSh0aGlzLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBpZWNlc0xpc3RbK2lkeF0uZGVzdHJveSgpO1xyXG4gICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwiaW1wb3J0ICogYXMgQ29uc3QgZnJvbSBcIi4uL0NvbnN0XCI7XHJcbmltcG9ydCBHYW1lU2NlbmUgZnJvbSBcIi4uL3J1bnRpbWUvR2FtZVNjZW5lXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQbGF0Zm9ybSBleHRlbmRzIExheWEuU2NyaXB0M0Qge1xyXG4gICAgcHJpdmF0ZSBwbGF0Zm9ybTogTGF5YS5NZXNoU3ByaXRlM0Q7XHJcblxyXG4gICAgcHJpdmF0ZSB3aW5Db3VudDogbnVtYmVyID0gMDtcclxuXHJcbiAgICBwcml2YXRlIGNvbGxpc2lvbkJsYWNrTGlzdDogc3RyaW5nW10gPSBbXCJwbGF0Zm9ybVwiLCBcImJ1bGxldFwiLCBcInBpZWNlXCJdO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25Bd2FrZSgpIHtcclxuICAgICAgICB0aGlzLnBsYXRmb3JtID0gdGhpcy5vd25lciBhcyBMYXlhLk1lc2hTcHJpdGUzRDtcclxuICAgIH1cclxuXHJcbiAgICBvblVwZGF0ZSgpIHtcclxuICAgICAgICAvKiogd2luIGNoZWNrICovXHJcbiAgICAgICAgdGhpcy53aW5Db3VudCsrO1xyXG4gICAgICAgIGlmICh0aGlzLndpbkNvdW50ID4gQ29uc3QuV2luQ2hlY2tUaW1lKSB7XHJcbiAgICAgICAgICAgIEdhbWVTY2VuZS5pbnN0YW5jZS5zdGF0ZSA9IDE7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiWW91IHdpbi5cIilcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25Db2xsaXNpb25TdGF5KGNvbGxpc2lvbjogTGF5YS5Db2xsaXNpb24pOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5jb2xsaXNpb25CbGFja0xpc3QuaW5kZXhPZihjb2xsaXNpb24ub3RoZXIub3duZXIubmFtZSkgPCAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMud2luQ291bnQgPSAwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsImltcG9ydCB7IHVpIH0gZnJvbSBcIi4vLi4vLi4vdWkvbGF5YU1heFVJXCI7XHJcbmltcG9ydCAqIGFzIENvbnN0IGZyb20gXCIuLi9Db25zdFwiO1xyXG5pbXBvcnQgQnVsbGV0IGZyb20gXCIuLi9jb21wb25lbnQvQnVsbGV0XCI7XHJcbmltcG9ydCBQbGF0Zm9ybSBmcm9tIFwiLi4vY29tcG9uZW50L1BsYXRmb3JtXCI7XHJcbmltcG9ydCBDdWJlIGZyb20gXCIuLi9jb21wb25lbnQvQ3ViZVwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZVNjZW5lIGV4dGVuZHMgdWkuZ2FtZS5HYW1lU2NlbmVVSSB7XHJcbiAgICBzdGF0aWMgaW5zdGFuY2U6IEdhbWVTY2VuZTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOaJk+W8gOivpeWNleS+i+mhtemdou+8jOinpuWPkW9uT3BlbmVkXHJcbiAgICAgKiBAcGFyYW0gcGFyYW0gIG9uT3BlbmVk5pa55rOV55qE5Lyg5Y+CXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBvcGVuSW5zdGFuY2UocGFyYW0/OiBhbnkpIHtcclxuICAgICAgICBpZiAoR2FtZVNjZW5lLmluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIEdhbWVTY2VuZS5pbnN0YW5jZS5vbk9wZW5lZChwYXJhbSk7XHJcbiAgICAgICAgICAgIC8vIEdhbWVTY2VuZS5pbnN0YW5jZS5zaG93VHV0b3JpYWwoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBMYXlhLlNjZW5lLm9wZW4oQ29uc3QuVVJMX0dhbWVTY2VuZSwgZmFsc2UsIHBhcmFtKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb25PcGVuZWQocGFyYW0/OiBhbnkpIHtcclxuICAgICAgICB0aGlzLnZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgIC8vIHRoaXMuc3RhdGUgPSBDb25zdC5HYW1lU3RhdGUuUkVBRFk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNjZW5lM0Q6IExheWEuU2NlbmUzRDtcclxuICAgIHByaXZhdGUgY2FtZXJhOiBMYXlhLkNhbWVyYTtcclxuICAgIHByaXZhdGUgZGlyZWN0aW9uTGlnaHQ6IExheWEuRGlyZWN0aW9uTGlnaHQ7XHJcblxyXG4gICAgLyoqIHBsYXRmb3JtICovXHJcbiAgICBwcml2YXRlIHBsYXRmb3JtOiBMYXlhLk1lc2hTcHJpdGUzRDtcclxuICAgIHByaXZhdGUgcGxhdGZvcm1fc3RhbmQ6IExheWEuTWVzaFNwcml0ZTNEO1xyXG5cclxuICAgIC8qKiBjdWJlICovXHJcbiAgICBwcml2YXRlIF9jdWJlOiBMYXlhLk1lc2hTcHJpdGUzRDtcclxuICAgIHByaXZhdGUgY3ViZUxpc3Q6IEN1YmVbXSA9IFtdO1xyXG4gICAgcHJpdmF0ZSBjdWJlTnVtWDogbnVtYmVyID0gNDtcclxuICAgIHByaXZhdGUgY3ViZU51bVk6IG51bWJlciA9IDQ7XHJcbiAgICBwcml2YXRlIGN1YmVOdW1aOiBudW1iZXIgPSAzO1xyXG4gICAgcHJpdmF0ZSBjdWJlV2lkdGg6IG51bWJlcjtcclxuXHJcbiAgICAvKiogYnVsbGV0ICovXHJcbiAgICBwcml2YXRlIF9idWxsZXQ6IExheWEuTWVzaFNwcml0ZTNEO1xyXG4gICAgcHJpdmF0ZSBidWxsZXRSYWRpdXM6IG51bWJlciA9IDAuMDI7XHJcbiAgICBwcml2YXRlIGJ1bGxldFZlbG9jaXR5OiBudW1iZXIgPSAxO1xyXG4gICAgcHJpdmF0ZSBidWxsZXRJbml0UG9zOiBMYXlhLlZlY3RvcjM7XHJcbiAgICBwcml2YXRlIGJ1bGxldERpcmVjdGlvbjogTGF5YS5WZWN0b3IzID0gbmV3IExheWEuVmVjdG9yMygpO1xyXG5cclxuICAgIC8qKiBjYW5ub24gKi9cclxuICAgIHByaXZhdGUgcGxheWVyOiBMYXlhLk1lc2hTcHJpdGUzRDtcclxuICAgIHByaXZhdGUgcGxheWVyQW5pOiBMYXlhLkFuaW1hdG9yO1xyXG4gICAgcHJpdmF0ZSBzaG9vdFRpbWU6IG51bWJlciA9IC0xOztcclxuXHJcbiAgICAvKiogcmF5Y2FzdCAqL1xyXG4gICAgcHJpdmF0ZSBtb3VzZVBvaW50OiBMYXlhLlZlY3RvcjIgPSBuZXcgTGF5YS5WZWN0b3IyKCk7XHJcbiAgICBwcml2YXRlIHJheTogTGF5YS5SYXkgPSBuZXcgTGF5YS5SYXkobmV3IExheWEuVmVjdG9yMygwLCAwLCAwKSwgbmV3IExheWEuVmVjdG9yMygwLCAwLCAwKSk7XHJcbiAgICBwcml2YXRlIGhpdFJlc3VsdDogTGF5YS5IaXRSZXN1bHQgPSBuZXcgTGF5YS5IaXRSZXN1bHQoKTtcclxuXHJcbiAgICAvKiogZ2FtZSBzdGF0ZSAqL1xyXG4gICAgcHVibGljIHN0YXRlOiBudW1iZXIgPSAwO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcblxyXG4gICAgICAgIEdhbWVTY2VuZS5pbnN0YW5jZSA9IHRoaXM7XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdFNjZW5lM0QoKTtcclxuXHJcbiAgICAgICAgdGhpcy5pbml0R2FtZVN0YWdlKCk7XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdFBsYXllcigpO1xyXG5cclxuICAgICAgICB0aGlzLmluaXRCdWxsZXQoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKiogaW5pdGlhbGl6ZSBzY2VuZSAqL1xyXG4gICAgcHJpdmF0ZSBpbml0U2NlbmUzRCgpIHtcclxuICAgICAgICAvLyBhZGQgc2NlbmVcclxuICAgICAgICB0aGlzLnNjZW5lM0QgPSBMYXlhLnN0YWdlLmFkZENoaWxkKG5ldyBMYXlhLlNjZW5lM0QoKSkgYXMgTGF5YS5TY2VuZTNEO1xyXG5cclxuICAgICAgICAvLyBjYW1lcmFcclxuICAgICAgICB0aGlzLmNhbWVyYSA9IHRoaXMuc2NlbmUzRC5hZGRDaGlsZChuZXcgTGF5YS5DYW1lcmEoKSkgYXMgTGF5YS5DYW1lcmE7XHJcbiAgICAgICAgdGhpcy5jYW1lcmEudHJhbnNmb3JtLmxvY2FsUG9zaXRpb24gPSBDb25zdC5DYW1lcmFJbml0UG9zLmNsb25lKCk7XHJcbiAgICAgICAgdGhpcy5jYW1lcmEudHJhbnNmb3JtLmxvY2FsUm90YXRpb25FdWxlciA9IENvbnN0LkNhbWVyYUluaXRSb3RFdWxlci5jbG9uZSgpO1xyXG5cclxuICAgICAgICAvLyBkaXJlY3Rpb24gbGlnaHRcclxuICAgICAgICB0aGlzLmRpcmVjdGlvbkxpZ2h0ID0gdGhpcy5zY2VuZTNELmFkZENoaWxkKG5ldyBMYXlhLkRpcmVjdGlvbkxpZ2h0KCkpIGFzIExheWEuRGlyZWN0aW9uTGlnaHQ7XHJcbiAgICAgICAgdGhpcy5kaXJlY3Rpb25MaWdodC50cmFuc2Zvcm0ubG9jYWxQb3NpdGlvbiA9IENvbnN0LkxpZ2h0SW5pdFBvcy5jbG9uZSgpO1xyXG4gICAgICAgIHRoaXMuZGlyZWN0aW9uTGlnaHQudHJhbnNmb3JtLmxvY2FsUm90YXRpb25FdWxlciA9IENvbnN0LkxpZ2h0SW5pdFJvdEV1bGVyLmNsb25lKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIGluaXRpYWxpemUgZ2FtZSBzdGFnZSAqL1xyXG4gICAgcHJpdmF0ZSBpbml0R2FtZVN0YWdlKCkge1xyXG5cclxuICAgICAgICBMYXlhLlNwcml0ZTNELmxvYWQoXCJyZXMvc3RhZ2UvMy8zLmxoXCIsIExheWEuSGFuZGxlci5jcmVhdGUodGhpcywgKHJlcykgPT4ge1xyXG4gICAgICAgICAgICBsZXQgc3RhZ2U6IExheWEuU3ByaXRlM0QgPSB0aGlzLnNjZW5lM0QuYWRkQ2hpbGQocmVzKSBhcyBMYXlhLlNwcml0ZTNEO1xyXG5cclxuICAgICAgICAgICAgLy8gc2V0IHBvc1xyXG4gICAgICAgICAgICBzdGFnZS50cmFuc2Zvcm0ubG9jYWxQb3NpdGlvbiA9IENvbnN0LlN0YWdlSW5pdFBvcy5jbG9uZSgpO1xyXG4gICAgICAgICAgICAvLyBzdGFnZS50cmFuc2Zvcm0ubG9jYWxSb3RhdGlvbkV1bGVyID0gQ29uc3QuU3RhZ2VJbml0Um90LmNsb25lKCk7XHJcbiAgICAgICAgICAgIHN0YWdlLnRyYW5zZm9ybS5sb2NhbFNjYWxlID0gQ29uc3QuU3RhZ2VJbml0U2NhbGUuY2xvbmUoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGRlc3Ryb3kgYW5pbWF0b3IgY29tcG9uZW50OiDkuI3nhLbkvJrnuqbmnZ/niannkIbnorDmkp7mlYjmnpxcclxuICAgICAgICAgICAgKHN0YWdlLmdldENvbXBvbmVudChMYXlhLkFuaW1hdG9yKSBhcyBMYXlhLkFuaW1hdG9yKS5kZXN0cm95KCk7XHJcblxyXG4gICAgICAgICAgICBsZXQgY2hpbGQ6IExheWEuTWVzaFNwcml0ZTNEO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpOiBudW1iZXIgPSAwOyBpIDwgc3RhZ2UubnVtQ2hpbGRyZW47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgY2hpbGQgPSBzdGFnZS5nZXRDaGlsZEF0KGkpIGFzIExheWEuTWVzaFNwcml0ZTNEO1xyXG4gICAgICAgICAgICAgICAgLyoqIG9ic3RhY2xlcyAqL1xyXG4gICAgICAgICAgICAgICAgaWYgKGNoaWxkLm5hbWUuc2VhcmNoKFwiT2JzdGFjbGVzXCIpID49IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhjaGlsZC5uYW1lICsgXCIgdG8gb2JzdGFjbGVcIilcclxuICAgICAgICAgICAgICAgICAgICBsZXQgY3ViZVNjcmlwdDogQ3ViZSA9IGNoaWxkLmFkZENvbXBvbmVudChDdWJlKTtcclxuICAgICAgICAgICAgICAgICAgICBjdWJlU2NyaXB0LnNldFR5cGUoQ29uc3QuQ3ViZVR5cGUuR0xBU1MpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLyoqIHBsYXRmb3JtICovXHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChjaGlsZC5uYW1lLnNlYXJjaChcIkN1YmVcIikgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGNoaWxkLm5hbWUgKyBcIiB0byBwbGF0Zm9ybVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkLm5hbWUgPSBcInBsYXRmb3JtXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8g6I635Y+W5Y+w5a2QYm91bmRib3jvvIzmt7vliqDohJrmnKzvvIzpnIDopoHlhbzlrrnlpJrkuKrlubPlj7Dml7bog5zliKnliKTmlq0sICYgbWVzaCBjb2xsaWRlciBzaGFwZeeisOaSnuaKluWKqOmXrumimCB0b2RvIDw9PT09PT09PT09PT09PT09PT09PT09PVxyXG4gICAgICAgICAgICAgICAgICAgIGNoaWxkLmFkZENvbXBvbmVudChQbGF0Zm9ybSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGxldCByaWdpZDogTGF5YS5QaHlzaWNzQ29sbGlkZXIgPSBjaGlsZC5hZGRDb21wb25lbnQoTGF5YS5QaHlzaWNzQ29sbGlkZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBib3VuZGluZEJveDogTGF5YS5Cb3VuZEJveCA9IGNoaWxkLm1lc2hGaWx0ZXIuc2hhcmVkTWVzaC5ib3VuZGluZ0JveC5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBzaXplWDogbnVtYmVyID0gYm91bmRpbmRCb3gubWF4LnggLSBib3VuZGluZEJveC5taW4ueDtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgc2l6ZVk6IG51bWJlciA9IGJvdW5kaW5kQm94Lm1heC55IC0gYm91bmRpbmRCb3gubWluLnk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHNpemVaOiBudW1iZXIgPSBib3VuZGluZEJveC5tYXgueiAtIGJvdW5kaW5kQm94Lm1pbi56O1xyXG4gICAgICAgICAgICAgICAgICAgIHJpZ2lkLmNvbGxpZGVyU2hhcGUgPSBuZXcgTGF5YS5Cb3hDb2xsaWRlclNoYXBlKHNpemVYLCBzaXplWSwgc2l6ZVopO1xyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIC8qKiBwbGF0Zm9ybSBzdGFuZCAqL1xyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoY2hpbGQubmFtZS5zZWFyY2goXCJDeWxpbmRlclwiKSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coY2hpbGQubmFtZSArIFwiIHRvIHBsYXRmb3JtXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQubmFtZSA9IFwicGxhdGZvcm1cIjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJpZ2lkOiBMYXlhLlBoeXNpY3NDb2xsaWRlciA9IGNoaWxkLmFkZENvbXBvbmVudChMYXlhLlBoeXNpY3NDb2xsaWRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbGxpZGVyU2hhcGU6IExheWEuTWVzaENvbGxpZGVyU2hhcGUgPSBuZXcgTGF5YS5NZXNoQ29sbGlkZXJTaGFwZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbGxpZGVyU2hhcGUubWVzaCA9IGNoaWxkLm1lc2hGaWx0ZXIuc2hhcmVkTWVzaDtcclxuICAgICAgICAgICAgICAgICAgICByaWdpZC5jb2xsaWRlclNoYXBlID0gY29sbGlkZXJTaGFwZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgLy8gLyoqIGluaXQgcGxhdGZvcm0gKi9cclxuICAgICAgICAvLyB0aGlzLmluaXRQbGF0ZnJvbSgpO1xyXG5cclxuICAgICAgICAvLyAvKiogaW5pdCBjdWJlICovXHJcbiAgICAgICAgLy8gdGhpcy5fY3ViZSA9IG5ldyBMYXlhLk1lc2hTcHJpdGUzRChMYXlhLlByaW1pdGl2ZU1lc2guY3JlYXRlQm94KDEsIDEsIDEpKTtcclxuICAgICAgICAvLyB0aGlzLl9jdWJlLm5hbWUgPSBcImN1YmVcIjtcclxuICAgICAgICAvLyBsZXQgY3ViZVJpZ2lkOiBMYXlhLlJpZ2lkYm9keTNEID0gdGhpcy5fY3ViZS5hZGRDb21wb25lbnQoTGF5YS5SaWdpZGJvZHkzRCk7XHJcbiAgICAgICAgLy8gY3ViZVJpZ2lkLmNvbGxpZGVyU2hhcGUgPSBuZXcgTGF5YS5Cb3hDb2xsaWRlclNoYXBlKDEsIDEsIDEpO1xyXG4gICAgICAgIC8vIGN1YmVSaWdpZC5tYXNzID0gMTtcclxuICAgICAgICAvLyAvLyBjdWJlUmlnaWQucmVzdGl0dXRpb24gPSAwLjI7XHJcbiAgICAgICAgLy8gLy8gY3ViZVJpZ2lkLmZyaWN0aW9uID0gMTA7XHJcbiAgICAgICAgLy8gLy8gY3ViZVJpZ2lkLnJvbGxpbmdGcmljdGlvbiA9IDA7XHJcbiAgICAgICAgLy8gLy8gLy8gYmxvY2sgcGh5c2ljcyBzaW1cclxuICAgICAgICAvLyAvLyBjdWJlUmlnaWQuYW5ndWxhckZhY3RvciA9IG5ldyBMYXlhLlZlY3RvcjMoMCwgMCwgMCk7XHJcbiAgICAgICAgLy8gLy8gY3ViZVJpZ2lkLmxpbmVhckZhY3RvciA9IG5ldyBMYXlhLlZlY3RvcjMoMCwgMCwgMCk7XHJcblxyXG4gICAgICAgIC8vIC8qKiBnYW1lIHN0YWdlICovXHJcbiAgICAgICAgLy8gbGV0IGN1YmVOdW06IG51bWJlciA9IHRoaXMuY3ViZU51bVggKiB0aGlzLmN1YmVOdW1ZICogdGhpcy5jdWJlTnVtWjtcclxuXHJcbiAgICAgICAgLy8gbGV0IHRtcDogbnVtYmVyID0gdGhpcy5jdWJlTnVtWCA+IHRoaXMuY3ViZU51bVkgPyB0aGlzLmN1YmVOdW1YIDogdGhpcy5jdWJlTnVtWTtcclxuICAgICAgICAvLyB0bXAgPSB0aGlzLmN1YmVOdW1aID4gdGhpcy5jdWJlTnVtWSA/IHRoaXMuY3ViZU51bVogOiB0aGlzLmN1YmVOdW1ZO1xyXG4gICAgICAgIC8vIGxldCBwYWRkaW5nOiBudW1iZXIgPSAxO1xyXG4gICAgICAgIC8vIHRoaXMuY3ViZVdpZHRoID0gKENvbnN0LlBsYXRmb3JtV2lkdGggLSBwYWRkaW5nICogMikgLyB0bXA7XHJcbiAgICAgICAgLy8gbGV0IGluaXRYOiBudW1iZXIgPSAodGhpcy5jdWJlTnVtWCAlIDIgPT0gMSkgPyAoLU1hdGguZmxvb3IodGhpcy5jdWJlTnVtWCAvIDIpICogdGhpcy5jdWJlV2lkdGgpIDogKHRoaXMuY3ViZVdpZHRoIC8gMiAtIHRoaXMuY3ViZU51bVggLyAyICogdGhpcy5jdWJlV2lkdGgpO1xyXG4gICAgICAgIC8vIGxldCBpbml0WTogbnVtYmVyID0gKENvbnN0LlBsYXRmb3JtSGVpZ2h0ICsgdGhpcy5jdWJlV2lkdGgpIC8gMjtcclxuICAgICAgICAvLyBsZXQgaW5pdFo6IG51bWJlciA9ICh0aGlzLmN1YmVOdW1aICUgMiA9PSAxKSA/ICgtTWF0aC5mbG9vcih0aGlzLmN1YmVOdW1aIC8gMikgKiB0aGlzLmN1YmVXaWR0aCkgOiAodGhpcy5jdWJlV2lkdGggLyAyIC0gdGhpcy5jdWJlTnVtWiAvIDIgKiB0aGlzLmN1YmVXaWR0aCk7XHJcbiAgICAgICAgLy8gZm9yIChsZXQgeDogbnVtYmVyID0gMDsgeCA8IHRoaXMuY3ViZU51bVg7IHgrKykge1xyXG4gICAgICAgIC8vICAgICBmb3IgKGxldCB5OiBudW1iZXIgPSAwOyB5IDwgdGhpcy5jdWJlTnVtWTsgeSsrKSB7XHJcbiAgICAgICAgLy8gICAgICAgICBmb3IgKGxldCB6OiBudW1iZXIgPSAwOyB6IDwgdGhpcy5jdWJlTnVtWjsgeisrKSB7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgbGV0IGN1YmU6IExheWEuTWVzaFNwcml0ZTNEID0gdGhpcy5fY3ViZS5jbG9uZSgpO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIGN1YmUudHJhbnNmb3JtLmxvY2FsU2NhbGUgPSBuZXcgTGF5YS5WZWN0b3IzKHRoaXMuY3ViZVdpZHRoLCB0aGlzLmN1YmVXaWR0aCwgdGhpcy5jdWJlV2lkdGgpO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIGN1YmUudHJhbnNmb3JtLmxvY2FsUG9zaXRpb24gPSBuZXcgTGF5YS5WZWN0b3IzKGluaXRYICsgdGhpcy5jdWJlV2lkdGggKiB4LCBpbml0WSArIHRoaXMuY3ViZVdpZHRoICogeSwgaW5pdFogKyB0aGlzLmN1YmVXaWR0aCAqIHopO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHRoaXMucGxhdGZvcm0uYWRkQ2hpbGQoY3ViZSk7XHJcblxyXG4gICAgICAgIC8vICAgICAgICAgICAgIGxldCBjdWJlU2NyaXB0OiBDdWJlID0gY3ViZS5hZGRDb21wb25lbnQoQ3ViZSk7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgY3ViZVNjcmlwdC50eXBlID0gQ29uc3QuQ3ViZVR5cGUuR0xBU1M7XHJcbiAgICAgICAgLy8gICAgICAgICAgICAgY3ViZVNjcmlwdC53aWR0aCA9IHRoaXMuY3ViZVdpZHRoO1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIHRoaXMuY3ViZUxpc3QucHVzaChjdWJlU2NyaXB0KTtcclxuICAgICAgICAvLyAgICAgICAgIH1cclxuICAgICAgICAvLyAgICAgfVxyXG4gICAgICAgIC8vIH1cclxuICAgIH1cclxuXHJcbiAgICAvKiogaW5pdGlhbGl6ZSBwbGF0ZnJvbSAqL1xyXG4gICAgcHJpdmF0ZSBpbml0UGxhdGZyb20oKSB7XHJcbiAgICAgICAgLyoqIHBsYXRmb3JtICovXHJcbiAgICAgICAgLy8gY3JlYXRlIG1lc2hcclxuICAgICAgICB0aGlzLnBsYXRmb3JtID0gbmV3IExheWEuTWVzaFNwcml0ZTNEKExheWEuUHJpbWl0aXZlTWVzaC5jcmVhdGVCb3goQ29uc3QuUGxhdGZvcm1XaWR0aCwgQ29uc3QuUGxhdGZvcm1IZWlnaHQsIENvbnN0LlBsYXRmb3JtV2lkdGgpKTtcclxuICAgICAgICB0aGlzLnNjZW5lM0QuYWRkQ2hpbGQodGhpcy5wbGF0Zm9ybSk7XHJcbiAgICAgICAgdGhpcy5wbGF0Zm9ybS5hZGRDb21wb25lbnQoUGxhdGZvcm0pO1xyXG4gICAgICAgIHRoaXMucGxhdGZvcm0udHJhbnNmb3JtLmxvY2FsUG9zaXRpb24gPSBDb25zdC5QbGF0Zm9ybUluaXRQb3MuY2xvbmUoKTtcclxuICAgICAgICB0aGlzLnBsYXRmb3JtLnRyYW5zZm9ybS5sb2NhbFJvdGF0aW9uRXVsZXIgPSBDb25zdC5QbGF0Zm9ybUluaXRSb3QuY2xvbmUoKTtcclxuXHJcbiAgICAgICAgLy8gc2V0IHBoeXNpY3NcclxuICAgICAgICBsZXQgY29sbGlkZXI6IExheWEuUGh5c2ljc0NvbGxpZGVyID0gdGhpcy5wbGF0Zm9ybS5hZGRDb21wb25lbnQoTGF5YS5QaHlzaWNzQ29sbGlkZXIpO1xyXG4gICAgICAgIGNvbGxpZGVyLmNvbGxpZGVyU2hhcGUgPSBuZXcgTGF5YS5Cb3hDb2xsaWRlclNoYXBlKENvbnN0LlBsYXRmb3JtV2lkdGgsIENvbnN0LlBsYXRmb3JtSGVpZ2h0LCBDb25zdC5QbGF0Zm9ybVdpZHRoKTtcclxuXHJcbiAgICAgICAgLyoqIHN0YW5kICovXHJcbiAgICAgICAgLy8gY3JlYXRlIG1lc2hcclxuICAgICAgICB0aGlzLnBsYXRmb3JtX3N0YW5kID0gbmV3IExheWEuTWVzaFNwcml0ZTNEKExheWEuUHJpbWl0aXZlTWVzaC5jcmVhdGVDeWxpbmRlcihDb25zdC5QbGF0Zm9ybVN0YW5kUmFkaXVzLCBDb25zdC5QbGF0Zm9ybVN0YW5kSGVpZ2h0KSk7XHJcbiAgICAgICAgdGhpcy5wbGF0Zm9ybS5hZGRDaGlsZCh0aGlzLnBsYXRmb3JtX3N0YW5kKTtcclxuICAgICAgICB0aGlzLnBsYXRmb3JtX3N0YW5kLnRyYW5zZm9ybS5sb2NhbFBvc2l0aW9uID0gbmV3IExheWEuVmVjdG9yMygwLCAtQ29uc3QuUGxhdGZvcm1TdGFuZEhlaWdodCAvIDIsIDApO1xyXG5cclxuICAgICAgICAvLyBzZXQgcGh5c2ljc1xyXG4gICAgICAgIGxldCBjb2xsaWRlcl9zdGFuZDogTGF5YS5QaHlzaWNzQ29sbGlkZXIgPSB0aGlzLnBsYXRmb3JtX3N0YW5kLmFkZENvbXBvbmVudChMYXlhLlBoeXNpY3NDb2xsaWRlcik7XHJcbiAgICAgICAgY29sbGlkZXJfc3RhbmQuY29sbGlkZXJTaGFwZSA9IG5ldyBMYXlhLkN5bGluZGVyQ29sbGlkZXJTaGFwZShDb25zdC5QbGF0Zm9ybVN0YW5kUmFkaXVzLCBDb25zdC5QbGF0Zm9ybVN0YW5kSGVpZ2h0KTtcclxuICAgIH1cclxuXHJcbiAgICAvKiogaW5pdGlhbGl6ZSBwbGF5ZXIgKi9cclxuICAgIHByaXZhdGUgaW5pdFBsYXllcigpIHtcclxuICAgICAgICBMYXlhLlNwcml0ZTNELmxvYWQoQ29uc3QuUGxheWVyUmVzVXJsLCBMYXlhLkhhbmRsZXIuY3JlYXRlKHRoaXMsIChyZXMpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXIgPSByZXM7XHJcbiAgICAgICAgICAgIHRoaXMuc2NlbmUzRC5hZGRDaGlsZCh0aGlzLnBsYXllcik7XHJcbiAgICAgICAgICAgIHRoaXMucGxheWVyQW5pID0gdGhpcy5wbGF5ZXIuZ2V0Q29tcG9uZW50KExheWEuQW5pbWF0b3IpO1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllci50cmFuc2Zvcm0ubG9jYWxQb3NpdGlvbiA9IENvbnN0LlBsYXllckluaXRQb3MuY2xvbmUoKTtcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXIudHJhbnNmb3JtLmxvY2FsUm90YXRpb25FdWxlciA9IENvbnN0LlBsYXllckluaXRSb3QuY2xvbmUoKTtcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXIudHJhbnNmb3JtLmxvY2FsU2NhbGUgPSBDb25zdC5QbGF5ZXJJbml0U2NhbGUuY2xvbmUoKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMucGxheWVyLm5hbWUgPSBcInBsYXllclwiO1xyXG5cclxuICAgICAgICAgICAgbGV0IHNoYWRvd01hdDogTGF5YS5CbGlublBob25nTWF0ZXJpYWwgPSAodGhpcy5wbGF5ZXIuZ2V0Q2hpbGRCeU5hbWUoXCJzaGFkb3dfMFwiKSBhcyBMYXlhLk1lc2hTcHJpdGUzRCkubWVzaFJlbmRlcmVyLm1hdGVyaWFsIGFzIExheWEuQmxpbm5QaG9uZ01hdGVyaWFsO1xyXG4gICAgICAgICAgICBzaGFkb3dNYXQucmVuZGVyTW9kZSA9IExheWEuQmxpbm5QaG9uZ01hdGVyaWFsLlJFTkRFUk1PREVfVFJBTlNQQVJFTlQ7XHJcbiAgICAgICAgICAgIHNoYWRvd01hdC5hbGJlZG9Db2xvckEgPSAwLjI7XHJcblxyXG4gICAgICAgICAgICAvLyBtb3VzZSBjbGljayBldmVudCBsaXN0ZW46IHNob290IGEgYnVsbGV0XHJcbiAgICAgICAgICAgIExheWEuc3RhZ2Uub24oTGF5YS5FdmVudC5DTElDSywgdGhpcywgdGhpcy5vbkNsaWNrKTtcclxuXHJcbiAgICAgICAgICAgIC8vIG9uVXBkYXRlXHJcbiAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXJ0KCk7XHJcbiAgICAgICAgfSkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKiBpbml0aWFsaXplIGJ1bGxldCAqL1xyXG4gICAgcHJpdmF0ZSBpbml0QnVsbGV0KCkge1xyXG4gICAgICAgIHRoaXMuX2J1bGxldCA9IG5ldyBMYXlhLk1lc2hTcHJpdGUzRChMYXlhLlByaW1pdGl2ZU1lc2guY3JlYXRlU3BoZXJlKENvbnN0LkJ1bGxldFJhZGl1cykpO1xyXG5cclxuICAgICAgICAvKiogc2V0IHBoeXNpY3MgKi9cclxuICAgICAgICBsZXQgYnVsbGV0UmlnaWQ6IExheWEuUmlnaWRib2R5M0QgPSB0aGlzLl9idWxsZXQuYWRkQ29tcG9uZW50KExheWEuUmlnaWRib2R5M0QpO1xyXG4gICAgICAgIC8vIHNldCBjb2xsaWVkZXIgc2hhcGVcclxuICAgICAgICBidWxsZXRSaWdpZC5jb2xsaWRlclNoYXBlID0gbmV3IExheWEuU3BoZXJlQ29sbGlkZXJTaGFwZShDb25zdC5CdWxsZXRSYWRpdXMpO1xyXG4gICAgICAgIC8vIHF1aWNrIG1vdmluZyBkZXRlY2lvblxyXG4gICAgICAgIGJ1bGxldFJpZ2lkLmNjZE1vdGlvblRocmVzaG9sZCA9IDAuMDAwMTtcclxuICAgICAgICBidWxsZXRSaWdpZC5jY2RTd2VwdFNwaGVyZVJhZGl1cyA9IENvbnN0LkJ1bGxldFJhZGl1cztcclxuICAgICAgICAvLyBtYXNzXHJcbiAgICAgICAgYnVsbGV0UmlnaWQubWFzcyA9IDEwO1xyXG5cclxuICAgICAgICAvKiogdHJhc2Zvcm0gKi9cclxuICAgICAgICB0aGlzLl9idWxsZXQudHJhbnNmb3JtLmxvY2FsUG9zaXRpb24gPSBDb25zdC5CdWxsZXRJbml0UG9zLmNsb25lKCk7XHJcbiAgICAgICAgdGhpcy5fYnVsbGV0LnRyYW5zZm9ybS5sb2NhbFJvdGF0aW9uRXVsZXIgPSBDb25zdC5CdWxsZXRJbml0Um90LmNsb25lKCk7XHJcblxyXG4gICAgICAgIHRoaXMuX2J1bGxldC5uYW1lID0gXCJfYnVsbGV0XCI7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqIGdhbWUgc3RhcnQgKi9cclxuICAgIHByaXZhdGUgZ2FtZVN0YXJ0KCkge1xyXG4gICAgICAgIC8vIHNob290aW5nIGFuaW1hdGlvblxyXG4gICAgICAgIHRoaXMucGxheWVyQW5pLmdldERlZmF1bHRTdGF0ZSgpLmNsaXAuaXNsb29waW5nID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnBsYXllckFuaS5wbGF5KCk7XHJcbiAgICAgICAgTGF5YS50aW1lci5mcmFtZUxvb3AoMSwgdGhpcywgKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBnYW1lIHN0YXRlIGNoZWNrXHJcblxyXG4gICAgICAgICAgICAvLyBwbGF5IHNob290aW5nIGFuaW1hdGlvblxyXG4gICAgICAgICAgICB0aGlzLnNob290VGltZS0tO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zaG9vdFRpbWUgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBzdG9wIHBsYXlpbmdcclxuICAgICAgICAgICAgICAgIHRoaXMucGxheWVyQW5pLnNwZWVkID0gMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKiBtb3VzZSBjbGljayBldmVudDogc2hvb3QgYSBidWxsZXQgKi9cclxuICAgIHByaXZhdGUgb25DbGljaygpIHtcclxuICAgICAgICAvLyBwbGF5IHNob290IGFuaW1hdGlvblxyXG4gICAgICAgIHRoaXMuc2hvb3RUaW1lID0gQ29uc3QuUGxheWVyU2hvb3RMaWZlVGltZTtcclxuICAgICAgICB0aGlzLnBsYXllckFuaS5zcGVlZCA9IDE7XHJcblxyXG4gICAgICAgIC8vIGdldCByYXlcclxuICAgICAgICB0aGlzLm1vdXNlUG9pbnQueCA9IExheWEuTW91c2VNYW5hZ2VyLmluc3RhbmNlLm1vdXNlWDtcclxuICAgICAgICB0aGlzLm1vdXNlUG9pbnQueSA9IExheWEuTW91c2VNYW5hZ2VyLmluc3RhbmNlLm1vdXNlWTtcclxuICAgICAgICB0aGlzLmNhbWVyYS52aWV3cG9ydFBvaW50VG9SYXkodGhpcy5tb3VzZVBvaW50LCB0aGlzLnJheSk7XHJcblxyXG4gICAgICAgIC8vIGdldCBidWxsZXQgc2hvb3RpbmcgZGlyZWN0aW9uXHJcbiAgICAgICAgaWYgKHRoaXMuc2NlbmUzRC5waHlzaWNzU2ltdWxhdGlvbi5yYXlDYXN0KHRoaXMucmF5LCB0aGlzLmhpdFJlc3VsdCwgMzApKSB7XHJcbiAgICAgICAgICAgIC8vIGRpcmVjdGlvbiB2ZWN0b3I6IFtidWxsZXQgaW5pdCBwb2ludF0gdG8gW21vdXNlIGhpdCBwb2ludF1cclxuICAgICAgICAgICAgTGF5YS5WZWN0b3IzLnN1YnRyYWN0KHRoaXMuaGl0UmVzdWx0LnBvaW50LCBDb25zdC5CdWxsZXRJbml0UG9zLCB0aGlzLmJ1bGxldERpcmVjdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBkaXJlY3Rpb24gdmVjdG9yOiBbY2FtZXJhIHBvaW50XSB0byBbbW91c2UgaGl0IHBvaW50XVxyXG4gICAgICAgICAgICB2YXIgYVYzOiBMYXlhLlZlY3RvcjMgPSBuZXcgTGF5YS5WZWN0b3IzKCk7XHJcbiAgICAgICAgICAgIC8vIHJheSBkaXJlY3Rpb24gc2NhbGU6IHRvIGRlcHRoIHNjYWxlWlxyXG4gICAgICAgICAgICBsZXQgc2NhbGVWOiBudW1iZXIgPSB0aGlzLmNhbWVyYS5mYXJQbGFuZTtcclxuICAgICAgICAgICAgc2NhbGVWID0gMTA7XHJcbiAgICAgICAgICAgIExheWEuVmVjdG9yMy5zY2FsZSh0aGlzLnJheS5kaXJlY3Rpb24sIHNjYWxlViwgYVYzKTtcclxuICAgICAgICAgICAgLy8gZGlyZWN0aW9uIHZlY3RvcjogW2J1bGxldCBpbml0IHBvaW50XSB0byBbY2FtZXJhIHBvaW50XVxyXG4gICAgICAgICAgICB2YXIgYlYzOiBMYXlhLlZlY3RvcjMgPSBuZXcgTGF5YS5WZWN0b3IzKCk7XHJcbiAgICAgICAgICAgIExheWEuVmVjdG9yMy5zdWJ0cmFjdCh0aGlzLmNhbWVyYS50cmFuc2Zvcm0ucG9zaXRpb24sIENvbnN0LkJ1bGxldEluaXRQb3MsIGJWMyk7XHJcbiAgICAgICAgICAgIC8vIGRpcmVjdGlvbiB2ZWN0b3I6IFtidWxsZXQgaW5pdCBwb2ludF0gdG8gW21vdXNlIGhpdCBwb2ludF1cclxuICAgICAgICAgICAgTGF5YS5WZWN0b3IzLmFkZChhVjMsIGJWMywgdGhpcy5idWxsZXREaXJlY3Rpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBMYXlhLlZlY3RvcjMubm9ybWFsaXplKHRoaXMuYnVsbGV0RGlyZWN0aW9uLCB0aGlzLmJ1bGxldERpcmVjdGlvbik7XHJcbiAgICAgICAgdGhpcy5idWxsZXRWZWxvY2l0eSA9IDUwO1xyXG4gICAgICAgIExheWEuVmVjdG9yMy5zY2FsZSh0aGlzLmJ1bGxldERpcmVjdGlvbiwgdGhpcy5idWxsZXRWZWxvY2l0eSwgdGhpcy5idWxsZXREaXJlY3Rpb24pO1xyXG5cclxuICAgICAgICAvLyBnZW5lcmF0ZSBidWxsZXRcclxuICAgICAgICBsZXQgYnVsbGV0OiBMYXlhLk1lc2hTcHJpdGUzRCA9IHRoaXMuX2J1bGxldC5jbG9uZSgpO1xyXG4gICAgICAgIGJ1bGxldC5uYW1lID0gXCJidWxsZXRcIjtcclxuICAgICAgICB0aGlzLnNjZW5lM0QuYWRkQ2hpbGQoYnVsbGV0KTtcclxuICAgICAgICBsZXQgYnVsbGV0UmlnaWQ6IExheWEuUmlnaWRib2R5M0QgPSBidWxsZXQuZ2V0Q29tcG9uZW50KExheWEuUmlnaWRib2R5M0QpO1xyXG4gICAgICAgIGJ1bGxldFJpZ2lkLmxpbmVhclZlbG9jaXR5ID0gdGhpcy5idWxsZXREaXJlY3Rpb24uY2xvbmUoKTtcclxuICAgIH1cclxufSIsIi8qKlRoaXMgY2xhc3MgaXMgYXV0b21hdGljYWxseSBnZW5lcmF0ZWQgYnkgTGF5YUFpcklERSwgcGxlYXNlIGRvIG5vdCBtYWtlIGFueSBtb2RpZmljYXRpb25zLiAqL1xuaW1wb3J0IFZpZXc9TGF5YS5WaWV3O1xyXG5pbXBvcnQgRGlhbG9nPUxheWEuRGlhbG9nO1xyXG5pbXBvcnQgU2NlbmU9TGF5YS5TY2VuZTtcbnZhciBSRUc6IEZ1bmN0aW9uID0gTGF5YS5DbGFzc1V0aWxzLnJlZ0NsYXNzO1xuZXhwb3J0IG1vZHVsZSB1aS5nYW1lIHtcclxuICAgIGV4cG9ydCBjbGFzcyBHYW1lU2NlbmVVSSBleHRlbmRzIFNjZW5lIHtcclxuICAgICAgICBjb25zdHJ1Y3RvcigpeyBzdXBlcigpfVxyXG4gICAgICAgIGNyZWF0ZUNoaWxkcmVuKCk6dm9pZCB7XHJcbiAgICAgICAgICAgIHN1cGVyLmNyZWF0ZUNoaWxkcmVuKCk7XHJcbiAgICAgICAgICAgIHRoaXMubG9hZFNjZW5lKFwiZ2FtZS9HYW1lU2NlbmVcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgUkVHKFwidWkuZ2FtZS5HYW1lU2NlbmVVSVwiLEdhbWVTY2VuZVVJKTtcclxufVxyIl19
