var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function i(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(i.prototype=a.prototype,new i)}}();!function(){function e(t,a,i){function n(r,s){if(!a[r]){if(!t[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(o)return o(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var u=a[r]={exports:{}};t[r][0].call(u.exports,function(e){return n(t[r][1][e]||e)},u,u.exports,e,t,a,i)}return a[r].exports}for(var o="function"==typeof require&&require,r=0;r<i.length;r++)n(i[r]);return n}return e}()({1:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("./script/runtime/GameScene"),n=e("./script/runtime/HomeView"),o=function(){function e(){}return e.init=function(){var e=Laya.ClassUtils.regClass;e("script/runtime/GameScene.ts",i.default),e("script/runtime/HomeView.ts",n.default)},e.width=720,e.height=1280,e.scaleMode="showall",e.screenMode="vertical",e.alignV="middle",e.alignH="center",e.startScene="home/HomeView.scene",e.sceneRoot="",e.debug=!1,e.stat=!1,e.physicsDebug=!1,e.exportSceneToJson=!0,e}();a.default=o,o.init()},{"./script/runtime/GameScene":8,"./script/runtime/HomeView":9}],2:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("./GameConfig");new(function(){function e(){window.Laya3D?Laya3D.init(i.default.width,i.default.height):Laya.init(i.default.width,i.default.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=i.default.scaleMode,Laya.stage.screenMode=i.default.screenMode,Laya.URL.exportSceneToJson=i.default.exportSceneToJson,(i.default.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),i.default.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),i.default.stat&&Laya.Stat.show(),Laya.alertGlobalError=!0,Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}return e.prototype.onVersionLoaded=function(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))},e.prototype.onConfigLoaded=function(){i.default.startScene&&Laya.Scene.open(i.default.startScene)},e}())},{"./GameConfig":1}],3:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.VERSION="1.0.0",a.RewardPos={OverShare:"OverShare",Revive:"revive"},a.BannerPos={HomeView:"HomeView",GameScene:"HomeView",OverView:"HomeView",ReviveDialog:"HomeView"},a.ReviveCountdown=5,a.URL_HomeView="home/HomeView.scene",a.URL_GameScene="game/GameScene.scene",a.URL_OverView="over/OverView.scene",a.URL_ReviveView="dialog/ReviveView.scene",a.CameraInitPos=new Laya.Vector3(0,.3,.2),a.CameraInitRotEuler=new Laya.Vector3(0,0,0),a.LightInitPos=new Laya.Vector3(0,5,0),a.LightInitRotEuler=new Laya.Vector3(-30,0,0),a.LightInitColor=new Laya.Vector3(1,1,1),a.StageTexUrl=["res/stage/out/materials/mutou_06.jpg","res/stage/out/materials/box 13.png","res/stage/out/materials/TNT.png"],a.StageResUrl="res/stage/out/",a.StageInitPos=new Laya.Vector3(0,0,0),a.StageInitRot=new Laya.Vector3(0,180,0),a.StageInitScale=new Laya.Vector3(20,20,20),a.StageNum=74,a.MaxWinCheckTime=30,a.SetKinematicWaitTime=10,a.BgResUrl=["res/scene/Scenes_02.lh","res/scene/Scenes_04.lh","res/scene/Scenes_07.lh"],a.GlassBrokenVelocity=14,a.GlassFallingBrokenVelocity=1,a.PieceResUrl="res/cube_piece.lm",a.PiecesNum=3,a.PiecesBrokenTime=120,a.CannonResUrl={1:"res/cannon/Cannon_01.lh",2:"res/cannon/Cannon_22.lh"},a.CannonInitPos=new Laya.Vector3(0,.04,-.17),a.CannonInitRot=new Laya.Vector3(0,180,0),a.CannonInitScale=new Laya.Vector3(25,25,25),a.TurretInitLocalRot=new Laya.Vector3(0,0,0),a.BulletResUrl={1:"res/bullet/blackhole.lh"},a.BulletRadius=.08,a.BulletScale={1:1,2:1.2},a.BulletMass={1:40,2:10},a.BulletVelocity={1:40,2:40}},{}],4:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default={gameData:{musicEnabled:!0,soundEnabled:!0,vibrationEnabled:!0,updateTimestamp:0,videoCount:0,lastVideoTimestamp:0,shareCount:0,lastShareTimestamp:0,stageIndex:1,cannonType:1},config:{skin_block:!1,share_first:!1,allow_share:!0,allow_video:!0,share_number:5,video_number:6,share_time:30,banner_time:180,share_delay:4,online:!0,debug:!1,allow_pay:!1,allow_revive:!0,banner_delay:1,banner_delay_ratio:.8,banner_delay_ratio1:.8,share_fail:"'操作失败，请换个群'",distance_iphonex:50,banner_click_time:2,games:{},shares:{},videos:{},banners:{}},user:{},audio:{volume:.5}}},{}],5:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("../runtime/GameScene"),n=e("../Const"),o=function(e){function t(){var t=e.call(this)||this;return t.collisionBlackList=["bullet","player"],t}return __extends(t,e),t.prototype.onAwake=function(){this.bullet||(this.bullet=this.owner)},t.prototype.init=function(){this.rigidbody=this.bullet.addComponent(Laya.Rigidbody3D),this.rigidbody.colliderShape=new Laya.SphereColliderShape(n.BulletRadius),this.material=new Laya.PBRSpecularMaterial,this.bullet.meshRenderer.material=this.material},t.prototype.reset=function(e){this.bullet=this.owner,void 0===this.rigidbody&&this.init(),this.type=e,this.lifetime=120,this.flag_active=!1,this.material.renderMode=Laya.PBRSpecularMaterial.RENDERMODE_FADE,this.material.albedoColorA=0,this.bullet.transform.localPosition=i.default.instance.turretInitPos.clone(),Laya.Vector3.scale(new Laya.Vector3(1,1,1),n.BulletScale[this.type],this.bullet.transform.localScale),this.rigidbody.ccdMotionThreshold=.001,this.rigidbody.ccdSweptSphereRadius=n.BulletRadius*n.BulletScale[this.type],this.rigidbody.mass=n.BulletMass[this.type];var t=i.default.instance.bulletDirection.clone();Laya.Vector3.scale(t,n.BulletVelocity[this.type],t),this.rigidbody.linearVelocity=t.clone(),"bulletTrigger"===this.bullet.name&&(this.rigidbody.isTrigger=!0,this.rigidbody.ccdMotionThreshold=.001,this.rigidbody.ccdSweptSphereRadius=n.BulletRadius*n.BulletScale[this.type]/1e3)},t.prototype.onCollisionExit=function(e){"bulletTrigger"===this.bullet.name&&this.recover()},t.prototype.onUpdate=function(){this.lifetime--,this.lifetime<0&&this.recover(),"bullet"===this.bullet.name&&!this.flag_active&&this.bullet.transform.position.z<-1&&(this.refreshMaterial(),this.flag_active=!0)},t.prototype.refreshMaterial=function(){1===this.type?(this.material.renderMode=Laya.PBRSpecularMaterial.RENDERMODE_OPAQUE,this.material.albedoColor=new Laya.Vector4(1,0,0,1)):2===this.type&&(this.material.renderMode=Laya.PBRSpecularMaterial.RENDERMODE_TRANSPARENT,this.material.albedoColor=new Laya.Vector4(.2,.2,1,.7))},t.prototype.recover=function(){var e=this;Laya.timer.frameOnce(1,this,function(){e.bullet.removeSelf(),"bulletTrigger"===e.bullet.name?Laya.Pool.recover("bulletTrigger",e.bullet):Laya.Pool.recover("bullet",e.bullet)})},t}(Laya.Script3D);a.default=o},{"../Const":3,"../runtime/GameScene":8}],6:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("../Const"),n=function(e){function t(){var t=e.call(this)||this;return t.moveTimes=0,t}return __extends(t,e),t.prototype.onAwake=function(){this.guard=this.owner;var e=this.guard.meshFilter.sharedMesh.boundingBox.clone();this.sizeX=e.max.x-e.min.x,this.sizeY=e.max.y-e.min.y,this.sizeZ=e.max.z-e.min.z;this.guard.addComponent(Laya.PhysicsCollider).colliderShape=new Laya.BoxColliderShape(this.sizeX,this.sizeY,this.sizeZ);var t=new Laya.PBRSpecularMaterial;if(Laya.Texture2D.load(i.StageTexUrl[0],Laya.Handler.create(this,function(e){t.albedoTexture=e})),t.specularColor=new Laya.Vector4(0,0,0,1),t.enableEmission=!0,t.emissionColor=new Laya.Vector4(.2,.2,.2,1),this.guard.meshRenderer.material=t,this.guard.name.search("move_x")>=0)this.MaxMoveTimes=120,this.moveStepY=0,0===Math.floor((Math.abs(this.guard.transform.localRotationEulerZ)+90.5)%180)?this.moveStepX=2*this.guard.transform.localPositionY/this.MaxMoveTimes:this.moveStepX=2*this.guard.transform.localPositionX/this.MaxMoveTimes;else if(this.guard.name.search("move_y")>=0)this.MaxMoveTimes=120,this.moveStepX=0,0===Math.floor((Math.abs(this.guard.transform.localRotationEulerZ)+90.5)%180)?this.moveStepY=2*this.guard.transform.localPositionX/this.MaxMoveTimes:this.moveStepY=2*this.guard.transform.localPositionY/this.MaxMoveTimes;else if(this.guard.name.search("move_")>=0){this.MaxMoveTimes=60;var a=this.sizeX*this.guard.transform.localScaleX/2/this.MaxMoveTimes,n=this.sizeY*this.guard.transform.localScaleY/2/this.MaxMoveTimes;if(0===Math.floor((Math.abs(this.guard.transform.localRotationEulerZ)+90.5)%180)){var o=a;a=n,n=o}this.guard.name.search("move_left")>=0?(this.moveStepX=-a,this.moveStepY=0):this.guard.name.search("move_right")>=0?(this.MaxMoveTimes=60,this.moveStepX=a,this.moveStepY=0):this.guard.name.search("move_up")>=0?(this.MaxMoveTimes=60,this.moveStepX=0,this.moveStepY=-n):this.guard.name.search("move_down")>=0&&(this.MaxMoveTimes=60,this.moveStepX=0,this.moveStepY=n)}},t.prototype.onUpdate=function(){this.guard.destroyed?this.destroy():this.guard.name.search("move")>=0?(this.moveTimes=(this.moveTimes+1)%(2*this.MaxMoveTimes),this.flag_move=Math.floor(this.moveTimes/this.MaxMoveTimes%2)>0,this.flag_move?(this.guard.transform.localPositionX+=this.moveStepX,this.guard.transform.localPositionY+=this.moveStepY):(this.guard.transform.localPositionX-=this.moveStepX,this.guard.transform.localPositionY-=this.moveStepY)):this.guard.name.search("rotate_left")>=0?this.guard.transform.localRotationEulerY=(this.guard.transform.localRotationEulerY+1)%360:this.guard.name.search("rotate_right")>=0?this.guard.transform.localRotationEulerY=(this.guard.transform.localRotationEulerY-1)%360:this.guard.name.search("rotate_up")>=0?this.guard.transform.localRotationEulerX=(this.guard.transform.localRotationEulerX+1)%360:this.guard.name.search("rotate_down")>=0&&(this.guard.transform.localRotationEulerX=(this.guard.transform.localRotationEulerX-1)%360)},t}(Laya.Script3D);a.default=n},{"../Const":3}],7:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("../Const"),n=e("../runtime/GameScene"),o=e("../component/Bullet"),r=function(e){function t(){var t=e.call(this)||this;return t.type=0,t.collisionWhiteList=["bullet","Obstacle"],t.piecesList=[],t.jumpCnt=0,t}return __extends(t,e),t.prototype.onAwake=function(){var e=this;this.target=this.owner,this.setRigidbody(),Laya.timer.frameOnce(i.SetKinematicWaitTime,this,function(){n.default.instance.isStageStart||(e.rigidbody.isKinematic=!0)}),this.initPieces()},t.prototype.onCollisionEnter=function(e){this.collisionHandler(e)},t.prototype.onCollisionStay=function(e){this.collisionHandler(e)},t.prototype.onCollisionExit=function(e){this.collisionHandler(e)},t.prototype.collisionHandler=function(e){for(var t=this,a=e.other.owner,r=!1,s=0,l=this.collisionWhiteList;s<l.length;s++){var c=l[s];if(a.name.indexOf(c)>=0){r=!0;break}}if("stand"===a.name||a.name.indexOf("Guard")>=0)n.default.instance.winCheckCnt=0;else if("ground"===a.name)Laya.timer.frameOnce(60,this,function(){t.destroy(),t.target.destroy()});else if("bullet"===a.name||"bulletTrigger"===a.name){2===a.getComponent(o.default).type&&1!==this.type&&this.setType(1)}else if("bomb"===a.name){var u=new Laya.Vector3;Laya.Vector3.subtract(this.target.transform.position,a.transform.position,u),Laya.Vector3.normalize(u,u),Laya.Vector3.scale(u,3/a.transform.localScaleX,u),Laya.Vector3.add(this.rigidbody.linearVelocity,u,u),this.rigidbody.linearVelocity=u}if(1===this.type){if(this.jumpCnt>60){(h=Laya.Vector3.distance(this.rigidbody.linearVelocity,new Laya.Vector3(0,0,0)))>=i.GlassFallingBrokenVelocity&&this.broken()}if(r){var d=a.getComponent(Laya.Rigidbody3D).linearVelocity.clone(),h=Laya.Vector3.distance(this.rigidbody.linearVelocity,new Laya.Vector3(0,0,0)),f=Laya.Vector3.distance(d,new Laya.Vector3(0,0,0));(h>=i.GlassBrokenVelocity||f>=i.GlassBrokenVelocity)&&this.broken()}else"ground"!==a.name&&"bomb"!==a.name||this.broken()}else if(2===this.type&&(a.name.indexOf("bullet")>=0||a.name.indexOf("bomb")>=0)&&this.target.parent){console.log("hit by"),console.log(a.name);var m=this.sizeX/2*this.target.transform.localScaleX*1,g=new Laya.MeshSprite3D(Laya.PrimitiveMesh.createSphere(m));this.target.parent.addChild(g),g.name="bomb";var p=g.addComponent(Laya.PhysicsCollider);p.colliderShape=new Laya.SphereColliderShape(m),p.isTrigger=!0,p.canCollideWith=1,g.transform.localPosition=this.target.transform.localPosition.clone(),g.transform.localScale=this.target.transform.localScale.clone();var y=new Laya.UnlitMaterial;g.meshRenderer.material=y,y.renderMode=Laya.UnlitMaterial.RENDERMODE_TRANSPARENT,y.albedoColor=new Laya.Vector4(1,.5,0,.2),Laya.timer.frameOnce(1,this,function(){t.target.removeSelf()});var v=0;g.timer.frameLoop(1,g,function(){if(v++>12)return g.timer.clearAll(g),g.destroy(),t.target.destroy(),void t.destroy();g.transform.localScaleX*=1.2,g.transform.localScaleY*=1.2,g.transform.localScaleZ*=1.2})}this.jumpCnt=0},t.prototype.onUpdate=function(){this.target.destroyed?this.destroy():(this.rigidbody.isKinematic&&n.default.instance.isStageStart&&(this.rigidbody.isKinematic=!1),this.jumpCnt++,this.refreshRenderMode(),this.distance=Laya.Vector3.distance(this.target.transform.position,n.default.instance.gameStage.transform.position),this.distance<20&&(n.default.instance.winCheckCnt=0),this.rigidbody&&0==this.rigidbody.isActive&&(console.log("Physics_engine_bug_fixing: Reset rigidbody."),this.refreshRigidbody()))},t.prototype.refreshRenderMode=function(){1===this.type?this.material.renderMode=Laya.PBRSpecularMaterial.RENDERMODE_TRANSPARENT:this.material.renderMode=Laya.PBRSpecularMaterial.RENDERMODE_OPAQUE},t.prototype.refreshRigidbody=function(){this.rigidbody&&(console.log("refresh rigidbody"),this.rigidbody.destroy(),this.setRigidbody())},t.prototype.setType=function(e){var t=this;this.type=e,this.material=this.target.meshRenderer.material,this.material||(this.material=new Laya.PBRSpecularMaterial,this.target.meshRenderer.material=this.material),0===this.type?(Laya.Texture2D.load(i.StageTexUrl[1],Laya.Handler.create(this,function(e){t.material.albedoTexture=e})),this.material.specularColor=new Laya.Vector4(0,0,0,1),this.material.enableEmission=!0,this.material.emissionColor=new Laya.Vector4(.1,.1,.1,1)):1===this.type?(this.material.albedoTexture=null,this.material.albedoColor=new Laya.Vector4(.7,.7,1,.7),this.material.specularColor=new Laya.Vector4(0,0,0,1),this.material.enableEmission=!0,this.material.emissionColor=new Laya.Vector4(.2,.2,.2,1)):2===this.type&&(Laya.Texture2D.load(i.StageTexUrl[2],Laya.Handler.create(this,function(e){t.material.albedoTexture=e})),this.material.specularColor=new Laya.Vector4(0,0,0,1),this.material.enableEmission=!0,this.material.emissionColor=new Laya.Vector4(.1,.1,.1,1)),this.refreshRenderMode()},t.prototype.setRigidbody=function(){var e=this.target.meshFilter.sharedMesh.boundingBox.clone();if(this.sizeX=e.max.x-e.min.x,this.sizeY=e.max.y-e.min.y,this.sizeZ=e.max.z-e.min.z,this.rigidbody=this.target.addComponent(Laya.Rigidbody3D),this.target.name.search("Cube")>=0)this.rigidbody.colliderShape=new Laya.BoxColliderShape(this.sizeX,this.sizeY,this.sizeZ);else if(this.target.name.search("Cylinder")>=0)this.rigidbody.colliderShape=new Laya.CylinderColliderShape(this.sizeX/2,this.sizeY);else{var t=new Laya.MeshColliderShape;t.mesh=this.target.meshFilter.sharedMesh,this.rigidbody.colliderShape=t}this.setPhysicsParam()},t.prototype.setPhysicsParam=function(){this.rigidbody.isKinematic=!1,0===this.type?(this.rigidbody.mass=10,this.rigidbody.friction=10):1===this.type&&(this.rigidbody.mass=10,this.rigidbody.friction=10)},t.prototype.broken=function(){var e=this;this.effectPiecesBroken(),Laya.timer.frameOnce(2,this,function(){e.target.active=!1})},t.prototype.initPieces=function(){var e=this;Laya.Mesh.load(i.PieceResUrl,Laya.Handler.create(this,function(t){var a=new Laya.MeshSprite3D(t);a.active=!1,a.name="piece";var o=new Laya.PBRSpecularMaterial;o.renderMode=Laya.PBRSpecularMaterial.RENDERMODE_TRANSPARENT,o.albedoTexture=null,o.albedoColor=new Laya.Vector4(.7,.7,1,.7),o.specularColor=new Laya.Vector4(0,0,0,1),o.enableEmission=!0,o.emissionColor=new Laya.Vector4(.2,.2,.2,1),a.meshRenderer.material=o;var r=a.addComponent(Laya.Rigidbody3D),s=new Laya.MeshColliderShape;s.mesh=a.meshFilter.sharedMesh,r.colliderShape=s,r.collisionGroup=2;for(var l=0;l<i.PiecesNum;l++)e.piecesList.push(a.clone()),n.default.instance.scene3D.addChild(e.piecesList[l])}))},t.prototype.effectPiecesBroken=function(){var e=this,t=function(t){a.piecesList[t].active=!0;var n=1.5*(.5*Math.random()+.5)*a.sizeX*a.target.transform.localScaleX*i.StageInitScale.x,o=1.5*(.5*Math.random()+.5)*a.sizeY*a.target.transform.localScaleY*i.StageInitScale.y,r=1.5*(.5*Math.random()+.5)*a.sizeZ*a.target.transform.localScaleZ*i.StageInitScale.z;a.piecesList[t].transform.localScale=new Laya.Vector3(n,o,r),a.piecesList[t].transform.localRotationEulerX=2*(Math.random()-.5)*90,a.piecesList[t].transform.localRotationEulerY=2*(Math.random()-.5)*90,a.piecesList[t].transform.localRotationEulerZ=2*(Math.random()-.5)*90;var s=new Laya.Vector3;s.x=(Math.random()-.5)*i.StageInitScale.x/80,s.y=(Math.random()-.5)*i.StageInitScale.y/80,s.z=(Math.random()-.5)*i.StageInitScale.z/80,a.piecesList[t].transform.position=a.target.transform.position.clone(),Laya.Vector3.add(a.piecesList[t].transform.localPosition,s,a.piecesList[t].transform.localPosition),Laya.Vector3.scale(s,50,s),Laya.Vector3.add(s,a.rigidbody.linearVelocity,s),a.piecesList[t].getComponent(Laya.Rigidbody3D).linearVelocity=s.clone(),Laya.Tween.to(a.piecesList[t].transform.localScale,{x:n/2,y:o/2,z:r/2},i.PiecesBrokenTime/60*1e3,Laya.Ease.linearNone),Laya.Tween.to(a.piecesList[t].meshRenderer.material,{albedoColorA:0},i.PiecesBrokenTime/60*1e3,Laya.Ease.linearNone,Laya.Handler.create(a,function(){e.piecesList[+t].destroy()}))},a=this;for(var n in this.piecesList)t(n)},t}(Laya.Script3D);a.default=r},{"../Const":3,"../component/Bullet":5,"../runtime/GameScene":8}],8:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("../../ui/layaMaxUI"),n=e("../Const"),o=e("../Global"),r=e("../component/Bullet"),s=e("../component/Target"),l=e("../component/Guard"),c=e("./HomeView"),u=function(e){function t(){var a=e.call(this)||this;return a.bgIdx=0,a.MaxBulletNum=100,a.currBulletNum=0,a.winCheckCnt=0,a.isStageStart=!1,a.cannonType=1,a.isRecoil=!1,a.MaxRecoilTime=8,a.bulletType=1,a.bulletDirection=new Laya.Vector3,a.mousePoint=new Laya.Vector2,a.ray=new Laya.Ray(new Laya.Vector3(0,0,0),new Laya.Vector3(0,0,0)),a.hitResult=new Laya.HitResult,a.state=0,console.log("GameScene constructor()"),t.instance=a,a.initScene3D(),a.newCannon(),Laya.loader.load(n.StageTexUrl),a.scene3D.physicsSimulation.fixedTimeStep=.5/60,a}return __extends(t,e),t.openInstance=function(e){t.instance?t.instance.onOpened(e):Laya.Scene.open(n.URL_GameScene,!1,e)},t.prototype.onOpened=function(e){console.log("GameScene onOpened()"),this.visible=!0,this.lvlLabel.visible=!0,this.showUI(),this.stageIdx=o.default.gameData.stageIndex,this.newStage()},t.prototype.onEnable=function(){this.bindButtons()},t.prototype.initScene3D=function(){var e=this;this.scene3D=this.scene3DBox.addChild(new Laya.Scene3D),this.camera=this.scene3D.addChild(new Laya.Camera),this.camera.transform.localPosition=n.CameraInitPos.clone(),this.camera.transform.localRotationEuler=n.CameraInitRotEuler.clone(),this.camera.clearColor=null,this.directionLight=this.scene3D.addChild(new Laya.DirectionLight),this.directionLight.transform.localPosition=n.LightInitPos.clone(),this.directionLight.transform.localRotationEuler=n.LightInitRotEuler.clone(),this.directionLight.color=n.LightInitColor.clone(),Laya.Sprite3D.load(n.BgResUrl[this.bgIdx],Laya.Handler.create(this,function(t){e.background=e.scene3D.addChild(t),e.background.transform.localPosition=n.StageInitPos.clone(),e.background.transform.localRotationEuler=n.StageInitRot.clone(),e.background.transform.localScale=n.StageInitScale.clone();var a=e.background.getComponent(Laya.Animator);if(a&&a.destroy(),0===e.bgIdx){e.cloud0=e.background.getChildByName("Scenes_02").getChildByName("cloud01"),e.cloud1=e.background.getChildByName("Scenes_02").getChildByName("cloud03");var i=e.background.getChildByName("Scenes_02").getChildByName("Plane").getChildByName("Plane_0");i.name="ground";i.addComponent(Laya.PhysicsCollider).colliderShape=new Laya.StaticPlaneColliderShape(new Laya.Vector3(0,1,0),0)}}))},t.prototype.newCannon=function(){var e=this;this.cannon&&this.cannon.destroy(),Laya.Sprite3D.load(n.CannonResUrl[this.cannonType],Laya.Handler.create(this,function(t){e.cannon=t,e.scene3D.addChild(e.cannon),e.cannon.name="player",e.cannon.transform.localPosition=n.CannonInitPos.clone(),e.cannon.transform.localRotationEuler=n.CannonInitRot.clone(),e.cannon.transform.localScale=n.CannonInitScale.clone(),e.turret=e.cannon.getChildByName("Turret_0"),e.turretInitPos=e.turret.transform.position.clone()}))},t.prototype.showUI=function(){this.btn_back.visible=!0,this.btn_cannon.visible=!0},t.prototype.hideUI=function(){this.btn_back.visible=!1,this.btn_cannon.visible=!1,this.btn_restart.visible=!1,this.btn_next.visible=!1,this.winLabel.visible=!1},t.prototype.bindButtons=function(){var e=this;this.btn_back.on(Laya.Event.CLICK,this,function(){e.cleanStage(),e.hideUI(),e.turret&&(e.turret.transform.localRotationEuler=n.TurretInitLocalRot.clone()),c.default.openInstance()}),this.btn_cannon.on(Laya.Event.CLICK,this,function(){1===e.cannonType?(e.cannonType=2,e.bulletType=e.cannonType,e.newCannon()):(e.cannonType=1,e.bulletType=e.cannonType,e.newCannon())}),this.btn_restart.on(Laya.Event.CLICK,this,function(){e.restart()}),this.btn_next.on(Laya.Event.CLICK,this,function(){e.nextStage()})},t.prototype.cleanStage=function(){this.gameStage&&(this.gameStage.destroyChildren(),this.gameStage.destroy(),this.gameStage.timer.clearAll(this))},t.prototype.newStage=function(){var e=this;this.cleanStage(),this.winLabel.visible=!1,this.btn_restart.visible=!1,this.btn_next.visible=!1,this.currBulletNum=0,this.winCheckCnt=0,this.isStageStart=!1,this.isRecoil=!1,this.recoilTime=this.MaxRecoilTime,this.winLabel.visible=!1,this.bulletType=this.cannonType,this.turret&&(this.turret.transform.localRotationEuler=n.TurretInitLocalRot.clone());var t=n.StageResUrl+this.stageIdx+".lh";Laya.Sprite3D.load(t,Laya.Handler.create(this,function(t){e.gameStage=e.scene3D.addChild(t),e.lvlLabel.changeText("Level "+e.stageIdx),e.gameStage.transform.localPosition=n.StageInitPos.clone(),e.gameStage.transform.localRotationEuler=n.StageInitRot.clone(),e.gameStage.transform.localScale=n.StageInitScale.clone();var a=e.gameStage.getComponent(Laya.Animator);a&&a.destroy();for(var i,o=0;o<e.gameStage.numChildren;o++)if(i=e.gameStage.getChildAt(o),i.meshRenderer.castShadow=!1,i.name.search("Obstacle")>=0){var r=i.addComponent(s.default);i.name.search("Glass")>=0?r.setType(1):i.name.search("TNT")>=0?r.setType(2):r.setType(0)}else if(i.name.search("Cube")>=0){i.name="stand";var c=i.addComponent(Laya.PhysicsCollider),u=i.meshFilter.sharedMesh.boundingBox.clone(),d=u.max.x-u.min.x,h=u.max.y-u.min.y,f=u.max.z-u.min.z;c.colliderShape=new Laya.BoxColliderShape(d,h,f),Laya.Texture2D.load(n.StageTexUrl[0],Laya.Handler.create(e,function(e){var t=new Laya.PBRSpecularMaterial;t.renderMode=Laya.PBRSpecularMaterial.RENDERMODE_OPAQUE,t.albedoTexture=e,i.meshRenderer.material=t}))}else if(i.name.search("Cylinder")>=0){i.name="stand";var c=i.addComponent(Laya.PhysicsCollider),m=new Laya.MeshColliderShape;m.mesh=i.meshFilter.sharedMesh,c.colliderShape=m,Laya.Texture2D.load(n.StageTexUrl[0],Laya.Handler.create(e,function(e){var t=new Laya.PBRSpecularMaterial;t.renderMode=Laya.PBRSpecularMaterial.RENDERMODE_OPAQUE,t.albedoTexture=e,i.meshRenderer.material=t}))}else if(i.name.search("Guard")>=0)i.addComponent(l.default);else i.destroy();e.gameStage.frameLoop(1,e,e.stageLooping),e.scene3DBox.on(Laya.Event.CLICK,e,e.onClick)}))},t.prototype.stageLooping=function(){this.winCheckCnt++>=n.MaxWinCheckTime&&(console.log("You win. Stage: "+this.stageIdx),this.scene3DBox.off(Laya.Event.CLICK,this,this.onClick),this.winLabel.visible=!0,this.btn_restart.visible=!0,this.btn_next.visible=!0,this.gameStage.timer.clear(this,this.stageLooping)),this.isRecoil&&(this.recoilTime<this.MaxRecoilTime?(this.recoilTime<this.MaxRecoilTime/4?(this.turret.transform.localPositionX+=5e-4*this.bulletDirection.x,this.turret.transform.localPositionY+=5e-4*this.bulletDirection.y,this.turret.transform.localPositionZ+=5e-4*this.bulletDirection.z):(this.turret.transform.localPositionX-=3e-4*this.bulletDirection.x,this.turret.transform.localPositionY-=3e-4*this.bulletDirection.y,this.turret.transform.localPositionZ-=3e-4*this.bulletDirection.z),this.recoilTime++):(this.turret.transform.position=this.turretInitPos.clone(),this.isRecoil=!1,this.recoilTime=this.MaxRecoilTime)),this.background&&this.bgMoving()},t.prototype.restart=function(){this.newStage()},t.prototype.nextStage=function(){this.stageIdx++,this.stageIdx<=n.StageNum?this.newStage():console.log("通关")},t.prototype.onClick=function(){if(this.gameStage&&this.cannon){if(this.mousePoint.x=Laya.MouseManager.instance.mouseX,this.mousePoint.y=Laya.MouseManager.instance.mouseY,this.camera.viewportPointToRay(this.mousePoint,this.ray),this.scene3D.physicsSimulation.rayCast(this.ray,this.hitResult,30,1,1))Laya.Vector3.subtract(this.hitResult.point,this.turretInitPos,this.bulletDirection);else{var e=new Laya.Vector3;this.camera.farPlane;20,Laya.Vector3.scale(this.ray.direction,20,e);var t=new Laya.Vector3;Laya.Vector3.subtract(this.camera.transform.position,this.turretInitPos,t),Laya.Vector3.add(e,t,this.bulletDirection)}var a=this.bulletDirection.z<0;Laya.Vector3.normalize(this.bulletDirection,this.bulletDirection),this.physicsStartCheck(),this.createBullet(),this.turret.transform.localRotationEuler=n.TurretInitLocalRot.clone(),a&&(this.turret.transform.localRotationEulerX-=90*this.bulletDirection.y,this.turret.transform.localRotationEulerY-=90*this.bulletDirection.x),this.isRecoil=!0,this.recoilTime=0}},t.prototype.physicsStartCheck=function(){if(!this.isStageStart){var e=new Laya.SphereColliderShape(n.BulletRadius*n.BulletScale[this.bulletType]*3),t=[],a=this.bulletDirection.clone();if(Laya.Vector3.scale(a,n.BulletVelocity[this.bulletType],a),this.scene3D.physicsSimulation.shapeCastAll(e,this.turretInitPos,a,t))for(var i in t)if(t[i].collider.owner.name.indexOf("Obstacle")>=0){this.isStageStart=!0;break}}},t.prototype.createBullet=function(e){void 0===e&&(e=this.bulletType),this.currBulletNum++;var t=Laya.Pool.getItem("bullet");t||((t=new Laya.MeshSprite3D(Laya.PrimitiveMesh.createSphere(n.BulletRadius))).name="bullet",t.addComponent(r.default));t.getComponent(r.default).reset(e),this.scene3D.addChild(t);var a=Laya.Pool.getItem("bulletTrigger");a||((a=new Laya.MeshSprite3D(Laya.PrimitiveMesh.createSphere(n.BulletRadius))).name="bulletTrigger",a.addComponent(r.default));a.getComponent(r.default).reset(e),this.scene3D.addChild(a)},t.prototype.bgMoving=function(){0===this.bgIdx&&(this.cloud0.transform.localPositionX>.5&&(this.cloud0.transform.localPositionX=-.5),this.cloud0.transform.localPositionX+=7e-4,this.cloud1.transform.localPositionX<-.5&&(this.cloud1.transform.localPositionX=.5),this.cloud1.transform.localPositionX-=5e-4)},t}(i.ui.game.GameSceneUI);a.default=u},{"../../ui/layaMaxUI":14,"../Const":3,"../Global":4,"../component/Bullet":5,"../component/Guard":6,"../component/Target":7,"./HomeView":9}],9:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("./../../ui/layaMaxUI"),n=e("./GameScene"),o=e("../Const"),r=e("../utils/wx"),s=e("../utils/ws.js"),l=e("../Global"),c=e("../utils/Ad"),u=e("../utils/Navigator"),d=function(e){function t(){var a=e.call(this)||this;return a.iconInfosList=[],a.currentIconInfoList=[],a.isGameDataLoaded=!1,console.log("HomeView constructor()"),n.default.openInstance(),t.instance=a,a}return __extends(t,e),t.openInstance=function(e){t.instance?t.instance.onOpened(e):Laya.Scene.open(o.URL_HomeView,!1,e)},t.prototype.onOpened=function(e){console.log("HomeView onOpened()"),this.visible=!0},t.prototype.onEnable=function(){console.log("HomeView onEnable()"),this.bindButtons(),this.onGameDataLoaded()},t.prototype.bindButtons=function(){var e=this;this.btn_start.on(Laya.Event.MOUSE_DOWN,this,function(){e.btn_start.alpha=.8}),this.btn_start.on(Laya.Event.MOUSE_OUT,this,function(){e.btn_start.alpha=1}),this.btn_start.on(Laya.Event.MOUSE_UP,this,function(){e.btn_start.alpha=1,n.default.instance&&(e.hide(),n.default.openInstance())}),this.btn_sound.on(Laya.Event.CLICK,this,function(){l.default.gameData.soundEnabled=!l.default.gameData.soundEnabled,e.btn_sound.gray=!l.default.gameData.soundEnabled}),this.btn_vibration.on(Laya.Event.CLICK,this,function(){l.default.gameData.vibrationEnabled=!l.default.gameData.vibrationEnabled,e.btn_vibration.gray=!l.default.gameData.vibrationEnabled})},t.prototype.hide=function(){this.visible=!1},t.prototype.initWeixin=function(){r.default.showShareMenu({withShareTicket:!0}),r.default.onShareAppMessage(function(){var e=s.default.createShareOptions({pos:"ShareAppButton"});return{title:e.title,imageUrl:e.imageUrl,query:e.query}}),s.default.init({host:"ws.lesscool.cn",version:o.VERSION,appid:1093,secret:"454b45bcf4f807978eba77ae23656f0d",share:{title:"全民欢乐，天天游戏！",image:"http://oss.lesscool.cn/fcdh/96d172496dbafa4ab9c8335a7133476c.png"}}),this.loginWs()},t.prototype.loginWs=function(){s.default.traceEvent("WS_LOGINING"),r.default.showLoading({title:"登录中",mask:!0}),s.default.onLoginComplete(this.onLoginComplete.bind(this)),s.default.login()},t.prototype.onLoginComplete=function(e,t){"success"===s.default.getLoginStatus()?(s.default.traceEvent("WS_LOGINED"),r.default.hideLoading(),console.log("ws.conf",s.default.conf),console.log("ws.user",s.default.user),console.log("ws.data",s.default.data),this.loadConfig(),this.loadGameData(t)):"fail"===s.default.getLoginStatus()&&(s.default.traceEvent("WS_LOGIN_FAIL"),r.default.hideLoading(),r.default.showModal({title:"登陆失败",content:"请允许授权",confirmText:"重新登陆",cancelText:"关闭",success:function(e){r.default.showLoading({title:"登录中",mask:!0}),s.default.login()}}))},t.prototype.loadConfig=function(){Object.assign(l.default.config,s.default.conf)},t.prototype.loadGameData=function(e){var t=this;e&&e.updateTimestamp?s.default.data&&s.default.data.updateTimestamp&&s.default.data.updateTimestamp>e.updateTimestamp?s.default.setAllData(s.default.data,!0):s.default.setAllData(e):s.default.data&&s.default.data.updateTimestamp||s.default.setAllData(l.default.gameData,!0),l.default.gameData=Object.assign(l.default.gameData,s.default.data),r.default.onHide(function(){t.updateGameData(!0)}),s.default.onShow(function(){c.refreshCurrentBanner()});var a=new u.default(s.default);this.box_homeIcon.visible=!0,a.createHomeIcons(this.box_homeIcon,this.box_homeIcon,["home_icon_1","home_icon_2","home_icon_3","home_icon_4","home_icon_5","home_icon_6","home_icon_7","home_icon_8","home_icon_9","home_icon_10"]),this.box_drawer.visible=!0,this.onGameDataLoaded()},t.prototype.onGameDataLoaded=function(){console.log("onGameDataLoaded",l.default.gameData),this.isGameDataLoaded=!0,this.label_highScore.visible=!0,this.label_level.visible=!0,this.logo_diamond.x=this.stage.width/2-(this.text_diamond.text.length*this.text_diamond.fontSize+this.text_diamond.x)/2,this.logo_diamond.visible=!0},t.prototype.updateGameData=function(e){l.default.gameData.updateTimestamp=Date.now(),e&&console.log("updateGameData",l.default.gameData),Laya.Browser.onMiniGame&&s.default.setAllData(l.default.gameData,e)},t.prototype.onIconClick=function(e,t,a){void 0===a&&(a=!0),s.default.tapGameAd({pos:e,ad:t,redirect:a})},t}(i.ui.home.HomeViewUI);a.default=d},{"../Const":3,"../Global":4,"../utils/Ad":10,"../utils/Navigator":11,"../utils/ws.js":12,"../utils/wx":13,"./../../ui/layaMaxUI":14,"./GameScene":8}],10:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("./wx"),n=e("./ws.js"),o=e("../Global"),r=!0,s=null,l=0;a.refreshCurrentBanner=function(){l++,s&&l>=o.default.config.banner_click_time&&(l=0,a.posShowBanner(s,!0))},a.hasVideoAd=function(){return r},a.posShowBanner=function(e,t){if(void 0===t&&(t=!1),Laya.Browser.onMiniGame){var a=i.default.getSystemInfoSync(),o=a.screenHeight,r=a.screenWidth,l=Math.max(300,300*r/350),c=.348*l,u=o-c,d=(r-l)/2;s=e,n.default.createBanner({pos:e,style:{left:d,top:u,width:l,height:c},force:t})}},a.posHideBanner=function(e){Laya.Browser.onMiniGame&&(s=null,n.default.closeBanner(e))},a.posShowVideo=function(e,t,a){Laya.Browser.onMiniGame&&n.default.createVideo?n.default.createVideo({pos:e,success:function(e){a&&a(e)},fail:function(e){r=!1,console.log("NO VIDEO AD")}}):(r=!1,console.log("NO VIDEO AD"),t&&t())}},{"../Global":4,"./ws.js":12,"./wx":13}],11:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=function(){function e(e){this.ws=e,this.SCALE=Laya.stage.width/720}return e.prototype.createHomeIcons=function(e,t,a){var i=this;if(Laya.Browser.onMiniGame){if(a&&a.length){var n=[],o=[],r=new Laya.Box;r.width=720*this.SCALE,r.height=1280*this.SCALE,r.centerX=0,r.centerY=0,r.mouseThrough=!0,e.addChild(r);var s=new Laya.List;s.width=720*this.SCALE,s.height=790*this.SCALE,s.x=0,s.y=240*this.SCALE,s.mouseThrough=!0,s.spaceY=45*this.SCALE,s.spaceX=468*this.SCALE,s.repeatY=5,s.repeatX=2,r.addChild(s);var l=this.SCALE,c=function(e){function t(){var t=e.call(this)||this;t.width=106*l,t.height=106*l,t.pivotX=53*l,t.pivotY=53*l,t.x=73*l,t.y=73*l,t.visible=!1;var a=new Laya.Sprite;a.name="iconImage",a.width=106*l,a.height=106*l,a.x=0,a.y=0,t.addChild(a);var i=new Laya.Sprite;i.name="tips",i.scaleX=-1,i.width=36*l,i.height=36*l,i.x=116*l,i.y=-10*l,i.loadImage("res/texture/navigator/tips2.png"),t.addChild(i);var n=new Laya.Label;return n.name="titleLabel",n.width=106*l,n.overflow="visible",n.valign="middle",n.align="center",n.fontSize=Math.round(18*l),n.font="Arial",n.color="#1d3b63",n.anchorY=0,n.anchorX=.5,n.y=110*l,n.x=53*l,t.addChild(n),t}return __extends(t,e),t}(Laya.Box);s.itemRender=c,s.renderHandler=Laya.Handler.create(this,function(e,t){var n=s.array[t];if(n){e.visible=!0,e.on(Laya.Event.MOUSE_DOWN,i,i.onIconClick,[a[t],n]);var o=e.getChildByName("iconImage");o&&o.loadImage(n.icon);var r=e.getChildByName("titleLabel");r&&r.changeText(n.title),i.shakeOnce(1e3*Math.random(),e)}else e.visible=!1},[],!1);for(var u=function(){for(var e=0;e<n.length;e++){var t=n[e],a=i.getRandom(t);o[e]=a}s.array=o,s.refresh()},d=[],h=0,f=a;h<f.length;h++){var m=f[h],g=this.ws.conf.games[m],p=g&&g.length?g.length:1;d.push({pos:m,count:p})}return this.ws.fetchGameAd({data:d,success:function(e){var s=e.data;n=[];for(var l=0,c=a;l<c.length;l++){var d=c[l];n.push(s[d])}o=[],u(),r.timerLoop(3e3,i,function(){!r.destroyed&&t&&t.visible&&u()})}}),r}console.log("posList is empty!")}else console.log("Laya.Browser.onMiniGame is false!")},e.prototype.createDrawer=function(e,t){var a=this;{if(Laya.Browser.onMiniGame){var i=new Laya.Box;i.width=720*this.SCALE,i.height=1280*this.SCALE,i.centerX=0,i.centerY=0,i.mouseThrough=!0,e.addChild(i);var n=new Laya.Image;n.width=720*this.SCALE,n.height=1600*this.SCALE,n.centerX=0,n.centerY=0,n.mouseThrough=!1,n.mouseEnabled=!0,n.visible=!1,n.skin="res/texture/navigator/blank.png",n.sizeGrid="1,1,1,1",i.addChild(n);var o=new Laya.Box;o.width=720*this.SCALE,o.height=1280*this.SCALE,o.centerX=-480*this.SCALE,o.centerY=0,o.mouseThrough=!0,i.addChild(o);var r=new Laya.Sprite;r.width=480*this.SCALE,r.height=665*this.SCALE,r.x=0,r.y=120*this.SCALE,r.loadImage("res/texture/navigator/drawer_panel.png"),o.addChild(r);var s=new Laya.List;s.width=380*this.SCALE,s.height=540*this.SCALE,s.x=40*this.SCALE,s.y=85*this.SCALE,s.mouseThrough=!0,s.spaceY=40*this.SCALE,s.spaceX=30*this.SCALE,s.repeatX=3,r.addChild(s);var l=this.SCALE,c=function(e){function t(){var t=e.call(this)||this;t.width=106*l,t.height=106*l,t.x=0,t.y=0,t.visible=!1;var a=new Laya.Sprite;a.name="iconImage",a.width=106*l,a.height=106*l,a.x=0,a.y=0,t.addChild(a);var i=new Laya.Sprite;i.name="tips",i.width=59*l,i.height=32*l,i.x=60*l,i.y=-10*l,i.loadImage("res/texture/navigator/tips.png"),t.addChild(i);var n=new Laya.Label;n.name="tipsLabel",n.width=42*l,n.height=18*l,n.valign="middle",n.align="center",n.fontSize=Math.round(18*l),n.font="Arial",n.color="#ffffff",n.x=9*l,n.y=6*l,i.addChild(n);var o=new Laya.Label;return o.name="titleLabel",o.width=106*l,o.overflow="visible",o.valign="middle",o.align="center",o.fontSize=Math.round(18*l),o.font="Arial",o.color="#1d3b63",o.anchorY=0,o.anchorX=.5,o.x=53*l,o.y=110*l,t.addChild(o),t}return __extends(t,e),t}(Laya.Box);s.itemRender=c,s.renderHandler=Laya.Handler.create(this,function(e,i){var n=s.array[i];if(n){e.visible=!0,e.on(Laya.Event.MOUSE_DOWN,a,a.onIconClick,[t,n]);var o=e.getChildByName("iconImage");o&&o.loadImage(n.icon);var r=e.getChildByName("titleLabel");r&&r.changeText(n.title);var l=e.getChildByName("tips");if(l){var c=l.getChildByName("tipsLabel");c&&c.changeText(Math.random()>.5?"热门":"NEW")}}else e.visible=!1},[],!1);var u=new Laya.Sprite;u.width=88*this.SCALE,u.height=74*this.SCALE,u.x=480*this.SCALE,u.y=40*this.SCALE,u.loadImage("res/texture/navigator/drawer_button.png"),u.visible=!1,r.addChild(u);var d=new Laya.Sprite;d.width=39*this.SCALE,d.height=49*this.SCALE,d.scaleX=-1,d.x=55*this.SCALE,d.y=12*this.SCALE,d.loadImage("res/texture/navigator/arrow.png"),u.addChild(d);var h=new Laya.Sprite;h.width=88*this.SCALE,h.height=74*this.SCALE,h.x=480*this.SCALE,h.y=40*this.SCALE,h.loadImage("res/texture/navigator/drawer_button.png"),h.visible=!0,r.addChild(h);var f=new Laya.Sprite;f.width=39*this.SCALE,f.height=49*this.SCALE,f.x=23*this.SCALE,f.y=12*this.SCALE,f.loadImage("res/texture/navigator/arrow.png"),h.addChild(f),h.on(Laya.Event.MOUSE_DOWN,this,function(){a.ws.getGameAd({pos:t,count:a.ws.conf.games[t].length,success:function(e){var t=e.data;s.array=t,s.refresh()}}),n.visible=!0,Laya.Tween.to(o,{centerX:0},300,Laya.Ease.linearNone,Laya.Handler.create(a,function(){h.visible=!1,u.visible=!0}))}),u.on(Laya.Event.MOUSE_DOWN,this,function(){a.ws.hideGameAd(t),Laya.Tween.to(o,{centerX:-480*l},300,Laya.Ease.linearNone,Laya.Handler.create(a,function(){h.visible=!0,u.visible=!1,n.visible=!1}))});var m=Math.round(13*this.SCALE),g=Math.round(28*this.SCALE),p=!1;return i.timerLoop(500,this,function(){p?(f.x=g,p=!1):(f.x=m,p=!0)}),i}console.log("Laya.Browser.onMiniGame is false!")}},e.prototype.createMoreGame=function(e,t,a){var i=this;{if(Laya.Browser.onMiniGame){var n=new Laya.Box;n.width=720*this.SCALE,n.height=1280*this.SCALE,n.centerX=0,n.centerY=0,n.mouseThrough=!0,n.visible=!1,e.addChild(n);var o=new Laya.Image;o.width=720*this.SCALE,o.height=1600*this.SCALE,o.centerX=0,o.centerY=0,o.mouseThrough=!1,o.mouseEnabled=!0,o.skin="res/texture/navigator/blank.png",o.sizeGrid="1,1,1,1",n.addChild(o);var r=new Laya.Box;r.width=720*this.SCALE,r.height=1280*this.SCALE,r.centerX=0,r.centerY=0,r.mouseThrough=!0,n.addChild(r);var s=new Laya.Sprite;s.width=586*this.SCALE,s.height=806*this.SCALE,s.loadImage("res/texture/navigator/moregame_panel.png"),s.x=67*this.SCALE,s.y=137*this.SCALE,r.addChild(s);var l=new Laya.Sprite;l.x=538*this.SCALE,l.y=-12*this.SCALE,l.width=59*this.SCALE,l.height=62*this.SCALE,l.loadImage("res/texture/navigator/close_button.png"),s.addChild(l);var c=new Laya.Image;c.width=110*this.SCALE,c.height=110*this.SCALE,c.pivotY=55*this.SCALE,c.pivotX=55*this.SCALE,c.centerX=285*this.SCALE,c.centerY=-465*this.SCALE,c.loadImage("res/texture/navigator/more_game_button.png",Laya.Handler.create(this,function(){n.timerLoop(1005,i,function(){Laya.Tween.to(c,{scaleX:.9*d,scaleY:.9*d},500,Laya.Ease.linearNone,Laya.Handler.create(i,function(){Laya.Tween.to(c,{scaleX:d,scaleY:d},500,Laya.Ease.linearNone)}))})})),t.addChild(c);var u=new Laya.List;u.width=500*this.SCALE,u.height=640*this.SCALE,u.centerX=10*this.SCALE,u.centerY=5*this.SCALE,u.spaceY=50*this.SCALE,u.spaceX=40*this.SCALE,u.repeatX=3,s.addChild(u);var d=this.SCALE,h=function(e){function t(){var t=e.call(this)||this;t.width=132*d,t.height=132*d,t.x=0,t.y=0,t.visible=!1;var a=new Laya.Sprite;a.name="iconImage",a.width=132*d,a.height=132*d,a.x=0,a.y=-2*d,t.addChild(a);var i=new Laya.Sprite;i.name="tips",i.width=59*d,i.height=32*d,i.x=90*d,i.y=-10*d,i.loadImage("res/texture/navigator/tips.png"),t.addChild(i);var n=new Laya.Label;n.name="tipsLabel",n.width=42*d,n.height=18*d,n.valign="middle",n.align="center",n.fontSize=Math.round(18*d),n.font="Arial",n.color="#ffffff",n.x=9*d,n.y=6*d,i.addChild(n);var o=new Laya.Label;return o.name="titleLabel",o.width=132*d,o.overflow="visible",o.valign="middle",o.align="center",o.fontSize=Math.round(22*d),o.font="Arial",o.color="#1d3b63",o.anchorY=0,o.anchorX=.5,o.x=66*d,o.y=138*d,t.addChild(o),t}return __extends(t,e),t}(Laya.Box);return u.itemRender=h,u.renderHandler=Laya.Handler.create(this,function(e,t){var n=u.array[t];if(n){e.visible=!0,e.on(Laya.Event.MOUSE_DOWN,i,i.onIconClick,[a,n]);var o=e.getChildByName("iconImage");o&&o.loadImage(n.icon);var r=e.getChildByName("titleLabel");r&&r.changeText(n.title);var s=e.getChildByName("tips");if(s){var l=s.getChildByName("tipsLabel");l&&l.changeText(Math.random()>.5?"热门":"NEW")}}else e.visible=!1},[],!1),c.on(Laya.Event.MOUSE_DOWN,this,function(){i.ws.getGameAd({pos:a,count:i.ws.conf.games[a].length,success:function(e){var t=e.data;u.array=t,u.refresh()}}),n.visible=!0,c.visible=!1}),l.on(Laya.Event.MOUSE_DOWN,this,function(){i.ws.hideGameAd(a),c.visible=!0,n.visible=!1}),n}console.log("Laya.Browser.onMiniGame is false!")}},e.prototype.createOverIcons=function(e,t,a){var i=this;if(Laya.Browser.onMiniGame){if(a&&a.length){var n=[],o=[],r=new Laya.Box;r.width=720*this.SCALE,r.height=1280*this.SCALE,r.centerX=0,r.centerY=0,r.mouseThrough=!0,e.addChild(r);var s=new Laya.List;s.width=720*this.SCALE,s.height=470*this.SCALE,s.x=0,s.y=180*this.SCALE,s.mouseThrough=!0,s.spaceY=45*this.SCALE,s.spaceX=468*this.SCALE,s.repeatY=3,s.repeatX=2,r.addChild(s);var l=this.SCALE,c=function(e){function t(){var t=e.call(this)||this;t.width=106*l,t.height=106*l,t.pivotX=53*l,t.pivotY=53*l,t.x=73*l,t.y=73*l,t.visible=!1;var a=new Laya.Sprite;a.name="iconImage",a.width=106*l,a.height=106*l,a.x=0,a.y=0,t.addChild(a);var i=new Laya.Sprite;i.name="tips",i.scaleX=-1,i.width=36*l,i.height=36*l,i.x=116*l,i.y=-10*l,i.loadImage("res/texture/navigator/tips2.png"),t.addChild(i);var n=new Laya.Label;return n.name="titleLabel",n.width=106*l,n.overflow="visible",n.valign="middle",n.align="center",n.fontSize=Math.round(18*l),n.font="Arial",n.color="#1d3b63",n.anchorY=0,n.anchorX=.5,n.y=110*l,n.x=53*l,t.addChild(n),t}return __extends(t,e),t}(Laya.Box);s.itemRender=c,s.renderHandler=Laya.Handler.create(this,function(e,t){var n=s.array[t];if(n){e.visible=!0,e.on(Laya.Event.MOUSE_DOWN,i,i.onIconClick,[a[t],n]);var o=e.getChildByName("iconImage");o&&o.loadImage(n.icon);var r=e.getChildByName("titleLabel");r&&r.changeText(n.title),i.shakeOnce(1e3*Math.random(),e)}else e.visible=!1},[],!1);for(var u=function(){for(var e=0;e<n.length;e++){var t=n[e],a=i.getRandom(t);o[e]=a}s.array=o,s.refresh()},d=[],h=0,f=a;h<f.length;h++){var m=f[h],g=this.ws.conf.games[m],p=g&&g.length?g.length:1;d.push({pos:m,count:p})}return this.ws.fetchGameAd({data:d,success:function(e){var s=e.data;n=[];for(var l=0,c=a;l<c.length;l++){var d=c[l];n.push(s[d])}o=[],u(),r.timerLoop(3e3,i,function(){!r.destroyed&&t&&t.visible&&u()})}}),r}console.log("posList is empty!")}else console.log("Laya.Browser.onMiniGame is false!")},e.prototype.createGuessLikeIcons=function(e,t,a){var i=this;if(Laya.Browser.onMiniGame){if(a&&a.length){var n=[],o=[],r=new Laya.Box;r.width=720*this.SCALE,r.height=1280*this.SCALE,r.centerX=0,r.centerY=0,r.mouseThrough=!0,e.addChild(r);var s=new Laya.Sprite;s.width=560*this.SCALE,s.height=188*this.SCALE,s.y=670*this.SCALE,s.x=80*this.SCALE,s.loadImage("res/texture/navigator/guessyoulike.png"),r.addChild(s);var l=new Laya.List;l.width=500*this.SCALE,l.height=208*this.SCALE,l.x=60*this.SCALE,l.y=-20*this.SCALE,l.mouseThrough=!0,l.spaceY=45*this.SCALE,l.spaceX=18*this.SCALE,l.repeatY=1,l.repeatX=4,s.addChild(l);var c=this.SCALE,u=function(e){function t(){var t=e.call(this)||this;t.width=106*c,t.height=106*c,t.pivotX=53*c,t.pivotY=53*c,t.x=63*c,t.y=108*c,t.visible=!1;var a=new Laya.Sprite;a.name="iconImage",a.width=106*c,a.height=106*c,a.x=0,a.y=0,t.addChild(a);var i=new Laya.Label;return i.name="titleLabel",i.width=106*c,i.overflow="visible",i.valign="middle",i.align="center",i.fontSize=Math.round(18*c),i.font="Arial",i.color="#1d3b63",i.anchorY=0,i.anchorX=.5,i.y=110*c,i.x=53*c,t.addChild(i),t}return __extends(t,e),t}(Laya.Box);l.itemRender=u,l.renderHandler=Laya.Handler.create(this,function(e,t){var n=l.array[t];if(n){e.visible=!0,e.on(Laya.Event.MOUSE_DOWN,i,i.onIconClick,[a[t],n]);var o=e.getChildByName("iconImage");o&&o.loadImage(n.icon);var r=e.getChildByName("titleLabel");r&&r.changeText(n.title),i.jumpeOnce(150*t,e)}else e.visible=!1},[],!1);for(var d=function(){for(var e=0;e<n.length;e++){var t=n[e],a=i.getRandom(t);o[e]=a}l.array=o,l.refresh()},h=[],f=0,m=a;f<m.length;f++){var g=m[f],p=this.ws.conf.games[g],y=p&&p.length?p.length:1;h.push({pos:g,count:y})}return this.ws.fetchGameAd({data:h,success:function(e){var s=e.data;n=[];for(var l=0,c=a;l<c.length;l++){var u=c[l];n.push(s[u])}o=[],d(),r.timerLoop(3e3,i,function(){!r.destroyed&&t&&t.visible&&d()})}}),r}console.log("posList is empty!")}else console.log("Laya.Browser.onMiniGame is false!")},e.prototype.onIconClick=function(e,t,a){void 0===a&&(a=!0),this.ws.tapGameAd({pos:e,ad:t,redirect:a})},e.prototype.shakeOnce=function(e,t){var a=this;Laya.timer.once(e,this,function(){Laya.Tween.to(t,{rotation:-10},100,Laya.Ease.linearNone,Laya.Handler.create(a,function(){Laya.Tween.to(t,{rotation:10},200,Laya.Ease.linearNone,Laya.Handler.create(a,function(){Laya.Tween.to(t,{rotation:-5},150,Laya.Ease.linearNone,Laya.Handler.create(a,function(){Laya.Tween.to(t,{rotation:5},100,Laya.Ease.linearNone,Laya.Handler.create(a,function(){Laya.Tween.to(t,{rotation:0},50,Laya.Ease.linearNone,Laya.Handler.create(a,function(){Laya.timer.clearAll(t)}))}))}))}))}))}),this.blinkTips(e,t)},e.prototype.jumpeOnce=function(e,t){var a=this,i=t.y;Laya.timer.once(e,this,function(){Laya.Tween.to(t,{rotation:-10},100,Laya.Ease.linearNone,Laya.Handler.create(a,function(){Laya.Tween.to(t,{rotation:10},200,Laya.Ease.linearNone,Laya.Handler.create(a,function(){Laya.Tween.to(t,{rotation:-5},150,Laya.Ease.linearNone,Laya.Handler.create(a,function(){Laya.Tween.to(t,{rotation:5},100,Laya.Ease.linearNone,Laya.Handler.create(a,function(){Laya.Tween.to(t,{rotation:0},50,Laya.Ease.linearNone,Laya.Handler.create(a,function(){Laya.timer.clearAll(t)}))}))}))}))})),Laya.Tween.to(t,{y:i-50},200,Laya.Ease.sineOut,Laya.Handler.create(a,function(){Laya.Tween.to(t,{y:i},200,Laya.Ease.sineIn)}))}),this.blinkTips(e,t)},e.prototype.blinkTips=function(e,t){var a=this,i=t.getChildByName("tips");i&&Laya.timer.once(e,this,function(){Laya.Tween.to(i,{alpha:0},500,Laya.Ease.sineIn,Laya.Handler.create(a,function(){Laya.Tween.to(i,{alpha:1},500,Laya.Ease.sineOut,Laya.Handler.create(a,function(){Laya.Tween.to(i,{alpha:0},500,Laya.Ease.sineIn,Laya.Handler.create(a,function(){Laya.Tween.to(i,{alpha:1},500,Laya.Ease.sineOut,Laya.Handler.create(a,function(){Laya.Tween.to(i,{alpha:0},500,Laya.Ease.sineIn,Laya.Handler.create(a,function(){Laya.Tween.to(i,{alpha:1},500,Laya.Ease.sineOut,Laya.Handler.create(a,function(){Laya.timer.clearAll(i)}))}))}))}))}))}))})},e.prototype.randomIndex=function(e,t,a){void 0===t&&(t="weight"),void 0===a&&(a=0);var i=[],n=0;if(e&&e.length)for(l=0;l<e.length;l++){var o=e[l],r=Number(o[t])||a||0;i[l]=[n,n+r],n+=r}if(n>0)for(var s=Math.random()*n,l=0;l<i.length;l++){var c=i[l];if(c[0]<=s&&s<c[1])return l}return 0},e.prototype.getRandom=function(e,t,a){return void 0===t&&(t="weight"),void 0===a&&(a=0),e&&e.length?e[this.randomIndex(e,t,a)]:null},e}();a.default=i},{}],12:[function(e,t,a){t.exports.default=function(e){function t(i){if(a[i])return a[i].exports;var n=a[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){"use strict";var i,n=(i=a(1))&&i.__esModule?i:{default:i},o=a(4),r=a(5),s=a(6),l=a(7),c=a(8),u=a(9),d=a(10),h=a(11),f=a(12),m=a(13),g=a(2),p=a(14);(0,g.initUtil)(n.default),(0,o.initHTTP)(n.default),(0,r.initUser)(n.default),(0,s.initConfig)(n.default),(0,l.initData)(n.default),(0,c.initShare)(n.default),(0,u.initProcess)(n.default),(0,d.initPayment)(n.default),(0,h.initAD)(n.default),(0,f.initHook)(n.default),(0,m.initInvite)(n.default),(0,p.initEvent)(n.default),e.exports=window.ws=n.default},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},o=(i=a(2))&&i.__esModule?i:{default:i},r={tmp:{},options:{scheme:"https://",host:"api.websdk.cn",apiVersion:"v1",USER_KEY:"ws_user",CONF_KEY:"ws_conf",DATA_KEY:"ws_data",share10:!0,commonDuration:120,allowAld:!1},conf:{},user:{},data:{},version:"1.0.1",mode:"default",debug:!0,shareCallbackData:{},shareTempData:{},shareGiftTempData:{},_initCallbacks:[],_showCallbacks:[],_hideCallbacks:[],_afterHideCallbacks:[],_shareCallbacks:[],_openFromShareCallbacks:[],_openFromCodeCallbacks:[],_onInit:function(){var e=!0,t=!1,a=void 0;try{for(var i,n=this._initCallbacks[Symbol.iterator]();!(e=(i=n.next()).done);e=!0){var o=i.value;o&&o()}}catch(e){t=!0,a=e}finally{try{!e&&n.return&&n.return()}finally{if(t)throw a}}},_onShow:function(e){if(console.log("onShow:",e,"mode:",this.mode),"default"!==this.mode)this.shareCallbackData&&this.shareCallbackData.callback&&"shareAppMessage"==this.mode&&(this.shareCallbackData.callback(e,Date.now()-this.shareCallbackData.ms),this.shareCallbackData={}),this.mode="default";else{var t=!0,a=!1,i=void 0;try{for(var n,o=this._showCallbacks[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var s=n.value;s&&s(e)}}catch(e){a=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(a)throw i}}if(e.query&&"share"===e.query.type?r._openFromShare("onShow",e.query,e):e.query&&e.query.scene&&"code_"===e.query.scene.substring(0,5)&&r._openFromCode("onShow",e.query.scene,e),this.user&&e.shareTicket&&e.query&&e.query.uid==this.user.id)for(var l in this.shareTempData)l==e.query.share_tid&&r._shareCallback(this.shareTempData[l],e)}},_onHide:function(e){if(console.log("onHide:",e,"mode:",this.mode),"default"===this.mode){var t=!0,a=!1,i=void 0;try{for(var n,o=this._hideCallbacks[Symbol.iterator]();!(t=(n=o.next()).done);t=!0){var r=n.value;r&&r(e)}}catch(e){a=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(a)throw i}}var s=!0,l=!1,c=void 0;try{for(var u,d=this._afterHideCallbacks[Symbol.iterator]();!(s=(u=d.next()).done);s=!0){var h=u.value;h&&h(e)}}catch(e){l=!0,c=e}finally{try{!s&&d.return&&d.return()}finally{if(l)throw c}}}},_openFromShare:function(e,t,a){var i=!0,n=!1,o=void 0;try{for(var r,s=this._openFromShareCallbacks[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var l=r.value;l&&l({from:e,query:t,options:a})}}catch(e){n=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(n)throw o}}},_openFromCode:function(e,t,a){r.get({url:"/share/qrcode",data:{scene:t},success:function(i){var n=!0,o=!1,s=void 0;try{for(var l,c=r._openFromCodeCallbacks[Symbol.iterator]();!(n=(l=c.next()).done);n=!0){var u=l.value;u&&u({from:e,scene:t,options:a,query:i.data})}}catch(e){o=!0,s=e}finally{try{!n&&c.return&&c.return()}finally{if(o)throw s}}}})},_shareCallback:function(e,t){wx.getShareInfo({shareTicket:t.shareTicket,success:function(a){e.onShareTicketSuccess&&e.onShareTicketSuccess(a),r.shareLog(e,"click",t.shareTicket,a,t)}.bind(this),fail:function(a){e.onShareTicketFail&&e.onShareTicketFail(a),r.shareLog(e,"click",t.shareTicket,{},t)}.bind(this)})},onInit:function(e){this._initCallbacks.push(e)},onShow:function(e){this._showCallbacks.push(e)},onHide:function(e){this._hideCallbacks.push(e)},afterHide:function(e){this._afterHideCallbacks.push(e)},openFromShare:function(e){this._openFromShareCallbacks.push(e)},openFromCode:function(e){this._openFromCodeCallbacks.push(e)},init:function(e){this.options=n({},o.default.copy(e,this.options)),this.systemInfo=wx.getSystemInfoSync(),this.launchOptions=wx.getLaunchOptionsSync(),this.user=wx.getStorageSync(this.options.USER_KEY),this.conf=wx.getStorageSync(this.options.CONF_KEY),this.data=wx.getStorageSync(this.options.DATA_KEY),this.log("conf:",this.conf),wx.onShow(this._onShow.bind(this)),wx.onHide(this._onHide.bind(this))},onLogined:function(){var e=this.launchOptions;e.query&&"share"===e.query.type?r._openFromShare("onLaunch",e.query,e):e.query&&e.query.scene&&"code_"===e.query.scene.substring(0,5)&&r._openFromCode("onLaunch",e.query.scene,e),this._onInit()}};t.default=r},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.initUtil=function(e){e.checkSDK=function(e,t){var a=this;return function(i,n){return a.requireSDK(e)?t.apply(a,[i]):(a.log("微信SDK版本过低："+a.systemInfo.SDKVersion+",需要更新至"+e),void(n&&"function"==typeof n&&n([a.systemInfo.SDKVersion,e])))}},e.requireSDK=function(e){return r.compareVersion(this.systemInfo.SDKVersion,e)},e.requireSystemVersion=function(e){return r.compareVersion(this.systemInfo.version,e)},e.isIPhoneX=function(){return this.systemInfo&&-1!=this.systemInfo.model.indexOf("iPhone X")},e.isIOS=function(){return this.systemInfo&&-1!=this.systemInfo.model.indexOf("iOS")},e.isAndroid=function(){return this.systemInfo&&-1!=this.systemInfo.model.indexOf("Android")},e.toFixed=function(e,t){for(var a=e.toFixed(t)+"";"0"===a[a.length-1];)if("."===(a=a.substring(0,a.length-1))[a.length-1]){a=a.substring(0,a.length-1);break}return a},e.log=function(){try{if(this.debug&&console&&console.log){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return console.log.apply(console,t)}}catch(e){}},e.setAlertCallback=function(t){e._alertCallback=t},e.alert=function(t){e._alertCallback?e._alertCallback(t):wx.showModal({content:t})},e.trace=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.post({url:"/log/trace",data:{key:e,pos:t,data:a}})},e.getServerTime=function(){return e.conf&&e.conf.server_time?e.conf.server_time:0}};var n,o=(n=a(3))&&n.__esModule?n:{default:n},r={sign:function(e,t){if("string"==typeof e)return r.signSort(e,t);if("object"==(void 0===e?"undefined":i(e))){var a=[];for(var n in e)a.push(n+"="+e[n]);return r.signSort(a.join("&"),t)}},signSort:function(e,t){var a=e.split("&").sort().join("&")+"&key="+t;return(0,o.default)(a).toUpperCase()},S4:function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},guid:function(){return Date.now()+"-"+r.S4()},compareVersion:function(e,t){var a=parseFloat(e),i=parseFloat(t),n=e.replace(a+".",""),o=t.replace(i+".","");return a>i||!(a<i)&&n>=o},copy:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||(e&&e.push?[]:{});for(var a in e)t[a]="object"===i(e[a])?r.copy(e[a]):e[a];return t},randomSort:function(e){for(var t,a=0;a<e.length;a++){var i=parseInt(Math.random()*e.length+"");t=e[i],e[i]=e[a],e[a]=t}return e}};t.default=r},function(e,t,a){var i;"function"==typeof Symbol&&Symbol.iterator,function(n){"use strict";function o(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}function r(e,t,a,i,n,r){return o((s=o(o(t,e),o(i,r)))<<(l=n)|s>>>32-l,a);var s,l}function s(e,t,a,i,n,o,s){return r(t&a|~t&i,e,t,n,o,s)}function l(e,t,a,i,n,o,s){return r(t&i|a&~i,e,t,n,o,s)}function c(e,t,a,i,n,o,s){return r(t^a^i,e,t,n,o,s)}function u(e,t,a,i,n,o,s){return r(a^(t|~i),e,t,n,o,s)}function d(e,t){var a,i,n,r,d;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var h=1732584193,f=-271733879,m=-1732584194,g=271733878;for(a=0;a<e.length;a+=16)i=h,n=f,r=m,d=g,h=s(h,f,m,g,e[a],7,-680876936),g=s(g,h,f,m,e[a+1],12,-389564586),m=s(m,g,h,f,e[a+2],17,606105819),f=s(f,m,g,h,e[a+3],22,-1044525330),h=s(h,f,m,g,e[a+4],7,-176418897),g=s(g,h,f,m,e[a+5],12,1200080426),m=s(m,g,h,f,e[a+6],17,-1473231341),f=s(f,m,g,h,e[a+7],22,-45705983),h=s(h,f,m,g,e[a+8],7,1770035416),g=s(g,h,f,m,e[a+9],12,-1958414417),m=s(m,g,h,f,e[a+10],17,-42063),f=s(f,m,g,h,e[a+11],22,-1990404162),h=s(h,f,m,g,e[a+12],7,1804603682),g=s(g,h,f,m,e[a+13],12,-40341101),m=s(m,g,h,f,e[a+14],17,-1502002290),h=l(h,f=s(f,m,g,h,e[a+15],22,1236535329),m,g,e[a+1],5,-165796510),g=l(g,h,f,m,e[a+6],9,-1069501632),m=l(m,g,h,f,e[a+11],14,643717713),f=l(f,m,g,h,e[a],20,-373897302),h=l(h,f,m,g,e[a+5],5,-701558691),g=l(g,h,f,m,e[a+10],9,38016083),m=l(m,g,h,f,e[a+15],14,-660478335),f=l(f,m,g,h,e[a+4],20,-405537848),h=l(h,f,m,g,e[a+9],5,568446438),g=l(g,h,f,m,e[a+14],9,-1019803690),m=l(m,g,h,f,e[a+3],14,-187363961),f=l(f,m,g,h,e[a+8],20,1163531501),h=l(h,f,m,g,e[a+13],5,-1444681467),g=l(g,h,f,m,e[a+2],9,-51403784),m=l(m,g,h,f,e[a+7],14,1735328473),h=c(h,f=l(f,m,g,h,e[a+12],20,-1926607734),m,g,e[a+5],4,-378558),g=c(g,h,f,m,e[a+8],11,-2022574463),m=c(m,g,h,f,e[a+11],16,1839030562),f=c(f,m,g,h,e[a+14],23,-35309556),h=c(h,f,m,g,e[a+1],4,-1530992060),g=c(g,h,f,m,e[a+4],11,1272893353),m=c(m,g,h,f,e[a+7],16,-155497632),f=c(f,m,g,h,e[a+10],23,-1094730640),h=c(h,f,m,g,e[a+13],4,681279174),g=c(g,h,f,m,e[a],11,-358537222),m=c(m,g,h,f,e[a+3],16,-722521979),f=c(f,m,g,h,e[a+6],23,76029189),h=c(h,f,m,g,e[a+9],4,-640364487),g=c(g,h,f,m,e[a+12],11,-421815835),m=c(m,g,h,f,e[a+15],16,530742520),h=u(h,f=c(f,m,g,h,e[a+2],23,-995338651),m,g,e[a],6,-198630844),g=u(g,h,f,m,e[a+7],10,1126891415),m=u(m,g,h,f,e[a+14],15,-1416354905),f=u(f,m,g,h,e[a+5],21,-57434055),h=u(h,f,m,g,e[a+12],6,1700485571),g=u(g,h,f,m,e[a+3],10,-1894986606),m=u(m,g,h,f,e[a+10],15,-1051523),f=u(f,m,g,h,e[a+1],21,-2054922799),h=u(h,f,m,g,e[a+8],6,1873313359),g=u(g,h,f,m,e[a+15],10,-30611744),m=u(m,g,h,f,e[a+6],15,-1560198380),f=u(f,m,g,h,e[a+13],21,1309151649),h=u(h,f,m,g,e[a+4],6,-145523070),g=u(g,h,f,m,e[a+11],10,-1120210379),m=u(m,g,h,f,e[a+2],15,718787259),f=u(f,m,g,h,e[a+9],21,-343485551),h=o(h,i),f=o(f,n),m=o(m,r),g=o(g,d);return[h,f,m,g]}function h(e){var t,a="",i=32*e.length;for(t=0;t<i;t+=8)a+=String.fromCharCode(e[t>>5]>>>t%32&255);return a}function f(e){var t,a=[];for(a[(e.length>>2)-1]=void 0,t=0;t<a.length;t+=1)a[t]=0;var i=8*e.length;for(t=0;t<i;t+=8)a[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return a}function m(e){var t,a,i="";for(a=0;a<e.length;a+=1)t=e.charCodeAt(a),i+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return i}function g(e){return unescape(encodeURIComponent(e))}function p(e){return function(e){return h(d(f(e),8*e.length))}(g(e))}function y(e,t){return function(e,t){var a,i,n=f(e),o=[],r=[];for(o[15]=r[15]=void 0,n.length>16&&(n=d(n,8*e.length)),a=0;a<16;a+=1)o[a]=909522486^n[a],r[a]=1549556828^n[a];return i=d(o.concat(f(t)),512+8*t.length),h(d(r.concat(i),640))}(g(e),g(t))}function v(e,t,a){return t?a?y(t,e):m(y(t,e)):a?p(e):m(p(e))}void 0===(i=function(){return v}.call(t,a,t,e))||(e.exports=i)}()},function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=e.success,a=e.fail;return"GET"==e.method?e.url=c(e.url,e.data):e.url=c(e.url),e.header||(e.header={}),e.header.Authorization=u.default.isLogined()?u.default.user.token:"",e.success=function(i){"LOGIN_REQUIRED"===i.data.key?(u.default.log("login required:",e.url,e,i),u.default.doLogin()):0===i.data.code?(u.default.log("success:",e.url,e,i),t&&t(i.data)):a?(u.default.log("fail:",e.url,e,i),a(i.data)):u.default.log("unknown:",e.url,e,i)},e.fail=function(t){u.default.log("error:",e.url,e,t),a&&a(t)},wx.request(e)}function o(e){return e.method="GET",n(e)}function r(e){return e.method="POST",n(e)}function s(e){return e.method="PUT",n(e)}function l(e){return e.method="DELETE",n(e)}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e){-1==e.indexOf("?")&&(e+="?");var a=[];if(u.default.isLogined()&&a.push("user="+u.default.user.id),u.default.launchOptions){var i=u.default.launchOptions.query;i&&(i.uid&&a.push("uid="+i.uid),i.channel&&a.push("channel="+i.channel),i.share_id&&a.push("share_id="+i.share_id),i.share_tid&&a.push("share_tid="+i.share_tid),i.pos&&a.push("share_pos="+i.pos),i.scene&&a.push("scene="+decodeURIComponent(i.scene)))}a.push("v="+u.default.version),a.push("version="+u.default.options.version),a.push("appid="+u.default.options.appid),a.push("t="+Date.now()),"?"!==e.charAt(e.length-1)&&"&"!==e.charAt(e.length-1)&&(e+="&");var n=(e+=a.join("&")).split("?")[1];if(t){var o=[];for(var r in t)o.push(r+"="+t[r]);n+="&"+o.join("&")}if((e+="&sign="+d.default.sign(n,u.default.options.secret)).startsWith("/"))return u.default.options.scheme+u.default.options.host+"/"+u.default.options.apiVersion+e}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.initHTTP=function(e){e.request=n,e.get=o,e.post=r,e.put=s,e.delete=l,e.formatURL=c};var u=i(a(1)),d=i(a(2))},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initUser=function(e){e.isLogined=function(){return e.user&&e.user.token},e.getLoginStatus=function(){return e.isLogined()?"success":e.isCheckSession||e.isLogining?"logining":"fail"},e.login=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t?e.doLogin(t):(e.isCheckSession=!0,wx.checkSession({success:function(){e.checkLogin(t),e.isCheckSession=!1}.bind(e),fail:function(){e.doLogin(t),e.isCheckSession=!1}.bind(e)}))},e.checkLogin=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e.isLogined()?(e.loginSuccess(),!e.requireSDK("2.0.3")&&e.needUserInfo()&&e.getUserInfo()):e.doLogin(t)},e.checkCode2access=function(t){var a=t.session_key?t:null;e.post({url:"/oauth/code2access_token",data:t,success:function(t){e.isLogining=!1,e.saveUser(t.data),e.checkLogin(a)}.bind(e),fail:e.loginFail.bind(e)})},e.doLogin=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e.isLogining||(e.isLogining=!0,e.user=null,t?e.checkCode2access(t):wx.login({success:function(t){t.code?e.checkCode2access({code:t.code}):e.loginFail(t)}.bind(e),fail:e.loginFail.bind(e)}))},e.loginSuccess=function(t){var a=e.conf&&e.conf.last?e.conf.last:0;!a||Date.now()-a>1e3*e.options.commonDuration?e.getCommon(t):(e.doLoginSuccess(t),e.onLogined())},e.getCommon=function(t){e.get({url:"/common",success:function(a){e.conf=a.data.conf,e.conf.last=Date.now(),wx.setStorage({key:e.options.CONF_KEY,data:e.conf}),e.data||(e.data=a.data.data,wx.setStorage({key:e.options.DATA_KEY,data:e.data})),e.doLoginSuccess(t),e.onLogined()}.bind(e),fail:function(t){e.loginFail(t)}.bind(e)})},e.doLoginSuccess=function(t){e.isLogining=!1,e.loginCompleteCallback&&e.loginCompleteCallback(t),e.loginSuccessCallback&&e.loginSuccessCallback(t)},e.loginFail=function(t){e.isLogining=!1,e.loginCompleteCallback&&e.loginCompleteCallback(t),e.loginFailCallback&&e.loginFailCallback(t)},e.onLoginSuccess=function(t){e.loginSuccessCallback=t},e.onLoginFail=function(t){e.loginFailCallback=t},e.onLoginComplete=function(t){e.loginCompleteCallback=t},e.checkUserInfo=function(){e.needUserInfo()&&e.getUserInfo()},e.needUserInfo=function(){return!e.user||!e.user.nickname||!e.user.avatar},e.getUserInfo=function(){wx.getUserInfo({withCredentials:!0,success:function(t){return e.post({url:"/oauth/update_userinfo",data:t,success:function(t){e.saveUser(t.data),e.needUserInfo()?e.getUserInfoFail(t):e.getUserInfoSuccess()}.bind(e),fail:e.getUserInfoFail.bind(e)}),t}.bind(e),fail:e.getUserInfoFail.bind(e)})},e.getUserInfoSuccess=function(e){},e.getUserInfoFail=function(e){},e.saveUser=function(t){e.user=t,e.user.last=Date.parse(new Date),wx.setStorage({key:e.options.USER_KEY,data:e.user})}}},function(e,t,a){"use strict";function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return o.default.conf&&void 0!==o.default.conf[e]?o.default.conf[e]:t}Object.defineProperty(t,"__esModule",{value:!0}),t.initConfig=function(e){e.getConfig=i};var n,o=(n=a(1))&&n.__esModule?n:{default:n}},function(e,t,a){"use strict";function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return d.default.data&&void 0!==d.default.data[e]?d.default.data[e]:t}function n(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];d.default.data||(d.default.data={}),d.default.data[e]=t,a&&d.default.postData(e)}function o(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];d.default.data=e,t&&d.default.postData()}function r(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=d.default.getData(e,i)+t;return d.default.setData(e,n,a),n}function s(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],wx.setStorage({key:d.default.options.DATA_KEY,data:d.default.data}),d.default.post({url:"/data",data:d.default.data})}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"default",o={};if(e instanceof Object){var r=e;o={id:r.id,score:r.score,time:r.time,version:d.default.options.version,data:r.data,key:r.key}}else o={id:e,score:t,time:a,version:d.default.options.version,data:i,key:n};d.default.post({url:"/score",data:o,success:function(e){d.default.log("提交分数成功：",t,e)},fail:function(e){d.default.log("提交分数失败：",t,e)}})}function c(e){var t=e.key,a=void 0===t?"default":t,i=e.scale,n=void 0===i?"week":i,o=e.skip,r=void 0===o?0:o,s=e.limit,l=void 0===s?10:s,c=e.success,u=void 0===c?null:c,h=e.fail,f=void 0===h?null:h;d.default.get({url:"/score",data:{score_key:a,scale:n,skip:r,limit:l},success:function(e){u&&u(e.data)},fail:function(e){f&&f(e)}})}Object.defineProperty(t,"__esModule",{value:!0}),t.initData=function(e){e.getData=i,e.setData=n,e.setAllData=o,e.incData=r,e.postData=s,e.postGameScore=l,e.getScoreRank=c};var u,d=(u=a(1))&&u.__esModule?u:{default:u}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initShare=function(e){e.share=function(t){e.options.allowAld?e.aldShareAppMessage(this.createShareOptions(t)):e.shareAppMessage(this.createShareOptions(t)),this.options.share10&&(this.log("share10"),this.shareLog(t,"share10","",{},{})),t.onShareBack&&(e.shareCallbackData={callback:t.onShareBack,ms:Date.now()})},e.createShareOptions=function(t){t.pos||(t.pos="default");var a=this.getShareInfo(t);t.shareId=a.shareId,t.title||(t.title=a.title),t.imageUrl||(t.imageUrl=a.imageUrl),t.success||(t.success=a.success),t.fail||(t.fail=a.fail),t.onHttpError||(t.onHttpError=a.onHttpError),t.tid||(t.tid=""+Date.now());var i="type=share&pos="+t.pos+"&share_id="+a.shareId+"&share_tid="+t.tid;return this.isLogined()&&(i+="&uid="+this.user.id),t.gift&&(i+="&gift="+t.gift),t.query?"&"==t.query.indexOf(0)?(t.query=i+t.query,e.log("new share query: "+t.query)):(t.query=i+"&"+t.query,e.log("new share query: "+t.query)):t.query=i,e.shareTempData[t.tid]=t,{title:t.title,imageUrl:t.imageUrl,query:t.query,success:this.shareSuccess(t),fail:this.shareFail(t),complete:t.complete}},e.getShareInfo=function(e){var t="",a="";this.options.share&&(t=this.options.share.title,a=this.options.share.imageUrl);var i,n=0;return e.defaultTitle&&(t=e.defaultTitle),this.conf&&this.conf.shares&&(this.conf.shares[e.pos]?i=this.conf.shares[e.pos]:this.conf.shares.default&&(i=this.conf.shares.default),i&&(i.title&&(t=i.title),i.image&&(a=i.image),i.id&&(n=i.id))),{title:t,imageUrl:a,shareId:n,success:function(){wx.showToast({title:"分享成功！",icon:"success"})},fail:function(){wx.showToast({title:"分享失败！",icon:"fail"})},onHttpError:function(){wx.showToast({title:"网络出错！",icon:"fail"})}}},e.shareSuccess=function(t){return function(a){console.log("shareSuccess"),delete e.shareTempData[t.tid];var i=!0;t.onShareSuccess&&(i=t.onShareSuccess(a)),i&&(a.shareTickets&&a.shareTickets.length>0?wx.getShareInfo({shareTicket:a.shareTickets[0],success:function(e){t.onShareTicketSuccess&&t.onShareTicketSuccess(e),this.shareLog(t,"success",a.shareTickets[0],e,a)}.bind(this),fail:function(e){t.onShareTicketFail&&t.onShareTicketFail(e),this.shareLog(t,"success",a.shareTickets[0],{},a)}.bind(this)}):(t.onShareTicketFail&&t.onShareTicketFail(),this.shareLog(t,"success","",{},a)))}.bind(this)},e.shareFail=function(e){return function(t){console.log("shareFail");var a=!0;e.onShareFail&&(a=e.onShareFail(t)),a&&this.shareLog(e,"fail","",{},t)}.bind(this)},e.shareLog=function(t,a,i,n,o){this.post({url:"/log/share",data:{share_id:t.shareId,title:t.title,query:t.query,image:t.imageUrl,pos:t.pos,tid:t.tid,status:a,shareTicket:i,info:n,error:o.errMsg,system_version:e.systemInfo.system,sdk_version:e.systemInfo.SDKVersion},success:function(i){"success"!==a&&"click"!==a||!t.success?"fail"===a&&t.fail&&t.fail(i,o):(t.success(i,o),delete e.shareTempData[t.tid])},fail:function(e){"success"!==a&&"click"!==a||!t.onHttpError?"fail"===a&&t.fail&&t.fail(e,o):t.onHttpError(e,o)}})},e.isEnableShare=function(){return!(!e.conf||!e.conf.allow_share||e.requireSystemVersion("6.7.0"))}}},function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e){"string"==typeof e?(c.process=e,c.processDuration=Date.now()-c.initStartAt):s.default.log("setProcess():  参数类型错误")}function o(e){s.default.post({url:"/log/process",data:e,success:function(e){s.default.log("提交游戏进度数据成功：",e)},fail:function(e){s.default.log("提交游戏进度数据失败：",e)}})}Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e};t.initProcess=function(e){e.onShow(function(e){u=Date.now(),c.showOptions=JSON.stringify(e)}),e.afterHide(function(t){var a=Date.now(),i=c=r({},c,{times:c.times+1,showDuration:u?a-u:a-c.initStartAt,duration:a-c.initStartAt}),n=(i.hasInited,i.initStartAt,function(e,t){var a={};for(var i in e)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(a[i]=e[i]);return a}(i,["hasInited","initStartAt"]));c.hasInited?o(n):(c.hasInited=!0,o(r({systemInfo:JSON.stringify(e.systemInfo),launchOptions:JSON.stringify(e.launchOptions)},n)))}),e.setProcess=n};var s=i(a(1)),l=i(a(2)),c={hasInited:!1,initStartAt:Date.now(),showOptions:"",times:0,uuid:l.default.guid(),duration:0,showDuration:0,process:"init",processDuration:0},u=0},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initPayment=function(e){e.getPaymentResult=function(e){var t=e.success,a=void 0===t?null:t,i=e.fail,n=void 0===i?null:i;this.get({url:"/payment/result",success:function(e){this.log("获取充值数据成功",e),a&&a(e.data)}.bind(this),fail:function(e){this.log("获取充值数据失败",e),n&&n(e)}.bind(this)})},e.requestMPPayment=function(t){var a=this,i=t.title,n=void 0===i?"点击充值链接进入充值":i,o=t.pos,r=void 0===o?"default":o,s=t.image,l=void 0===s?null:s,c=t.success,u=void 0===c?null:c,d=t.fail,h=void 0===d?null:d,f=t.complete,m=void 0===f?null:f;this.log("打开客服对话"),e.openCustomerServiceConversation({sessionFrom:r,showMessageCard:!0,sendMessageTitle:n,sendMessagePath:"?type=message",sendMessageImg:l||e.conf.shares.default.image,success:function(e){a.log("打开充值会话成功",e),m&&m(),u&&u()},fail:function(e){a.log("打开充值会话fail",e),m&&m(),h&&h()}})},e.requestMPPayment=e.checkSDK("2.0.3",e.requestMPPayment)}},function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=e.pos,a=e.style,i=void 0===a?null:a,s=e.ms,l=void 0===s?0:s,c=e.force,u=void 0!==c&&c,d=e.forceTimeout,h=void 0===d?600:d,f=e.onResize,m=void 0===f?null:f;if(b.default.conf&&b.default.conf.banners&&b.default.conf.banners[t]){var g=b.default.conf.banners[t];if(g.enable){var p=void 0,y=C[t];y&&(p=_[y.adUnitId])&&(y.showed&&o(y),(u||Date.now()-p.created>1e3*h)&&function(e){var t=_[e.adUnitId];if(t)t.hide(),t.destroy(),delete _[e.adUnitId]}(y)),l||(l=b.default.getConfig("banner_ms",120)),y||(y={adUnitId:g.adUnitId,pos:t,count:0,ms:l,duration:0,style:i,width:g.width?g.width>1?1:g.width:1,window:"*",data:[],onResize:m,created:Date.now()},C[t]=y),y.count+=1,y.status="success",(p=_[y.adUnitId])||(p=_[y.adUnitId]=function(e){var t=e.banner,a=e.style,i=void 0===a?null:a,n=b.default.systemInfo.screenWidth*t.width,o=(b.default.systemInfo.screenHeight,wx.createBannerAd({adUnitId:t.adUnitId,style:S({left:0,top:0,width:n,height:180*n/750},i)}));return o.created=Date.now(),o.onError(function(e){t.status="error",t.error=e,t.timeout&&clearTimeout(t.timeout),t.timeout=null,t.showed=null,r(t,"error"),b.default.log("banner 创建失败",t),C[t.pos]&&delete C[t.pos]}),o.onResize(function(e){t.onResize&&t.onResize(e,o)}),o.onLoad(function(e){b.default.log("banner 加载完成",t),o.created=Date.now()}),o}({banner:y,style:i})),y.showed=Date.now(),setTimeout(function(){p.show()},.01),y.ms&&p&&(y.timeout&&clearTimeout(y.timeout),y.timeout=setTimeout(function(){n({pos:t,style:i,ms:l,force:!0,onResize:m})},1e3*l))}}else b.default.log("createBanner 没有配置: "+t)}function o(e){var t=C[e];if(t&&t.showed){var a=_[t.adUnitId];if(a){var i=a.style,n=i.realWidth,o=i.realHeight,r=Date.now()-t.showed;return a.hide(),t.duration+=r,t.data.push({created:a.created,showed:t.showed,duration:r}),t.timeout&&clearTimeout(t.timeout),t.timeout=null,t.showed=null,t.window=n+"*"+Math.round(o),!0}}return!1}function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"onHide",a={adUnitId:e.adUnitId,pos:e.pos,ms:e.ms,count:e.count,duration:e.duration,data:JSON.stringify(e.data),window:e.window,status:e.status,error:e.error,commit:t};e.count=0,e.duration=0,e.status="success",e.error="",e.data=[],b.default.log("postBannerData",a),b.default.post({url:"/log/ad/banner",data:a,success:function(e){b.default.log("提交banner数据成功：",e)},fail:function(e){b.default.log("提交banner数据失败：",e)}})}function s(e){return b.default.conf&&b.default.conf.videos&&b.default.conf.videos[e]?!!b.default.conf.videos[e].enable:(b.default.log("createVideo 没有配置: "+e),!1)}function l(e){function t(e){m.status="error",m.error=e,c(m),f&&f(e),d&&d(e),n()}function a(e){m.created=Date.now()}function i(e){f&&f(e),m.duration=Date.now()-m.created,e&&e.isEnded||void 0===e?l&&l({isEnded:!0,duration:m.duration}):(m.status="cancel",l&&l({isEnded:!1,duration:m.duration})),c(m),n()}function n(){g.offError(t),g.offLoad(a),g.offClose(i)}var o=e.pos,r=e.success,l=void 0===r?null:r,u=e.fail,d=void 0===u?null:u,h=e.complete,f=void 0===h?null:h;if(!s(o))return!1;var m={adUnitId:b.default.conf.videos[o].adUnitId,pos:o,status:"success",created:Date.now(),duration:0},g=wx.createRewardedVideoAd({adUnitId:m.adUnitId});return g.onError(t),g.onLoad(a),g.onClose(i),g.show().catch(function(e){console.log("ws.createVideo error:",e),g.load().then(function(){return g.show()})}),!0}function c(e){b.default.post({url:"/log/ad/rewardedvideo",data:e,success:function(e){b.default.log("提交激励视频数据成功：",e)},fail:function(e){b.default.log("提交激励视频数据失败：",e)}})}function u(e){var t;if(b.default.conf&&b.default.conf.games&&(b.default.conf.games[e]?t=b.default.conf.games[e]:b.default.conf.games.default&&(t=b.default.conf.games.default),t&&t.length>0)){b.default.tmp.getMoreGame||(b.default.tmp.getMoreGame={});var a=b.default.tmp.getMoreGame[e];return(!a||a>=t.length)&&(a=0),b.default.tmp.getMoreGame[e]=a+1,t[a]}}function d(e){var t;if(b.default.conf&&b.default.conf.games)if(b.default.conf.games[e]?t=b.default.conf.games[e]:b.default.conf.games.default&&(t=b.default.conf.games.default),t&&t.length>0){for(var a=[],i=0;i<t.length;i++)a.push(t[i].image);b.default.previewImage({urls:w.default.randomSort(a)})}else wx.showToast({title:"没有更多游戏！",icon:"info"});else wx.showToast({title:"没有更多游戏！",icon:"info"})}function h(e){return E&&E[e]?(E[e].showed&&p(e),E[e]):null}function f(e){for(var t in e)E[t]={pos:t,data:e[t]?e[t]:[],last:Date.now(),duration:M,total_ms:0,logs:[],showed:!0}}function m(e){var t=e.pos,a=void 0===t?"default":t,i=e.count,n=void 0===i?1:i,o=e.success,r=void 0===o?null:o,s=e.fail,l=void 0===s?null:s,c=h(a);c?(E[a].showed=!0,r&&r({code:0,data:c.data,key:"SUCCESS"})):b.default.get({url:"/game/ad",data:{pos:a,count:n},success:function(e){if(0==e.code){if(!Array.isArray(e.data)||Array.isArray(e.data)&&0!=e.data.length){var t={};t[a]=e.data,f(t)}r&&r(e)}else l&&l(e)},fail:function(e){l&&l(e)}})}function g(e){var t=e.data,a=void 0===t?[{pos:"default",count:1}]:t,i=e.success,n=void 0===i?null:i,o=e.fail,r=void 0===o?null:o,s={},l=!1,c=!0,u=!1,d=void 0;try{for(var m,g=a[Symbol.iterator]();!(c=(m=g.next()).done);c=!0){h(m.value.pos)||(l=!0)}}catch(e){u=!0,d=e}finally{try{!c&&g.return&&g.return()}finally{if(u)throw d}}if(s&&L({ads:s}),l)b.default.post({url:"/game/ad",data:{pos:a},success:function(e){0==e.code?(e.data&&f(e.data),n&&n(e)):r&&r(e)},fail:function(e){r&&r(e)}});else{var p={},y=!0,v=!1,S=void 0;try{for(var w,C=a[Symbol.iterator]();!(y=(w=C.next()).done);y=!0){var _=w.value;E[_.pos].showed=!0,p[_.pos]=E[_.pos].data}}catch(e){v=!0,S=e}finally{try{!y&&C.return&&C.return()}finally{if(v)throw S}}n&&n({code:0,data:p,key:"SUCCESS"})}}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";!function(){function e(e){var t=Date.now(),a=t-e.last;e.logs.push({ms:a,last:e.last,posted:!1}),e.total_ms+=a,e.last=t}var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!t||E[t])if(t)e(E[t]);else for(var a in E)e(E[a])}(e),E[e]&&(E[e].showed=!1)}function y(e){function t(e){e.image?b.default.previewImage({urls:[e.image],success:function(e){b.default.log("tapGameAD, success"),l&&l(e)},fail:function(e){b.default.log("tapGameAD, fail"),u&&u(e)},complete:function(e){b.default.log("tapGameAD, complete"),h&&h(e)}}):b.default.log("tapGameAD，ad参数内image属性缺失")}function a(e){b.default.requireSDK("2.2.0")?e.appid?wx.navigateToMiniProgram({appId:e.appid,path:e.path,success:function(e){b.default.log("tapGameAD, success"),l&&l(e)},fail:function(e){b.default.log("tapGameAD, fail"),u&&u(e)},complete:function(e){b.default.log("tapGameAD, complete"),h&&h(e)}}):b.default.log("tapGameAD, ad参数内appid属性缺失"):e.image?t(e):b.default.alert("当前微信版本过低，无法使用该功能，请升级到最新微信版本后重试。")}var i=e.pos,n=e.ad,o=e.redirect,r=void 0!==o&&o,s=e.success,l=void 0===s?null:s,c=e.fail,u=void 0===c?null:c,d=e.complete,h=void 0===d?null:d,f=n;E&&E[i]&&f?(function(e,t){if(!t||!t.cid||!t.id)return!1;v([{pos:e,tid:t.tid,commit:"click",data:[{cid:t.cid,id:t.id,action:t.action}]}])}(i,f),"code"==f.action?t(f):"navigate"==f.action?a(f):r?a(f):t(f)):b.default.log("tapGameAD pos无效，没有对应数据，或未传ad参数")}function v(e){b.default.post({url:"/game/ad/log",data:e,success:function(t){for(var a=0;a<e.length;a++){var i=e[a];"show"==i.commit&&i.pos in E&&(E[i.pos].logs=[])}b.default.log("广告数据提交成功！")},fail:function(e){b.default.log("广告数据提交失败！")}})}function L(e){function t(e){for(var t=[],a=0,i=null,n=0;n<e.logs.length;n++)e.logs[n].posted||(a+=e.logs[n].ms,i=e.logs[n].last);if(!a||!e.data)return t;for(var o=0;o<e.data.length;o++){var r={pos:e.pos,tid:e.data[o].tid,commit:"show",last:i,ms:a,data:[]};r.data.push({id:e.data[o].id,cid:e.data[o].cid,action:e.data[o].action}),t.push(r)}return t}var a=e.ads,i=void 0===a?null:a,n=e.ad,o=void 0===n?null:n;if(!i&&!o)return!1;var r=[];if(i)for(var s in i)r=r.concat(t(i[s]));else o&&(r=t(o));r.length>0&&v(r)}Object.defineProperty(t,"__esModule",{value:!0});var S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e};t.initAD=function(e){e.onShow(function(){for(var t in C){var a=C[t];a.isShow&&(e.createBanner({pos:a.pos,style:a.style,ms:a.ms,onResize:a.onResize}),a.isShow=!1)}for(var i=0;i<x.length;i++){var n=x[i];E[n].showed=!0,E[n].last=Date.now()}x=[]}),e.afterHide(function(){for(var e in C){var t=C[e];t.isShow=t.showed,t.isShow&&o(t.pos),t.duration>0&&r(t)}for(var a in E)E[a].showed&&(p(a),x.push(a));L({ads:E})}),e.createBanner=e.checkSDK("2.0.4",n),e.closeBanner=e.checkSDK("2.0.4",o),e.createVideo=e.checkSDK("2.0.4",l),e.isEnableVideo=s,e.getMoreGame=u,e.showMoreGame=d,e.getGameAd=m,e.hideGameAd=p,e.tapGameAd=y,e.fetchGameAd=g};var b=i(a(1)),w=i(a(2)),C={},_={},E={},x=[],M=12e4},function(e,t,a){"use strict";function i(e,t){e[t]=function(){var a;return e.mode=t,"aldShareAppMessage"==t&&(e.mode="shareAppMessage"),(a=wx)[t].apply(a,arguments)}}Object.defineProperty(t,"__esModule",{value:!0}),t.initHook=function(e){e.setMode=function(t){e.mode=t},i(e,"previewImage"),i(e,"openCustomerServiceConversation"),i(e,"shareAppMessage"),i(e,"aldShareAppMessage")};var n;(n=a(1))&&n.__esModule},function(e,t,a){"use strict";function i(e,t){var a={};for(var i in e)t.indexOf(i)>=0||Object.prototype.hasOwnProperty.call(e,i)&&(a[i]=e[i]);return a}function n(e){var t=e.pos,a=void 0===t?null:t,i=e.success,n=void 0===i?null:i,o=e.fail,r=void 0===o?null:o,s={};a&&(s.pos=a),v.default.get({url:"/invited/users/count",data:s,success:function(e){n&&n(e.data.count)},fail:function(e){r&&r(e)}})}function o(e){var t=e.pos,a=void 0===t?null:t,i=e.receive,n=void 0===i||i,o=e.skip,r=void 0===o?0:o,s=e.limit,l=void 0===s?-1:s,c=e.success,u=void 0===c?null:c,d=e.fail,h=void 0===d?null:d,f={skip:r,limit:l,receive:n};a&&(f.pos=a),v.default.get({url:"/invited/users",data:f,success:function(e){u&&u(e.data)},fail:function(e){h&&h(e)}})}function r(e){var t=e.user,a=e.pos,i=void 0===a?null:a,n=e.success,o=void 0===n?null:n,r=e.fail,s=void 0===r?null:r,l={users:[{id:t.id,gift:t.gift}]};i&&(l.pos=i),v.default.post({url:"/invited/gift/receive",data:l,success:function(e){o&&o(e.data.receive[0])},fail:function(e){s&&s(e)}})}function s(e){var t=e.users,a=e.pos,i=void 0===a?null:a,n=e.success,o=void 0===n?null:n,r=e.fail,s=void 0===r?null:r,l={users:[]},c=!0,u=!1,d=void 0;try{for(var h,f=t[Symbol.iterator]();!(c=(h=f.next()).done);c=!0){var m=h.value;l.users.push({id:m.id,gift:m.gift})}}catch(e){u=!0,d=e}finally{try{!c&&f.return&&f.return()}finally{if(u)throw d}}i&&(l.pos=i),v.default.post({url:"/invited/gift/receive",data:l,success:function(e){o&&o(e.data.receive)},fail:function(e){s&&s(e)}})}function l(e,t){if(t&&t.gift){var a={type:e,gift:t.gift,uid:t.uid,share_tid:t.share_tid},i=v.default.conf[t.gift];i&&(a.receive=!0),v.default.post({url:"/share/gift/log",data:a,success:function(e){if(i){var n=e.data;n.is_self&&i.not_allow_self?v.default.alert(i.not_allow_self_tip||"不能领取自己送出的礼物～"):n.user_count>=(i.date_limit||2)?v.default.alert(i.date_limit_tip||"今天已经领取太多次了～"):n.user_share_count>=(i.share_date_limit||1)?v.default.alert(i.share_date_limit_tip||"已经领取过该礼物了～"):n.count>=(i.limit||10)?v.default.alert(i.limit_tip||"该礼物被领光了～"):(e={gift:t.gift,query:t,conf:i,options:a,data:n},v.default._onGiftCallback&&v.default._onGiftCallback(e))}}})}}function c(e){e.from;var t=e.query;e.options,l("share",t)}function u(e){e.from,e.scene,e.options,l("code",e.query)}function d(e){v.default._onGiftCallback=e}function h(e){var t=e.gifts,a=e.users,i=void 0===a||a,n=e.receive,o=void 0===n||n,r=e.dateLimit,s=void 0===r?0:r,l=e.cache,c=void 0===l?60:l,u=e.limit,d=void 0===u?0:u,h=e.success,f=void 0===h?null:h,m=e.fail,g=void 0===m?null:m;if("boolean"==typeof i&&"boolean"==typeof o&&"number"==typeof s&&"number"==typeof c&&"number"==typeof d){var p=!0,y=[t.sort().toString(),i,o,s,d].join("-");v.default.shareGiftTempData&&v.default.shareGiftTempData[y]&&Date.now()-v.default.shareGiftTempData[y].ms<1e3*c&&(p=!1),p?v.default.post({url:"/share/gift/receive",data:{gifts:t,is_users:i,receive:o,date_limit:s,limit:d},success:function(e){v.default.shareGiftTempData[y]={data:e.data,ms:Date.now()},f&&f(e.data)},fail:g}):f&&f(v.default.shareGiftTempData[y].data)}else v.default.log("requestShareGift, 参数格式异常")}function f(e){var t=e.users,a=e.success,i=void 0===a?null:a,n=e.fail,o=void 0===n?null:n;Array.isArray(t)?v.default.post({url:"/share/gift/receive2",data:{users:t},success:function(e){i&&i(e)},fail:function(e){o&&o(e)}}):v.default.log("receiveShareGift, users参数格式错误")}function m(e){var t=e.pos,a=e.bg,n=void 0===a||a,o=e.success,r=void 0===o?null:o,s=e.fail,l=void 0===s?null:s,c=i(e,["pos","bg","success","fail"]);v.default.post({url:"/share/qrcode",data:p({pos:t,bg:n,uid:v.default.user.id,share_tid:Date.now()+""},c),success:function(e){r&&r(e.data)},fail:l})}function g(e){var t=e.pos,a=e.bg,n=void 0===a||a,o=e.filePath,r=void 0===o?"":o,s=e.success,l=void 0===s?null:s,c=e.fail,u=void 0===c?null:c,d=e.complete,h=void 0===d?null:d,f=i(e,["pos","bg","filePath","success","fail","complete"]);m(p({pos:t,bg:n,success:function(e){!function(t){var a=e.codeUrl;wx.downloadFile({url:a,filePath:r,success:function(e){200==e.statusCode&&(v.default.alert("download success",e.tempFilePath),v.default.log("download success",e.tempFilePath),r||(r=e.tempFilePath,wx.saveImageToPhotosAlbum({filePath:e.tempFilePath,success:function(e){l&&l(e)},fail:function(e){u&&u(e)},complete:function(e){h&&h(e)}})))},fail:function(e){u&&u(e)},complete:function(e){h&&h(e)}})}()},fail:u},f))}Object.defineProperty(t,"__esModule",{value:!0});var p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e};t.initInvite=function(e){e.getInviteCount=n,e.getInviteUsers=o,e.receiveInviteGift=r,e.receiveInviteGifts=s,e.openFromShare(c),e.openFromCode(u),e.onShareGift=d,e.requestShareGift=h,e.receiveShareGift=f,e.getWXACode=m,e.saveWXACode=g};var y,v=(y=a(1))&&y.__esModule?y:{default:y}},function(e,t,a){"use strict";function i(e,t){r.index+=1,r.events.push({event:e,data:t?JSON.stringify(t):null,tm:Date.now()})}Object.defineProperty(t,"__esModule",{value:!0}),t.initEvent=function(e){e.afterHide(function(){o.default.post({url:"/log/event",data:r,success:function(e){0==e.code&&(r.events=[]),o.default.log("事件日志提交成功！")},fail:function(e){o.default.log("事件日志提交失败！")}})}),e.traceEvent=i};var n,o=(n=a(1))&&n.__esModule?n:{default:n},r={index:0,events:[]}}])},{}],13:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=window.wx},{}],14:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=Laya.View,n=Laya.ClassUtils.regClass;!function(e){!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.loadScene("game/GameScene")},t}(i);e.GameSceneUI=t,n("ui.game.GameSceneUI",t)}(e.game||(e.game={}))}(a.ui||(a.ui={})),function(e){!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.loadScene("home/HomeView")},t}(i);e.HomeViewUI=t,n("ui.home.HomeViewUI",t)}(e.home||(e.home={}))}(a.ui||(a.ui={})),function(e){!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.loadScene("over/OverView")},t}(i);e.OverViewUI=t,n("ui.over.OverViewUI",t)}(e.over||(e.over={}))}(a.ui||(a.ui={}))},{}]},{},[2]);